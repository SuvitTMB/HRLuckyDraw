<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        .table-compact tr { height: 30px; }
        .table-compact td { padding-top: 0px; padding-bottom: 0px; vertical-align: middle; line-height: 1; }
        #table-body tr:nth-child(even), #label-table-body tr:nth-child(even), #log-table-body tr:nth-child(even) { background-color: #f8fafc; }
        #table-body tr:nth-child(odd), #label-table-body tr:nth-child(odd), #log-table-body tr:nth-child(odd) { background-color: #ffffff; }
        .table-compact th { height: 35px; padding-top: 4px; padding-bottom: 4px; }
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">HR Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการข้อมูลพนักงาน</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('winners')" id="nav-winners" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="trophy" width="20"></i> รางวัลโชคชั้นที่ 2
            </button>
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">Management</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
                </button>
                <button onclick="window.app.switchTab('labels')" id="nav-labels" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="tags" width="20"></i> ระบบจัดการฉลาก
                </button>
                <button onclick="window.app.switchTab('logs')" id="nav-logs" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="file-search" width="20"></i> ตรวจสอบรายการ
                </button>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="qr-code" width="20"></i> QR Code ฮั่งเปา
                </button>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4 font-bold">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">แดชบอร์ด</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block font-bold">
                    <p class="text-sm text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">A</div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="users" width="60" height="60" class="text-blue-600"></i></div>
                        <p class="text-slate-500 text-sm">สมาชิกทั้งหมด</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="user-check" width="60" height="60" class="text-green-600"></i></div>
                        <p class="text-slate-500 text-sm">สมาชิกลงทะเบียน</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="percent" width="60" height="60" class="text-orange-400"></i></div>
                        <p class="text-slate-500 text-sm">% ลงทะเบียน</p>
                        <h3 id="stat-percent" class="text-2xl font-bold text-slate-800 mt-2">0%</h3>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100 h-full flex flex-col">
                        <h3 class="font-bold text-lg text-slate-700 mb-4 flex items-center gap-2"><div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สัดส่วนการลงทะเบียน</h3>
                        <div class="h-64 flex justify-center"><canvas id="registrationChart"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1 text-base font-bold text-slate-700"></div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h3 class="font-bold text-lg text-slate-700 mb-4 flex items-center gap-2"><i data-lucide="activity" width="20" class="text-blue-500"></i> สถิติการลงทะเบียนรายชั่วโมง</h3>
                    <div class="h-64"><canvas id="realtimeLineChart"></canvas></div>
                </div>
            </div>

            <!-- VIEW 2: DATA TABLE -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                 <div id="data-summary-container" class="grid grid-cols-1 md:grid-cols-5 gap-4"></div>
                 <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-4 flex-wrap justify-end">
                             <div class="flex items-center gap-2 font-bold">
                                <label class="text-sm text-slate-600">กรอง Reward:</label>
                                <select id="filter-data-reward" onchange="window.app.onDataRewardFilterChange(this.value)" class="bg-white border border-slate-200 text-slate-600 text-sm rounded-lg p-2 w-48 shadow-sm">
                                    <option value="">-- ทั้งหมด --</option>
                                </select>
                             </div>
                             <div class="flex items-center gap-2 font-bold">
                                <label class="text-sm text-slate-600">แสดง:</label>
                                <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-white border border-slate-200 text-slate-600 text-sm rounded-lg p-2">
                                    <option value="20">20 แถว</option>
                                    <option value="50" selected>50 แถว</option>
                                    <option value="100">100 แถว</option>
                                </select>
                             </div>
                             <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 font-bold">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100 text-base">
                                <tr>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('no')">NO. <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('EmpName')">ชื่อ-นามสกุล <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('Reward')">Group <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateCheck')">Login <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateLogin')">สุ่มครั้งที่ 1 <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateReward')">สุ่มครั้งที่ 2 <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('StatusReward')">รางวัล <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100 text-sm font-normal text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="p-4 border-t bg-slate-50 flex justify-between items-center px-6">
                        <p class="text-sm text-slate-400 font-bold" id="data-table-info"></p>
                        <div class="flex gap-4 items-center">
                            <button onclick="window.app.exportDataToCSV()" class="px-4 py-1.5 bg-emerald-600 text-white rounded-lg font-bold text-xs hover:bg-emerald-700 flex items-center gap-2 shadow-sm transition">
                                <i data-lucide="download" width="14"></i> Download CSV File
                            </button>
                            <div class="flex gap-2" id="pagination-controls"></div>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- VIEW 3: WINNERS -->
            <div id="view-winners" class="view-section hidden space-y-6 fade-in-up">
                 <div id="winners-container" class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-[80%] mx-auto font-bold"></div>
            </div>

            <!-- VIEW 4: IMPORT -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up font-bold">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2 font-bold"><i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูล (JSON/CSV)</h3>
                        <p class="text-sm text-slate-500 mb-4">ระบบจะรันหมายเลข <code>no</code> ให้อัตโนมัติทุกครั้งที่นำเข้าใหม่</p>
                        <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('file-upload').click()">
                            <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                            <p class="text-sm font-bold text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากมาวางที่นี่</p>
                            <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                        </div>
                        <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700 mt-4">
                            <span id="file-name" class="font-bold"></span>
                            <button onclick="window.app.clearFileSelection()"><i data-lucide="x" width="16"></i></button>
                        </div>
                        <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold mt-4 hover:bg-blue-700 transition shadow-lg shadow-blue-100 font-bold">เริ่มนำเข้าข้อมูล</button>
                        <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5 mt-4">
                            <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 font-bold">จัดการระบบ</h3>
                         <div class="space-y-4">
                             <div class="bg-slate-50 p-4 rounded-xl flex justify-between items-center">
                                <div><p class="text-sm text-slate-500 font-bold">พนักงานในระบบ</p><h2 class="text-2xl font-bold" id="manage-total-docs">0</h2></div>
                                <i data-lucide="database" class="text-slate-300" width="40"></i>
                             </div>
                             <div class="grid grid-cols-2 gap-2">
                                <button onclick="window.app.openResetModal()" class="w-full py-3 border border-orange-300 text-orange-700 rounded-xl font-bold text-sm hover:bg-orange-50 transition">Reset Register</button>
                                <button onclick="window.app.openDeleteModal()" class="w-full py-3 border border-red-300 text-red-700 rounded-xl font-bold text-sm hover:bg-red-50 transition">Delete All</button>
                             </div>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: LABELS -->
            <div id="view-labels" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                    <h3 class="font-bold text-lg text-slate-800 mb-6 flex items-center gap-2"><i data-lucide="tags" width="20" class="text-indigo-600"></i> ระบบจัดการฉลาก</h3>
                    <div id="label-summary-container" class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
                        <!-- Stats boxes populated in init() -->
                        <div class="bg-rose-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 1,000</p>
                            <h4 id="card-total-1000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-1000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-1000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-1000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-emerald-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 2,000</p>
                            <h4 id="card-total-2000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-2000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-2000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-2000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-sky-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 3,000</p>
                            <h4 id="card-total-3000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-3000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-3000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-3000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-amber-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 4,000</p>
                            <h4 id="card-total-4000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-4000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-4000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-4000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="flex flex-col md:flex-row gap-3">
                        <button onclick="window.app.openDeleteLabelsModal()" class="flex-1 min-h-[50px] bg-red-50 text-red-600 border border-red-200 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-red-100 transition shadow-sm group">
                            <i data-lucide="trash-2" width="20"></i> ลบฉลากทั้งหมด
                        </button>
                        <button onclick="window.app.openCreateLabelsModal()" class="flex-1 min-h-[50px] bg-indigo-600 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-indigo-700 transition shadow-lg shadow-indigo-200 group">
                            <i data-lucide="plus-circle" width="20"></i> สร้างฉลากใหม่
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden mt-6">
                    <div class="p-4 bg-slate-50 border-b flex justify-between items-center">
                        <h3 class="font-bold text-slate-700 text-lg">ตารางแสดงผลฉลากตามกลุ่ม</h3>
                        <div class="flex items-center gap-3 font-bold">
                            <label class="text-sm text-slate-600">เลือกกลุ่มรางวัล:</label>
                            <select id="label-group-select" onchange="window.app.onLabelGroupChange(this.value)" class="w-48 p-2 border rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                                <option value="">รางวัลทั้งหมด</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-base table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold uppercase text-xs">
                                <tr>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('CardNo')">ลำดับที่ <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('Reward')">Reward (กลุ่ม) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('rewardname')">ของรางวัล (Reward Name) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('EmpName')">ผู้รับรางวัล (EmpName) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('Datetime')">Datetime <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 text-right">Admin</th>
                                </tr>
                            </thead>
                            <tbody id="label-table-body" class="divide-y divide-slate-100 font-normal text-sm text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="p-4 border-t bg-slate-50 flex justify-between items-center px-6">
                        <p class="text-sm text-slate-400 font-bold" id="label-table-info"></p>
                        <div class="flex gap-4 items-center">
                            <button onclick="window.app.exportLabelsToCSV()" class="px-4 py-1.5 bg-emerald-600 text-white rounded-lg font-bold text-xs hover:bg-emerald-700 flex items-center gap-2 shadow-sm transition">
                                <i data-lucide="download" width="14"></i> Download CSV File
                            </button>
                            <div class="flex gap-2" id="label-pagination-controls"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: LOGS -->
            <div id="view-logs" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                    <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2 font-bold"><i data-lucide="file-search" width="20" class="text-blue-600"></i> ตรวจสอบรายการ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-white">
                        <div class="bg-blue-600 p-4 rounded-xl flex justify-between items-center border border-white/10 shadow-xl">
                            <div>
                                <p class="text-xs font-bold uppercase tracking-wider opacity-80">จำนวนข้อมูลทั้งหมด</p>
                                <h2 class="text-3xl font-black" id="log-total-count">0</h2>
                            </div>
                            <i data-lucide="list" class="opacity-30" width="40"></i>
                        </div>
                        <div class="bg-rose-600 p-4 rounded-xl flex justify-between items-center border border-white/10 shadow-xl">
                            <div>
                                <p class="text-xs font-bold uppercase tracking-wider opacity-80">จัดการข้อมูล</p>
                                <button onclick="window.app.openDeleteLogsModal()" class="mt-2 px-4 py-2 bg-white text-rose-600 rounded-lg font-bold text-xs hover:bg-slate-100 transition shadow-lg flex items-center gap-2">
                                    <i data-lucide="trash-2" width="14"></i> ลบ Log File ทั้งหมด
                                </button>
                            </div>
                            <i data-lucide="alert-triangle" class="opacity-30" width="40"></i>
                        </div>
                    </div>
                    <div class="overflow-x-auto rounded-xl border border-slate-100">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold text-sm">
                                <tr>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('index')">ลำดับที่ <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('citizenId')">citizenId <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('EmpName')">EmpName <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('StatusReg')">StatusReg <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('deviceID')">deviceID <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('Datetime')">Datetime <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                </tr>
                            </thead>
                            <tbody id="log-table-body" class="divide-y divide-slate-100 text-sm font-normal text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="mt-4 flex flex-col md:flex-row justify-between items-center gap-4">
                        <button onclick="window.app.exportLogsToCSV()" class="px-6 py-2 bg-emerald-600 text-white rounded-lg font-bold text-sm hover:bg-emerald-700 flex items-center gap-2 shadow-lg shadow-emerald-100 transition font-bold">
                            <i data-lucide="download" width="16"></i> Download CSV File
                        </button>
                        <div class="flex gap-2" id="log-pagination-controls"></div>
                    </div>
                </div>
            </div>

            <!-- VIEW 7: QR CODE -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2 font-bold text-2xl text-center">ลงทะเบียน</h2>
                    <div class="bg-white p-4 rounded-xl border border-slate-300 mb-6 mt-6">
                        <img src="./images/QRCodeHR2026.png" alt="QR" class="w-80 h-80 object-contain mx-auto" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://suvittmb.github.io/HRLuckyDraw/hr2026.html'">
                    </div>
                    <button onclick="window.print()" class="px-6 py-2 bg-slate-100 text-slate-600 rounded-lg text-sm border flex items-center gap-2 transition mx-auto font-bold"><i data-lucide="printer" width="16"></i> พิมพ์หน้านี้</button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Confirm Modal -->
    <div id="label-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop font-bold">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[90%] md:max-w-[40%] p-8 text-center transition-all duration-300 font-bold">
            <div id="label-modal-icon" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 font-bold"></div>
            <h3 id="label-modal-title" class="text-xl font-bold mb-2"></h3>
            <p id="label-modal-message" class="text-slate-500 text-sm mb-6"></p>
            <div id="label-modal-input-container" class="hidden mb-4"><input type="text" id="label-modal-input" class="w-full p-3 border rounded-xl text-center font-bold outline-none focus:ring-2"></div>
            <div class="flex gap-3 font-bold">
                <button onclick="window.app.closeLabelModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-slate-500">ยกเลิก</button>
                <button id="label-modal-confirm-btn" class="flex-1 py-3 rounded-xl bg-slate-800 text-white font-bold transition"></button>
            </div>
        </div>
    </div>

    <!-- Edit Reward Modal -->
    <div id="edit-reward-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop font-bold">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-8 text-center font-bold">
            <h3 class="text-xl font-bold mb-2 text-slate-800">แก้ไขของรางวัล</h3>
            <p class="text-sm text-slate-500 mb-4 text-center">ระบุชื่อรางวัลสำหรับฉลากลำดับนี้</p>
            <input type="text" id="edit-reward-input" class="w-full p-3 border rounded-xl text-center font-bold outline-none focus:ring-2 focus:ring-indigo-100 mb-6 font-bold">
            <div class="flex gap-3 font-bold">
                <button onclick="window.app.closeEditRewardModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-slate-500">ยกเลิก</button>
                <button id="edit-reward-confirm-btn" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold">บันทึก</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
        const _0x27412c=_0x143c;(function(_0x3487c9,_0x2c3ac6){const _0x8a837d=_0x143c,_0x1f1779=_0x3487c9();while(!![]){try{const _0x5c0a71=parseInt(_0x8a837d(0x22f))/0x1+-parseInt(_0x8a837d(0x1a5))/0x2*(-parseInt(_0x8a837d(0x2c2))/0x3)+parseInt(_0x8a837d(0x1cf))/0x4*(parseInt(_0x8a837d(0x1bf))/0x5)+parseInt(_0x8a837d(0x266))/0x6+-parseInt(_0x8a837d(0x300))/0x7+parseInt(_0x8a837d(0x275))/0x8*(parseInt(_0x8a837d(0x2a6))/0x9)+parseInt(_0x8a837d(0x1a0))/0xa*(-parseInt(_0x8a837d(0x1ca))/0xb);if(_0x5c0a71===_0x2c3ac6)break;else _0x1f1779['push'](_0x1f1779['shift']());}catch(_0x1bb015){_0x1f1779['push'](_0x1f1779['shift']());}}}(_0x3563,0x7e93e));function _0x3563(){const _0x42b945=['logSortKey','</span>\x20<div\x20class=\x22text-[10px]\x20text-slate-400\x20mt-1\x20font-normal\x22>ลงทะเบียนเมื่อ\x20','bg-rose-600','สร้างฉลากใหม่?','update','from','registration_data_','<i\x20data-lucide=\x22','classList','ยืนยันการสร้างสลากใหม่โดยอ้างอิงจากรายชื่อสมาชิกที่มีอยู่จริงในระบบ','labels','selectedDataReward','red','>ล้างผลสุ่ม</button></div></td></tr>','hidden','realtimeLineChart','visibility','indigo-600','label-pagination-controls','window.app.resetLabelRecord(\x27','<div\x20class=\x22bg-white\x20rounded-[2rem]\x20shadow-sm\x20border\x20border-slate-100\x20flex\x20flex-col\x20overflow-hidden\x20transition-all\x20hover:shadow-lg\x22><div\x20class=\x22bg-','sky','view-','setAttribute','bg-amber-600','<option\x20value=\x22\x22>--\x20ทั้งหมด\x20--</option>','-600\x22>','logSortOrder','สุ่มครั้งที่\x202\x20(DateReward)','QR\x20Code\x20ฮั่งเปา','file-upload','ข้อมูลลงทะเบียน','encode','files','percent','currentPage','พิมพ์\x20Reset\x20เพื่อล้างข้อมูลการล็อกอินและผลการสุ่มทั้งหมด','(ไม่มีของรางวัล)','\x20<span\x20class=\x22text-[10px]\x20opacity-70\x20font-normal\x22>ลงทะเบียนแล้ว</span></span><span\x20class=\x22text-lg\x20font-black\x22>','logPage','ยืนยันการล้างข้อมูล?','</span><button\x20onclick=\x22window.app.changeLogPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','getHours','click','DateReward','>ย้อนกลับ</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>ราย</span></h3><div\x20class=\x22mt-2\x20flex\x20justify-between\x20items-baseline\x20font-bold\x22><span\x20class=\x22text-sm\x22>','push','stat-percent','</td><td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20font-normal\x20font-bold\x22>','stat-checkin','regLine','toLocaleDateString','orange-600','winners-container','4277728LGsYlu','endsWith','type','text/csv;charset=utf-8;','renderManualHistory','ความถี่การลงทะเบียน','-100\x20text-','app','all','\x20h-1.5\x20mt-auto\x20rounded-full\x20overflow-hidden\x20mt-3\x20shadow-inner\x22><div\x20class=\x22bg-white\x20h-1.5\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','includes','add','</span><span\x20class=\x22text-xs\x20text-','data-table-info','Confirm','sort','\x20p-5\x20rounded-2xl\x20shadow-xl\x20border\x20border-white/10\x20flex\x20flex-col\x20transition-all\x20hover:shadow-2xl\x20hover:scale-[1.02]\x20h-full\x20','group','20Cwhdww','remove','</span><button\x20onclick=\x22window.app.changeLabelPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','trash-2','card-total-','26ACuaDh','subtle','min','closeLabelModal','used','general-modal','ttb-register.firebasestorage.app','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-normal\x20font-bold\x22>','</td><td\x20class=\x22px-6\x20font-bold\x20text-slate-800\x20font-bold\x22>','Outsources_log','</span><button\x20onclick=\x22window.app.changePage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','ลบฉลากสำเร็จ','bg-red-500','.json','registered','\x20จาก\x20','fill','sortBy','onload','4000','</span></td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-400\x20font-normal\x20text-sm\x22>','ยืนยัน','div','bg-white\x20border-l-4\x20','renderWinnersView','hover:bg-red-50','28235Kptuxy','forEach','toDate','>Next</button>','#3b82f6','appendChild','readAsText','searchTerm','3000','rowsPerPage','label-modal-message','9009011fjprvF','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-100\x20font-bold\x22><td\x20class=\x22px-6\x20py-4\x20text-slate-600\x20font-normal\x22>','bg-indigo-600','activeTab','เกิดข้อผิดพลาด','116wszldo','round','createObjectURL','>ถัดไป</button>','bg-blue-600','</td><td\x20class=\x22px-6\x20py-4\x20text-indigo-600\x20font-normal\x20font-bold\x22>','flex-1\x20py-3\x20rounded-xl\x20bg-','th-TH','StatusReward','DateLogin','destroy','error','map','รางวัลโชคชั้นที่\x202','toLowerCase','ลบประวัติรายการทั้งหมด?','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20transition\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2218\x22></i></button></td></tr>','พิมพ์\x20Delete\x20เพื่อลบประวัติ\x20Log\x20การทำรายการทั้งหมดถาวร','\x22\x20width=\x2232\x22></i>','<span\x20class=\x22text-sm\x20font-bold\x20text-slate-700\x22>','hourlyData','\x20/\x20','ตรวจสอบรายการ','toast-container','refreshCharts','\x20คน</p></div></div>','filter','labelPage','selectedLabelGroup','<div\x20class=\x22text-base\x20text-slate-400\x20py-6\x20text-center\x20italic\x22>ยังไม่มีผู้ได้รับรางวัล</div>','ลำดับที่','ล้างข้อมูลฉลากใบนี้?','edit-reward-modal','แสดงรายการที่\x20','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','indigo','label','ของรางวัล\x20(Reward\x20Name)','innerText','card-bar-','status-indicator','<button\x20onclick=\x22window.app.changePage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','SHA-256','outsources_logs_','StatusReg','labels_export_','text-white','Datetime','<tr\x20class=\x22hover:bg-blue-50/50\x20transition\x20font-bold\x20text-slate-700\x20text-sm\x22><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-slate-400\x20font-normal\x20text-sm\x22>','commit','red-600','.view-section','Reward','localeCompare','current-time','กลุ่มรางวัล\x20','จัดการข้อมูล','undefined','</td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-500\x20font-normal\x20text-sm\x20truncate\x20max-w-[120px]\x22\x20title=\x22','success','คำยืนยันไม่ถูกต้อง','ผิดพลาด','logs','cards','</td><td\x20class=\x22px-4\x20py-3\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22>','Outsources_card','2000','</td><td\x20class=\x22px-6\x22>','\x20font-bold\x22><p\x20class=\x22text-[11px]\x20font-bold\x20uppercase\x20tracking-wider\x20opacity-80\x22>','Outsources','</td><td\x20class=\x22px-6\x20py-4\x20text-right\x20font-bold\x22><button\x20onclick=\x22window.app.resetMemberData(\x27','สำเร็จ','pagination-controls','createElement','dashboard','#e2e8f0','renderLabelTable','max','replace','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-50\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22><td\x20class=\x22px-6\x20font-mono\x20text-slate-500\x22>','disabled','labelSortOrder','กำลังดำเนินการ...','ไม่ระบุกลุ่ม','total','delete','EmpName','line','ttb-register.firebaseapp.com','-500\x20text-white\x20p-3\x20text-center\x22><p\x20class=\x22text-[13px]\x20font-black\x20opacity-80\x20tracking-widest\x20uppercase\x22>กลุ่มรางวัล</p><h4\x20class=\x22text-xl\x20font-black\x22>','log-total-count','split','<option\x20value=\x22\x22>รางวัลทั้งหมด</option>','Success','Login\x20(DateCheck)','getTime','540593ftmHIB','\x20จากทั้งหมด\x20','<button\x20onclick=\x22window.app.changeLabelPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','ลบสำเร็จ','-500\x20h-2\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','sortOrder','width','พิมพ์\x20Delete\x20เพื่อลบสลากทั้งหมดออกจากระบบและรีเซ็ตสถานะสุ่ม','%\x22></div></div></div>','\x22\x20class=\x22text-red-500\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-red-200\x20rounded-lg\x20','ยังไม่มีข้อมูลสมาชิก','switchTab','import-bar','showToast','-600\x20font-bold','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-700\x20font-normal\x20font-bold\x22>','edit-reward-input','winners','amber','createIcons','default-app-id','result','download','>แก้ไข</button><button\x20onclick=\x22','status-text','toLocaleString','ยืนยัน\x20Reset\x20Register?','join','placeholder','digest','-50\x20p-3\x20border-b\x20text-center\x22><div\x20class=\x22text-sm\x20font-black\x20text-','bar','table-body','\x20เพื่อยืนยัน','\x20transition\x22\x20','Name','value','/public/data/','page-title','.csv','ceil','generateLabels','ล้างข้อมูลแล้ว','<option\x20value=\x22','\x20รายการ','asc','</p><h3\x20class=\x22text-3xl\x20font-black\x20mt-1\x20leading-tight\x22>','border-green-500','rewardname','</option>','citizenId','ลงทะเบียนแล้ว','index','DateCheck','data','2396634XxmBod','renderLogTable','%</span></div><div\x20class=\x22w-full\x20','target','trim','style','Dateworking','<button\x20onclick=\x22window.app.changeLogPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','พิมพ์\x20Delete\x20เพื่อลบรายชื่อพนักงานทั้งหมดออกจากฐานข้อมูล','set','labelSortKey','emerald','href','recent-activity-list','import-progress','1544aKiGpD','รางวัล\x20(StatusReward)','filter-data-reward','>Prev</button><span\x20class=\x22text-xs\x20font-bold\x20px-2\x22>Page\x20','card-used-','</div></div>','artifacts/','orange','\x20บาท</h4></div><div\x20class=\x22bg-','toFixed','Datework','getElementById','พิมพ์\x20','w-16\x20h-16\x20rounded-full\x20flex\x20items-center\x20justify-center\x20mx-auto\x20mb-4\x20bg-','label-modal-confirm-btn','deviceID','desc','window.app.openEditRewardModal(\x27','label-table-body','</b>\x20<span\x20class=\x22text-slate-400\x20font-normal\x20mx-1\x22>กลุ่ม:</span>\x20<span\x20class=\x22text-indigo-600\x22>','btn-import','ttb-register','bg-slate-700','bg-white/30','log-pagination-controls','</td></tr>','1000','ลบประวัติ\x20Log\x20เรียบร้อยแล้ว','</td><td\x20class=\x22px-6\x20text-right\x22><div\x20class=\x22flex\x20items-center\x20justify-end\x20gap-2\x22><button\x20onclick=\x22','card-percent-','onclick','size','ไม่มีข้อมูลสำหรับดาวน์โหลด','body','Unknown','hasOwnProperty','สร้างฉลากใหม่สำเร็จ','---','length','\x20p-4\x20rounded-xl\x20shadow-lg\x20toast-enter\x20pointer-events-auto','ชื่อ-นามสกุล','</td><td\x20class=\x22px-4\x20py-3\x20text-slate-500\x20font-normal\x20text-sm\x22>','stat-checkout','</div></div><div\x20class=\x22p-4\x20flex-1\x20overflow-y-auto\x20max-h-[350px]\x20custom-scroll-dark\x22><p\x20class=\x22text-[10px]\x20text-slate-400\x20mb-2\x20font-bold\x20uppercase\x20tracking-tighter\x22>รายชื่อผู้ได้รับรางวัลล่าสุด</p>','regPie','\x20ราย</span></div><div\x20class=\x22w-full\x20bg-slate-200\x20rounded-full\x20h-2\x22><div\x20class=\x22bg-','showLabelModal','innerHTML','registrationChart','38052UHtBsh','padStart','Delete','</div><div\x20class=\x22bg-slate-50\x20p-5\x20border-t\x22><div\x20class=\x22flex\x20justify-between\x20items-center\x20mb-1.5\x20font-bold\x22><span\x20class=\x22text-[12px]\x20text-slate-500\x22>สถิติการสุ่มรางวัล</span><span\x20class=\x22text-xs\x20text-slate-700\x22>','ref','label-modal-icon','renderTable','name','renderDataSummary','label-confirm-modal','label-modal-input','.nav-item','docs','opacity-20\x20cursor-not-allowed','ผู้รับรางวัล\x20(EmpName)','<div\x20class=\x22','CardNo','label-modal-title','</span></div>','</span>','label-table-info','slice','<div\x20class=\x22p-3\x20bg-white\x20rounded-lg\x20text-sm\x20shadow-sm\x20border\x20border-slate-100\x20mb-1\x20font-bold\x22><b\x20class=\x22text-slate-800\x20font-black\x22>','className','manage-total-docs','#10b981','querySelectorAll','users','195639amCLab','toLocaleTimeString','parse','text','file-info','</td><td\x20class=\x22px-4\x20py-3\x20font-bold\x22><span\x20class=\x22px-2\x20py-0.5\x20rounded-full\x20text-[10px]\x20bg-blue-100\x20text-blue-600\x20font-bold\x22>','toString'];_0x3563=function(){return _0x42b945;};return _0x3563();}import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x27412c(0x214),CARDS_COLLECTION_NAME=_0x27412c(0x210),LOGS_COLLECTION_NAME=_0x27412c(0x1ae),isSandboxEnv=typeof __firebase_config!=='undefined';function _0x143c(_0x2deac5,_0x51d7ba){_0x2deac5=_0x2deac5-0x19f;const _0x3563d8=_0x3563();let _0x143c1b=_0x3563d8[_0x2deac5];return _0x143c1b;}let firebaseConfig,finalCollectionPath,cardCollectionPath,logCollectionPath;const appId=typeof __app_id!=='undefined'?__app_id:_0x27412c(0x243);isSandboxEnv?(firebaseConfig=JSON['parse'](__firebase_config),finalCollectionPath=_0x27412c(0x27b)+appId+_0x27412c(0x254)+TARGET_COLLECTION_NAME,cardCollectionPath=_0x27412c(0x27b)+appId+'/public/data/'+CARDS_COLLECTION_NAME,logCollectionPath=_0x27412c(0x27b)+appId+_0x27412c(0x254)+LOGS_COLLECTION_NAME):(firebaseConfig={'apiKey':_0x27412c(0x1f1),'authDomain':_0x27412c(0x227),'projectId':_0x27412c(0x28a),'storageBucket':_0x27412c(0x1ab),'messagingSenderId':'1070273157855','appId':'1:1070273157855:web:5c8120e1df27e233d8676a'},finalCollectionPath=TARGET_COLLECTION_NAME,cardCollectionPath=CARDS_COLLECTION_NAME,logCollectionPath=LOGS_COLLECTION_NAME);const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'cards':[],'logs':[],'activeTab':'dashboard','searchTerm':'','rowsPerPage':0x32,'currentPage':0x1,'sortBy':'no','sortOrder':_0x27412c(0x25c),'hourlyData':Array(0x18)[_0x27412c(0x1b5)](0x0),'selectedLabelGroup':'','labelPage':0x1,'labelRowsPerPage':0x32,'labelSortKey':_0x27412c(0x2b6),'labelSortOrder':_0x27412c(0x25c),'logPage':0x1,'logRowsPerPage':0x32,'logSortKey':'Datetime','logSortOrder':'desc','selectedDataReward':''},formatDate=_0x12f97c=>{const _0x1f8738=_0x27412c;if(!_0x12f97c)return'-';try{if(_0x12f97c[_0x1f8738(0x1c1)]){const _0x281771=_0x12f97c['toDate']();return _0x281771[_0x1f8738(0x2fd)](_0x1f8738(0x1d6))+'\x20'+_0x281771['toLocaleTimeString'](_0x1f8738(0x1d6));}const _0x357ae8=new Date(_0x12f97c);if(!isNaN(_0x357ae8[_0x1f8738(0x22e)]()))return _0x357ae8['toLocaleDateString'](_0x1f8738(0x1d6))+'\x20'+_0x357ae8[_0x1f8738(0x2c3)](_0x1f8738(0x1d6));}catch(_0x1cd6d0){}return _0x12f97c;},normalizeReward=_0x1adc78=>String(_0x1adc78||'')[_0x27412c(0x21d)](/,/g,'')[_0x27412c(0x26a)]();async function sha256(_0x12d355){const _0x1d2c20=_0x27412c,_0x30edb7=new TextEncoder()[_0x1d2c20(0x2e9)](_0x12d355),_0x527c1a=await crypto[_0x1d2c20(0x1a6)][_0x1d2c20(0x24c)](_0x1d2c20(0x1f9),_0x30edb7);return Array[_0x1d2c20(0x2ce)](new Uint8Array(_0x527c1a))[_0x1d2c20(0x1db)](_0x3a4cf8=>_0x3a4cf8[_0x1d2c20(0x2c8)](0x10)[_0x1d2c20(0x2a7)](0x2,'0'))[_0x1d2c20(0x24a)]('');}function chunkArray(_0x426942,_0x1744e6){const _0x2e1437=_0x27412c,_0x28971a=[];for(let _0x4825c6=0x0;_0x4825c6<_0x426942['length'];_0x4825c6+=_0x1744e6)_0x28971a[_0x2e1437(0x2f8)](_0x426942[_0x2e1437(0x2bb)](_0x4825c6,_0x4825c6+_0x1744e6));return _0x28971a;}function csvToJson(_0x32ede5){const _0x346677=_0x27412c,_0x100b18=_0x32ede5[_0x346677(0x22a)]('\x0a');if(_0x100b18[_0x346677(0x29b)]===0x0)return[];const _0x3e8c52=_0x100b18[0x0][_0x346677(0x22a)](',')[_0x346677(0x1db)](_0x3c27c1=>_0x3c27c1[_0x346677(0x26a)]());return _0x100b18[_0x346677(0x2bb)](0x1)['map'](_0x163c17=>{const _0x569a07=_0x346677,_0x973ff7=_0x163c17[_0x569a07(0x22a)](',');if(_0x973ff7[_0x569a07(0x29b)]<_0x3e8c52[_0x569a07(0x29b)])return null;return _0x3e8c52['reduce']((_0xf045cb,_0xc905c8,_0x4bab89)=>{return _0xf045cb[_0xc905c8]=_0x973ff7[_0x4bab89]?_0x973ff7[_0x4bab89]['trim']():'',_0xf045cb;},{});})[_0x346677(0x1e9)](_0x4396a6=>_0x4396a6);}window[_0x27412c(0x307)]={'showToast':(_0x24f574,_0x267d7f=_0x27412c(0x20a))=>{const _0x17f83e=_0x27412c,_0x189516=document[_0x17f83e(0x280)](_0x17f83e(0x1e6));if(!_0x189516)return;const _0x362773=document[_0x17f83e(0x218)](_0x17f83e(0x1bb));_0x362773[_0x17f83e(0x2bd)]=_0x17f83e(0x1bc)+(_0x267d7f===_0x17f83e(0x20a)?_0x17f83e(0x25e):'border-red-500')+_0x17f83e(0x29c),_0x362773['innerHTML']=_0x17f83e(0x1e2)+_0x24f574+_0x17f83e(0x2b9),_0x189516[_0x17f83e(0x1c4)](_0x362773),setTimeout(()=>{const _0x23466f=_0x17f83e;_0x362773['classList'][_0x23466f(0x30b)]('opacity-0'),setTimeout(()=>_0x362773['remove'](),0x12c);},0xbb8);},'switchTab':_0x3bb75c=>{const _0x377576=_0x27412c;document[_0x377576(0x2c0)](_0x377576(0x202))[_0x377576(0x1c0)](_0x218895=>_0x218895[_0x377576(0x2d1)]['add']('hidden'));const _0x219d1e=document[_0x377576(0x280)](_0x377576(0x2df)+_0x3bb75c);if(_0x219d1e)_0x219d1e['classList'][_0x377576(0x1a1)](_0x377576(0x2d7));document['querySelectorAll'](_0x377576(0x2b1))[_0x377576(0x1c0)](_0x399c83=>_0x399c83['classList'][_0x377576(0x1a1)](_0x377576(0x28b),_0x377576(0x1fd)));const _0x5b284a=document[_0x377576(0x280)]('nav-'+_0x3bb75c);if(_0x5b284a)_0x5b284a[_0x377576(0x2d1)][_0x377576(0x30b)]('bg-slate-700',_0x377576(0x1fd));state['activeTab']=_0x3bb75c;const _0x5092e7={'dashboard':'ภาพรวมระบบ','data':_0x377576(0x2e8),'winners':_0x377576(0x1dc),'import':_0x377576(0x207),'labels':'ระบบจัดการฉลาก','qrcode-in':_0x377576(0x2e6),'logs':_0x377576(0x1e5)};document[_0x377576(0x280)](_0x377576(0x255))[_0x377576(0x1f5)]=_0x5092e7[_0x3bb75c]||_0x3bb75c;if(_0x3bb75c===_0x377576(0x2d3))window[_0x377576(0x307)][_0x377576(0x21b)]();_0x3bb75c===_0x377576(0x265)&&(window[_0x377576(0x307)][_0x377576(0x2ae)](),window[_0x377576(0x307)][_0x377576(0x2ac)]());if(_0x3bb75c===_0x377576(0x240))window[_0x377576(0x307)]['renderWinnersView']();if(_0x3bb75c===_0x377576(0x219))window[_0x377576(0x307)][_0x377576(0x1e7)]();if(_0x3bb75c==='logs')window[_0x377576(0x307)][_0x377576(0x267)]();lucide[_0x377576(0x242)]();},'renderDataSummary':()=>{const _0x3e35bc=_0x27412c,_0x3cf151=document[_0x3e35bc(0x280)]('data-summary-container');if(!_0x3cf151||state[_0x3e35bc(0x1cd)]!=='data')return;const _0x554efe=state['users']['filter'](_0x47d25e=>_0x47d25e[_0x3e35bc(0x264)]&&_0x47d25e[_0x3e35bc(0x264)]!=='')['length'],_0x17f32e=[],_0x3cf7dc=[{'bg':_0x3e35bc(0x1d3),'bar':_0x3e35bc(0x28c),'text':_0x3e35bc(0x1fd)},{'bg':_0x3e35bc(0x1cc),'bar':_0x3e35bc(0x28c),'text':_0x3e35bc(0x1fd)},{'bg':'bg-emerald-600','bar':_0x3e35bc(0x28c),'text':_0x3e35bc(0x1fd)},{'bg':_0x3e35bc(0x2e1),'bar':_0x3e35bc(0x28c),'text':'text-white'},{'bg':_0x3e35bc(0x2cb),'bar':_0x3e35bc(0x28c),'text':_0x3e35bc(0x1fd)}];_0x17f32e[_0x3e35bc(0x2f8)]({'type':'total','label':'สมาชิกทั้งหมด','total':state[_0x3e35bc(0x2c1)][_0x3e35bc(0x29b)],'registered':_0x554efe,'percent':state[_0x3e35bc(0x2c1)][_0x3e35bc(0x29b)]>0x0?Math[_0x3e35bc(0x1d0)](_0x554efe/state[_0x3e35bc(0x2c1)][_0x3e35bc(0x29b)]*0x64):0x0});const _0x8745f5=[_0x3e35bc(0x28f),'2000',_0x3e35bc(0x1c7),_0x3e35bc(0x1b8)];_0x8745f5[_0x3e35bc(0x1c0)](_0x2f6297=>{const _0x16aadf=_0x3e35bc,_0x57e860=state['users']['filter'](_0x538754=>normalizeReward(_0x538754[_0x16aadf(0x203)])===_0x2f6297),_0x55aba1=_0x57e860['filter'](_0x1bfd3f=>_0x1bfd3f[_0x16aadf(0x264)]&&_0x1bfd3f[_0x16aadf(0x264)]!=='')[_0x16aadf(0x29b)];_0x17f32e[_0x16aadf(0x2f8)]({'type':_0x16aadf(0x19f),'label':_0x2f6297,'total':_0x57e860[_0x16aadf(0x29b)],'registered':_0x55aba1,'percent':_0x57e860[_0x16aadf(0x29b)]>0x0?Math[_0x16aadf(0x1d0)](_0x55aba1/_0x57e860[_0x16aadf(0x29b)]*0x64):0x0});}),_0x3cf151['innerHTML']=_0x17f32e[_0x3e35bc(0x1db)]((_0x3eef4a,_0x5c7484)=>{const _0x211a31=_0x3e35bc,_0x120593=_0x3cf7dc[_0x5c7484%_0x3cf7dc[_0x211a31(0x29b)]];return _0x211a31(0x2b5)+_0x120593['bg']+_0x211a31(0x310)+_0x120593[_0x211a31(0x2c5)]+_0x211a31(0x213)+(_0x3eef4a[_0x211a31(0x302)]===_0x211a31(0x223)?_0x3eef4a[_0x211a31(0x1f3)]:_0x211a31(0x206)+_0x3eef4a[_0x211a31(0x1f3)])+_0x211a31(0x25d)+_0x3eef4a[_0x211a31(0x223)][_0x211a31(0x248)]()+_0x211a31(0x2f7)+_0x3eef4a[_0x211a31(0x1b3)]['toLocaleString']()+_0x211a31(0x2ef)+_0x3eef4a[_0x211a31(0x2eb)]+_0x211a31(0x268)+_0x120593[_0x211a31(0x24e)]+_0x211a31(0x309)+_0x3eef4a[_0x211a31(0x2eb)]+_0x211a31(0x237);})[_0x3e35bc(0x24a)]('');},'renderWinnersView':()=>{const _0x5bf05c=_0x27412c,_0x28362b=document[_0x5bf05c(0x280)](_0x5bf05c(0x2ff));if(!_0x28362b||state['activeTab']!=='winners')return;const _0x616de1=[_0x5bf05c(0x28f),'2000',_0x5bf05c(0x1c7),'4000'],_0x3d8c7a={'1000':'rose','2000':_0x5bf05c(0x271),'3000':_0x5bf05c(0x2de),'4000':_0x5bf05c(0x241)};_0x28362b[_0x5bf05c(0x2a4)]=_0x616de1['map'](_0x58d3e1=>{const _0x331a40=_0x5bf05c,_0x2125e0=_0x3d8c7a[_0x58d3e1]||'blue',_0xf1d4b2=state['cards'][_0x331a40(0x1e9)](_0x2375c2=>normalizeReward(_0x2375c2[_0x331a40(0x203)])===_0x58d3e1),_0x34537f=state[_0x331a40(0x2c1)]['filter'](_0x42ddb6=>normalizeReward(_0x42ddb6[_0x331a40(0x203)])===_0x58d3e1),_0x284183=[...new Set(_0xf1d4b2[_0x331a40(0x1db)](_0xb1eaf=>_0xb1eaf[_0x331a40(0x25f)])[_0x331a40(0x1e9)](_0x5fb751=>_0x5fb751&&_0x5fb751[_0x331a40(0x26a)]()!==''))],_0x19f2b5=_0xf1d4b2['filter'](_0x2b973d=>_0x2b973d['Datetime']&&_0x2b973d[_0x331a40(0x1fe)]!==''),_0x28b514=_0x19f2b5[_0x331a40(0x1e9)](_0x4ce60d=>_0x4ce60d[_0x331a40(0x25f)]&&_0x4ce60d[_0x331a40(0x25f)]['trim']()!==''),_0x22ed0d=_0x28b514[_0x331a40(0x29b)]===0x0?_0x331a40(0x1ec):_0x28b514[_0x331a40(0x1db)](_0xbe99f=>'<div\x20class=\x22flex\x20flex-col\x20py-2\x20border-b\x20border-slate-50\x20last:border-0\x20px-2\x20font-bold\x22><span\x20class=\x22text-slate-800\x20text-lg\x22>'+(_0xbe99f[_0x331a40(0x225)]||_0x331a40(0x29a))+_0x331a40(0x30c)+_0x2125e0+_0x331a40(0x2e3)+_0xbe99f[_0x331a40(0x25f)]+'</span><span\x20class=\x22text-[9px]\x20text-slate-300\x20font-normal\x20mt-0.5\x22>'+formatDate(_0xbe99f[_0x331a40(0x1fe)])+_0x331a40(0x2b8))['join']('');return _0x331a40(0x2dd)+_0x2125e0+_0x331a40(0x228)+_0x58d3e1+_0x331a40(0x27d)+_0x2125e0+_0x331a40(0x24d)+_0x2125e0+'-700\x22>'+(_0x284183[_0x331a40(0x29b)]>0x0?_0x284183['join'](',\x20'):_0x331a40(0x2ee))+_0x331a40(0x2a0)+_0x22ed0d+_0x331a40(0x2a9)+_0x19f2b5[_0x331a40(0x29b)]+_0x331a40(0x1e4)+_0xf1d4b2['length']+_0x331a40(0x2a2)+_0x2125e0+_0x331a40(0x233)+(_0xf1d4b2[_0x331a40(0x29b)]?_0x19f2b5['length']/_0xf1d4b2[_0x331a40(0x29b)]*0x64:0x0)+'%\x22></div></div><p\x20class=\x22text-[12px]\x20text-slate-400\x20mt-2\x20text-right\x20font-bold\x20text-slate-600\x20italic\x22>พนักงานในกลุ่มนี้:\x20'+_0x34537f['length']+_0x331a40(0x1e8);})['join']('');},'renderLabelTable':()=>{const _0x39af2f=_0x27412c,_0x43ee3d=document['getElementById'](_0x39af2f(0x287)),_0x406dba=document[_0x39af2f(0x280)](_0x39af2f(0x2ba)),_0x156f46=document[_0x39af2f(0x280)](_0x39af2f(0x2db));if(!_0x43ee3d||state[_0x39af2f(0x1cd)]!==_0x39af2f(0x2d3))return;let _0x3d2b3=state[_0x39af2f(0x1eb)]===''?[...state[_0x39af2f(0x20e)]]:state[_0x39af2f(0x20e)][_0x39af2f(0x1e9)](_0x25dcf7=>normalizeReward(_0x25dcf7['Reward'])===state['selectedLabelGroup']);_0x3d2b3['sort']((_0x44397c,_0x5f24fe)=>{const _0x11be90=_0x39af2f;let _0x279a46=_0x44397c[state['labelSortKey']],_0x53de2c=_0x5f24fe[state[_0x11be90(0x270)]];if(state[_0x11be90(0x270)]===_0x11be90(0x2b6)||state[_0x11be90(0x270)]===_0x11be90(0x203)){const _0x134a70=parseFloat(String(_0x279a46||'')['replace'](/,/g,''))||0x0,_0x3f9ed3=parseFloat(String(_0x53de2c||'')['replace'](/,/g,''))||0x0;return state[_0x11be90(0x220)]==='asc'?_0x134a70-_0x3f9ed3:_0x3f9ed3-_0x134a70;}if(state[_0x11be90(0x270)]===_0x11be90(0x1fe)){const _0x5bfada=_0x279a46?.[_0x11be90(0x1c1)]?_0x279a46[_0x11be90(0x1c1)]()[_0x11be90(0x22e)]():new Date(_0x279a46)[_0x11be90(0x22e)]()||0x0,_0x19d7dc=_0x53de2c?.[_0x11be90(0x1c1)]?_0x53de2c[_0x11be90(0x1c1)]()[_0x11be90(0x22e)]():new Date(_0x53de2c)[_0x11be90(0x22e)]()||0x0;return state[_0x11be90(0x220)]===_0x11be90(0x25c)?_0x5bfada-_0x19d7dc:_0x19d7dc-_0x5bfada;}return state['labelSortOrder']===_0x11be90(0x25c)?String(_0x279a46||'')['localeCompare'](String(_0x53de2c||''),'th',{'numeric':!![]}):String(_0x53de2c||'')[_0x11be90(0x204)](String(_0x279a46||''),'th',{'numeric':!![]});});const _0x342834=_0x3d2b3[_0x39af2f(0x29b)],_0x3c4b86=Math[_0x39af2f(0x257)](_0x342834/0x32)||0x1;if(state['labelPage']>_0x3c4b86)state[_0x39af2f(0x1ea)]=_0x3c4b86;const _0x815b1f=_0x3d2b3[_0x39af2f(0x2bb)]((state[_0x39af2f(0x1ea)]-0x1)*0x32,state[_0x39af2f(0x1ea)]*0x32);if(_0x406dba)_0x406dba[_0x39af2f(0x1f5)]=_0x39af2f(0x1f0)+((state['labelPage']-0x1)*0x32+0x1)+'\x20-\x20'+Math[_0x39af2f(0x1a7)](state['labelPage']*0x32,_0x342834)+_0x39af2f(0x230)+_0x342834;if(_0x156f46)_0x156f46[_0x39af2f(0x2a4)]=_0x39af2f(0x231)+(state['labelPage']<=0x1?'disabled':'')+'>Prev</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20'+state[_0x39af2f(0x1ea)]+'/'+_0x3c4b86+_0x39af2f(0x1a2)+(state[_0x39af2f(0x1ea)]>=_0x3c4b86?_0x39af2f(0x21f):'')+_0x39af2f(0x1c2);_0x43ee3d['innerHTML']=_0x815b1f[_0x39af2f(0x1db)](_0x5ab5ba=>{const _0x18d892=_0x39af2f,_0x2eb16a=!!_0x5ab5ba['Datetime'],_0x41dba6=(_0x5ab5ba[_0x18d892(0x25f)]||'')[_0x18d892(0x21d)](/'/g,'\x5c\x27');return _0x18d892(0x21e)+(_0x5ab5ba['CardNo']||'-')+_0x18d892(0x212)+(_0x5ab5ba[_0x18d892(0x203)]||'-')+'</td><td\x20class=\x22px-6\x20text-indigo-600\x20font-bold\x20font-bold\x22>'+(_0x5ab5ba['rewardname']||'-')+_0x18d892(0x1ad)+(_0x5ab5ba['EmpName']||'-')+'</td><td\x20class=\x22px-6\x20text-slate-500\x20font-bold\x22>'+formatDate(_0x5ab5ba['Datetime'])+_0x18d892(0x291)+(!_0x2eb16a?_0x18d892(0x286)+_0x5ab5ba['id']+'\x27,\x20\x27'+_0x41dba6+'\x27)':'')+'\x22\x20class=\x22text-indigo-600\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-indigo-200\x20rounded-lg\x20hover:bg-indigo-50\x20transition\x20'+(_0x2eb16a?_0x18d892(0x2b3):'')+'\x22\x20'+(_0x2eb16a?_0x18d892(0x21f):'')+_0x18d892(0x246)+(!!_0x5ab5ba[_0x18d892(0x1fe)]?_0x18d892(0x2dc)+_0x5ab5ba['id']+'\x27)':'')+_0x18d892(0x238)+(!_0x5ab5ba['Datetime']?_0x18d892(0x2b3):_0x18d892(0x1be))+_0x18d892(0x251)+(!_0x5ab5ba['Datetime']?_0x18d892(0x21f):'')+_0x18d892(0x2d6);})[_0x39af2f(0x24a)](''),lucide[_0x39af2f(0x242)]();},'exportDataToCSV':()=>{const _0x5299be=_0x27412c;let _0x503309=state[_0x5299be(0x2c1)][_0x5299be(0x1e9)](_0x4e75d3=>(_0x4e75d3[_0x5299be(0x225)]||'')[_0x5299be(0x1dd)]()[_0x5299be(0x30a)](state['searchTerm'])&&(state[_0x5299be(0x2d4)]===''||String(_0x4e75d3[_0x5299be(0x203)])===String(state[_0x5299be(0x2d4)])));if(_0x503309[_0x5299be(0x29b)]===0x0)return window['app'][_0x5299be(0x23c)](_0x5299be(0x295),'error');_0x503309[_0x5299be(0x30f)]((_0x9b82e9,_0x163cdf)=>(parseFloat(_0x9b82e9['no'])||0x0)-(parseFloat(_0x163cdf['no'])||0x0));const _0x29ec80=['NO.',_0x5299be(0x29d),'Reward\x20(Group)',_0x5299be(0x22d),'สุ่มครั้งที่\x201\x20(DateLogin)',_0x5299be(0x2e5),_0x5299be(0x276)],_0x29c6b3=_0x503309[_0x5299be(0x1db)](_0x3f1555=>[_0x3f1555['no']||'',_0x3f1555[_0x5299be(0x225)]||'',_0x3f1555['Reward']||'',formatDate(_0x3f1555['DateCheck']),formatDate(_0x3f1555['DateLogin']),formatDate(_0x3f1555[_0x5299be(0x2f5)]),_0x3f1555['StatusReward']||'']),_0x21ff77='\ufeff'+[_0x29ec80,..._0x29c6b3][_0x5299be(0x1db)](_0x1575cc=>_0x1575cc[_0x5299be(0x1db)](_0x2c3c75=>'\x22'+_0x2c3c75+'\x22')['join'](','))[_0x5299be(0x24a)]('\x0a'),_0x5efe62=new Blob([_0x21ff77],{'type':'text/csv;charset=utf-8;'}),_0x2a124c=document['createElement']('a'),_0x3a61c5=URL[_0x5299be(0x1d1)](_0x5efe62);_0x2a124c[_0x5299be(0x2e0)](_0x5299be(0x272),_0x3a61c5),_0x2a124c[_0x5299be(0x2e0)](_0x5299be(0x245),_0x5299be(0x2cf)+new Date()[_0x5299be(0x22e)]()+_0x5299be(0x256)),_0x2a124c['style'][_0x5299be(0x2d9)]='hidden',document[_0x5299be(0x296)][_0x5299be(0x1c4)](_0x2a124c),_0x2a124c['click'](),document[_0x5299be(0x296)]['removeChild'](_0x2a124c);},'exportLabelsToCSV':()=>{const _0xa7856d=_0x27412c;let _0x44f0ce=state[_0xa7856d(0x1eb)]===''?[...state[_0xa7856d(0x20e)]]:state['cards'][_0xa7856d(0x1e9)](_0x1834e5=>normalizeReward(_0x1834e5[_0xa7856d(0x203)])===state[_0xa7856d(0x1eb)]);if(_0x44f0ce[_0xa7856d(0x29b)]===0x0)return window['app'][_0xa7856d(0x23c)]('ไม่มีข้อมูลสำหรับดาวน์โหลด',_0xa7856d(0x1da));_0x44f0ce['sort']((_0x31c6ab,_0x296e6a)=>(parseInt(_0x31c6ab[_0xa7856d(0x2b6)])||0x0)-(parseInt(_0x296e6a[_0xa7856d(0x2b6)])||0x0));const _0x5cf9e3=['ลำดับที่','Reward\x20(กลุ่ม)',_0xa7856d(0x1f4),_0xa7856d(0x2b4),'Datetime'],_0x188b78=_0x44f0ce[_0xa7856d(0x1db)](_0x37d3cb=>[_0x37d3cb[_0xa7856d(0x2b6)]||'',_0x37d3cb['Reward']||'',_0x37d3cb[_0xa7856d(0x25f)]||'',_0x37d3cb[_0xa7856d(0x225)]||'',formatDate(_0x37d3cb['Datetime'])]),_0x489480='\ufeff'+[_0x5cf9e3,..._0x188b78][_0xa7856d(0x1db)](_0x58de24=>_0x58de24['map'](_0x1d8af0=>'\x22'+_0x1d8af0+'\x22')[_0xa7856d(0x24a)](','))[_0xa7856d(0x24a)]('\x0a'),_0x26194a=new Blob([_0x489480],{'type':_0xa7856d(0x303)}),_0x3bb281=document[_0xa7856d(0x218)]('a'),_0x251796=URL[_0xa7856d(0x1d1)](_0x26194a);_0x3bb281[_0xa7856d(0x2e0)](_0xa7856d(0x272),_0x251796),_0x3bb281[_0xa7856d(0x2e0)]('download',_0xa7856d(0x1fc)+(state[_0xa7856d(0x1eb)]||_0xa7856d(0x308))+'_'+new Date()['getTime']()+_0xa7856d(0x256)),_0x3bb281[_0xa7856d(0x26b)][_0xa7856d(0x2d9)]='hidden',document[_0xa7856d(0x296)][_0xa7856d(0x1c4)](_0x3bb281),_0x3bb281['click'](),document['body']['removeChild'](_0x3bb281);},'renderLogTable':()=>{const _0x548a1f=_0x27412c,_0xa7b8ca=document['getElementById']('log-table-body'),_0x1004c6=document[_0x548a1f(0x280)](_0x548a1f(0x28d));if(!_0xa7b8ca)return;let _0x39cfb1=[...state[_0x548a1f(0x20d)]];_0x39cfb1[_0x548a1f(0x30f)]((_0x50bfb8,_0x1cd164)=>{const _0x5b2477=_0x548a1f;let _0x3ef815=_0x50bfb8[state[_0x5b2477(0x2c9)]],_0x2901a7=_0x1cd164[state[_0x5b2477(0x2c9)]];state[_0x5b2477(0x2c9)]===_0x5b2477(0x1fe)&&(_0x3ef815=_0x50bfb8['Datetime']?.[_0x5b2477(0x1c1)]?_0x50bfb8[_0x5b2477(0x1fe)][_0x5b2477(0x1c1)]()[_0x5b2477(0x22e)]():new Date(_0x50bfb8[_0x5b2477(0x1fe)])[_0x5b2477(0x22e)](),_0x2901a7=_0x1cd164[_0x5b2477(0x1fe)]?.[_0x5b2477(0x1c1)]?_0x1cd164[_0x5b2477(0x1fe)]['toDate']()[_0x5b2477(0x22e)]():new Date(_0x1cd164[_0x5b2477(0x1fe)])[_0x5b2477(0x22e)]());if(state[_0x5b2477(0x2c9)]===_0x5b2477(0x263))return state[_0x5b2477(0x2e4)]===_0x5b2477(0x25c)?0x1:-0x1;return state[_0x5b2477(0x2e4)]===_0x5b2477(0x25c)?String(_0x3ef815||'')['localeCompare'](String(_0x2901a7||''),'th'):String(_0x2901a7||'')[_0x5b2477(0x204)](String(_0x3ef815||''),'th');});const _0x165124=_0x39cfb1['length'],_0x24665a=Math[_0x548a1f(0x257)](_0x165124/0x32)||0x1;if(state[_0x548a1f(0x2f0)]>_0x24665a)state[_0x548a1f(0x2f0)]=_0x24665a;const _0x3fa2c2=_0x39cfb1[_0x548a1f(0x2bb)]((state[_0x548a1f(0x2f0)]-0x1)*0x32,state[_0x548a1f(0x2f0)]*0x32);if(document[_0x548a1f(0x280)](_0x548a1f(0x229)))document[_0x548a1f(0x280)](_0x548a1f(0x229))[_0x548a1f(0x1f5)]=_0x165124[_0x548a1f(0x248)]();_0xa7b8ca[_0x548a1f(0x2a4)]=_0x3fa2c2[_0x548a1f(0x1db)]((_0x1f2e4d,_0xa50d80)=>_0x548a1f(0x1ff)+((state[_0x548a1f(0x2f0)]-0x1)*0x32+_0xa50d80+0x1)+_0x548a1f(0x209)+_0x1f2e4d[_0x548a1f(0x261)]+'\x22>'+(_0x1f2e4d['citizenId']||'-')+_0x548a1f(0x20f)+(_0x1f2e4d[_0x548a1f(0x225)]||'-')+_0x548a1f(0x2c7)+(_0x1f2e4d[_0x548a1f(0x1fb)]||'Success')+_0x548a1f(0x1b9)+(_0x1f2e4d[_0x548a1f(0x284)]||'-')+_0x548a1f(0x29e)+formatDate(_0x1f2e4d['Datetime'])+_0x548a1f(0x28e))[_0x548a1f(0x24a)]('');if(_0x1004c6)_0x1004c6[_0x548a1f(0x2a4)]=_0x548a1f(0x26d)+(state[_0x548a1f(0x2f0)]<=0x1?_0x548a1f(0x21f):'')+_0x548a1f(0x278)+state[_0x548a1f(0x2f0)]+'/'+_0x24665a+_0x548a1f(0x2f2)+(state[_0x548a1f(0x2f0)]>=_0x24665a?_0x548a1f(0x21f):'')+_0x548a1f(0x1c2);lucide['createIcons']();},'openDeleteLogsModal':()=>{const _0x5ef3ab=_0x27412c;window['app']['showLabelModal']('Delete',_0x5ef3ab(0x1de),_0x5ef3ab(0x1e0),_0x5ef3ab(0x2d5),async()=>{const _0x12d2e9=_0x5ef3ab;try{const _0x56af31=await getDocs(collection(db,logCollectionPath)),_0x4db0d2=0x190,_0x2c7b0e=chunkArray(_0x56af31['docs'],_0x4db0d2);for(const _0x4716a6 of _0x2c7b0e){const _0x1fa4e8=writeBatch(db);_0x4716a6[_0x12d2e9(0x1c0)](_0x1db235=>_0x1fa4e8[_0x12d2e9(0x224)](_0x1db235[_0x12d2e9(0x2aa)])),await _0x1fa4e8[_0x12d2e9(0x200)]();}window[_0x12d2e9(0x307)][_0x12d2e9(0x23c)](_0x12d2e9(0x290));}catch(_0x24723f){window[_0x12d2e9(0x307)][_0x12d2e9(0x23c)](_0x12d2e9(0x1ce),_0x12d2e9(0x1da));}});},'changeLogSort':_0x4384f1=>{const _0x230ccd=_0x27412c;state[_0x230ccd(0x2e4)]=state[_0x230ccd(0x2c9)]===_0x4384f1?state[_0x230ccd(0x2e4)]===_0x230ccd(0x25c)?_0x230ccd(0x285):'asc':_0x230ccd(0x285),state[_0x230ccd(0x2c9)]=_0x4384f1,window[_0x230ccd(0x307)][_0x230ccd(0x267)]();},'exportLogsToCSV':()=>{const _0x1fdf8f=_0x27412c;if(state[_0x1fdf8f(0x20d)][_0x1fdf8f(0x29b)]===0x0)return window['app']['showToast'](_0x1fdf8f(0x295),_0x1fdf8f(0x1da));const _0x447a24=[_0x1fdf8f(0x1ed),_0x1fdf8f(0x261),_0x1fdf8f(0x225),_0x1fdf8f(0x1fb),_0x1fdf8f(0x284),_0x1fdf8f(0x1fe)],_0x24965c=state['logs'][_0x1fdf8f(0x1db)]((_0x2a9f4f,_0x5386f2)=>[_0x5386f2+0x1,'\x09'+(_0x2a9f4f[_0x1fdf8f(0x261)]||''),_0x2a9f4f[_0x1fdf8f(0x225)]||'',_0x2a9f4f[_0x1fdf8f(0x1fb)]||_0x1fdf8f(0x22c),_0x2a9f4f[_0x1fdf8f(0x284)]||'',formatDate(_0x2a9f4f[_0x1fdf8f(0x1fe)])]),_0x5d5d64='\ufeff'+[_0x447a24,..._0x24965c][_0x1fdf8f(0x1db)](_0x3e1e81=>_0x3e1e81['map'](_0x2d6115=>'\x22'+_0x2d6115+'\x22')[_0x1fdf8f(0x24a)](','))[_0x1fdf8f(0x24a)]('\x0a'),_0x3429a1=new Blob([_0x5d5d64],{'type':_0x1fdf8f(0x303)}),_0x5d5544=document[_0x1fdf8f(0x218)]('a'),_0x57fa3c=URL[_0x1fdf8f(0x1d1)](_0x3429a1);_0x5d5544[_0x1fdf8f(0x2e0)](_0x1fdf8f(0x272),_0x57fa3c),_0x5d5544[_0x1fdf8f(0x2e0)](_0x1fdf8f(0x245),_0x1fdf8f(0x1fa)+new Date()[_0x1fdf8f(0x22e)]()+_0x1fdf8f(0x256)),_0x5d5544['style'][_0x1fdf8f(0x2d9)]=_0x1fdf8f(0x2d7),document['body']['appendChild'](_0x5d5544),_0x5d5544[_0x1fdf8f(0x2f4)](),document[_0x1fdf8f(0x296)]['removeChild'](_0x5d5544);},'onDataRewardFilterChange':_0x25e2c4=>{const _0x592d37=_0x27412c;state[_0x592d37(0x2d4)]=_0x25e2c4,state[_0x592d37(0x2ec)]=0x1,window['app']['renderTable']();},'handleSearch':_0x3871d3=>{const _0x1824a7=_0x27412c;state[_0x1824a7(0x1c6)]=_0x3871d3[_0x1824a7(0x1dd)](),state['currentPage']=0x1,window[_0x1824a7(0x307)][_0x1824a7(0x2ac)]();},'changeRowsLimit':_0x5f33fe=>{const _0x8989df=_0x27412c;state['rowsPerPage']=parseInt(_0x5f33fe),state[_0x8989df(0x2ec)]=0x1,window['app'][_0x8989df(0x2ac)]();},'changePage':_0x5af08d=>{const _0x1ea286=_0x27412c;state['currentPage']+=_0x5af08d,window[_0x1ea286(0x307)][_0x1ea286(0x2ac)]();},'changeSort':_0x5cb5e5=>{const _0x44297a=_0x27412c;state[_0x44297a(0x234)]=state[_0x44297a(0x1b6)]===_0x5cb5e5?state[_0x44297a(0x234)]===_0x44297a(0x25c)?_0x44297a(0x285):_0x44297a(0x25c):_0x5cb5e5==='no'?_0x44297a(0x25c):_0x44297a(0x285),state[_0x44297a(0x1b6)]=_0x5cb5e5,window[_0x44297a(0x307)][_0x44297a(0x2ac)]();},'renderTable':()=>{const _0x5e0994=_0x27412c,_0x25d6ee=document[_0x5e0994(0x280)](_0x5e0994(0x24f));if(!_0x25d6ee||state[_0x5e0994(0x1cd)]!==_0x5e0994(0x265))return;let _0x38f2ae=state[_0x5e0994(0x2c1)]['filter'](_0x1d5395=>(_0x1d5395[_0x5e0994(0x225)]||'')[_0x5e0994(0x1dd)]()[_0x5e0994(0x30a)](state[_0x5e0994(0x1c6)])&&(state['selectedDataReward']===''||String(_0x1d5395[_0x5e0994(0x203)])===String(state['selectedDataReward'])));_0x38f2ae[_0x5e0994(0x30f)]((_0x2edd97,_0x261725)=>{const _0x807167=_0x5e0994,_0x333081=_0x2edd97[state[_0x807167(0x1b6)]],_0x484504=_0x261725[state[_0x807167(0x1b6)]];if(state['sortBy']==='no'||!isNaN(_0x333081)&&!isNaN(_0x484504)&&_0x333081!==''&&_0x484504!=='')return state['sortOrder']===_0x807167(0x25c)?(parseFloat(_0x333081)||0x0)-(parseFloat(_0x484504)||0x0):(parseFloat(_0x484504)||0x0)-(parseFloat(_0x333081)||0x0);return state[_0x807167(0x234)]===_0x807167(0x25c)?String(_0x333081||'')[_0x807167(0x204)](String(_0x484504||''),'th',{'numeric':!![]}):String(_0x484504||'')[_0x807167(0x204)](String(_0x333081||''),'th',{'numeric':!![]});});const _0x5dc55c=_0x38f2ae[_0x5e0994(0x2bb)]((state['currentPage']-0x1)*state[_0x5e0994(0x1c8)],state[_0x5e0994(0x2ec)]*state['rowsPerPage']);_0x25d6ee['innerHTML']=_0x5dc55c[_0x5e0994(0x1db)](_0x24dfb1=>_0x5e0994(0x1cb)+(_0x24dfb1['no']||'-')+_0x5e0994(0x23e)+(_0x24dfb1[_0x5e0994(0x225)]||'-')+'</td><td\x20class=\x22px-6\x20py-4\x20font-normal\x20font-bold\x22>'+(_0x24dfb1['Reward']||'-')+_0x5e0994(0x1d4)+formatDate(_0x24dfb1[_0x5e0994(0x264)])+_0x5e0994(0x1ac)+formatDate(_0x24dfb1[_0x5e0994(0x1d8)])+_0x5e0994(0x1ac)+formatDate(_0x24dfb1[_0x5e0994(0x2f5)])+_0x5e0994(0x2fa)+(_0x24dfb1['StatusReward']||'-')+_0x5e0994(0x215)+_0x24dfb1['id']+_0x5e0994(0x1df))[_0x5e0994(0x24a)]('');if(document[_0x5e0994(0x280)](_0x5e0994(0x30d)))document[_0x5e0994(0x280)](_0x5e0994(0x30d))[_0x5e0994(0x1f5)]='แสดง\x20'+_0x5dc55c[_0x5e0994(0x29b)]+_0x5e0994(0x1b4)+_0x38f2ae[_0x5e0994(0x29b)]+_0x5e0994(0x25b);const _0x297727=document[_0x5e0994(0x280)](_0x5e0994(0x217));if(_0x297727)_0x297727[_0x5e0994(0x2a4)]=_0x5e0994(0x1f8)+(state[_0x5e0994(0x2ec)]<=0x1?_0x5e0994(0x21f):'')+_0x5e0994(0x2f6)+state[_0x5e0994(0x2ec)]+_0x5e0994(0x1af)+(state[_0x5e0994(0x2ec)]*state[_0x5e0994(0x1c8)]>=_0x38f2ae['length']?_0x5e0994(0x21f):'')+_0x5e0994(0x1d2);lucide[_0x5e0994(0x242)]();},'openResetModal':()=>{const _0x335d70=_0x27412c;window['app'][_0x335d70(0x2a3)]('Reset',_0x335d70(0x249),_0x335d70(0x2ed),_0x335d70(0x27c),async()=>{const _0x4b3bd6=_0x335d70;try{const _0x100bd3=await getDocs(collection(db,finalCollectionPath)),_0x1ed6b9=writeBatch(db);_0x100bd3[_0x4b3bd6(0x2b2)][_0x4b3bd6(0x1c0)](_0xd622c3=>_0x1ed6b9[_0x4b3bd6(0x2cd)](_0xd622c3[_0x4b3bd6(0x2aa)],{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''})),await _0x1ed6b9[_0x4b3bd6(0x200)](),window[_0x4b3bd6(0x307)][_0x4b3bd6(0x23c)]('รีเซ็ตสำเร็จ');}catch(_0x2ce3e3){window[_0x4b3bd6(0x307)][_0x4b3bd6(0x23c)](_0x4b3bd6(0x1ce),_0x4b3bd6(0x1da));}});},'openDeleteModal':()=>{const _0x4dfc2c=_0x27412c;window[_0x4dfc2c(0x307)]['showLabelModal'](_0x4dfc2c(0x2a8),'ลบข้อมูลพนักงานทั้งหมด?',_0x4dfc2c(0x26e),_0x4dfc2c(0x2d5),async()=>{const _0x423701=_0x4dfc2c;try{const _0x3ae1e6=await getDocs(collection(db,finalCollectionPath)),_0x3be91b=chunkArray(_0x3ae1e6['docs'],0x190);for(const _0x4afa76 of _0x3be91b){const _0x289a06=writeBatch(db);_0x4afa76[_0x423701(0x1c0)](_0x4c7f85=>_0x289a06[_0x423701(0x224)](_0x4c7f85[_0x423701(0x2aa)])),await _0x289a06[_0x423701(0x200)]();}window[_0x423701(0x307)][_0x423701(0x23c)](_0x423701(0x232));}catch(_0x57568d){window[_0x423701(0x307)][_0x423701(0x23c)](_0x423701(0x1ce),_0x423701(0x1da));}});},'openDeleteLabelsModal':()=>{const _0x50aa24=_0x27412c;window[_0x50aa24(0x307)][_0x50aa24(0x2a3)](_0x50aa24(0x2a8),'ลบฉลากทั้งหมด?',_0x50aa24(0x236),_0x50aa24(0x2d5),async()=>{const _0x3950a6=_0x50aa24;try{const _0x130e0b=await getDocs(collection(db,cardCollectionPath)),_0x5413b4=chunkArray(_0x130e0b[_0x3950a6(0x2b2)],0x190);for(const _0x31ef54 of _0x5413b4){const _0x31560c=writeBatch(db);_0x31ef54['forEach'](_0x352651=>_0x31560c[_0x3950a6(0x224)](_0x352651[_0x3950a6(0x2aa)])),await _0x31560c[_0x3950a6(0x200)]();}const _0x43289d=await getDocs(collection(db,finalCollectionPath)),_0x540770=chunkArray(_0x43289d[_0x3950a6(0x2b2)],0x190);for(const _0x37ded0 of _0x540770){const _0x1da075=writeBatch(db);_0x37ded0[_0x3950a6(0x1c0)](_0x1e1087=>_0x1da075[_0x3950a6(0x2cd)](_0x1e1087['ref'],{'DateLogin':'','StatusReward':'','DateReward':'','CardNo':''})),await _0x1da075[_0x3950a6(0x200)]();}window[_0x3950a6(0x307)][_0x3950a6(0x23c)](_0x3950a6(0x1b0));}catch(_0x4047f3){window[_0x3950a6(0x307)][_0x3950a6(0x23c)]('เกิดข้อผิดพลาด',_0x3950a6(0x1da));}});},'openCreateLabelsModal':()=>{const _0x26f946=_0x27412c;window[_0x26f946(0x307)][_0x26f946(0x2a3)](_0x26f946(0x30e),_0x26f946(0x2cc),_0x26f946(0x2d2),_0x26f946(0x1f2),async()=>{const _0x393062=_0x26f946;try{await window[_0x393062(0x307)][_0x393062(0x258)](),window['app'][_0x393062(0x23c)](_0x393062(0x299));}catch(_0x5c5816){window['app'][_0x393062(0x23c)](_0x393062(0x1ce),'error');}});},'generateLabels':async()=>{const _0x47b705=_0x27412c;if(state['users'][_0x47b705(0x29b)]===0x0){window[_0x47b705(0x307)]['showToast'](_0x47b705(0x239),_0x47b705(0x1da));return;}const _0x5d7021=await getDocs(collection(db,cardCollectionPath)),_0x3df67f=chunkArray(_0x5d7021[_0x47b705(0x2b2)],0x190);for(const _0x3b6850 of _0x3df67f){const _0x3e6aa5=writeBatch(db);_0x3b6850[_0x47b705(0x1c0)](_0xcf42e=>_0x3e6aa5['delete'](_0xcf42e[_0x47b705(0x2aa)])),await _0x3e6aa5[_0x47b705(0x200)]();}const _0x4cf257={},_0x51cd2c=state[_0x47b705(0x2c1)][_0x47b705(0x1db)](_0x4348e6=>{const _0xbca5ec=_0x47b705,_0x5047db=String(_0x4348e6[_0xbca5ec(0x203)]||_0xbca5ec(0x222))[_0xbca5ec(0x26a)]();return _0x4cf257[_0x5047db]=(_0x4cf257[_0x5047db]||0x0)+0x1,{'Reward':_0x5047db,'rewardname':'','CardNo':String(_0x4cf257[_0x5047db]),'EmpName':'','citizenId':'','Datetime':''};}),_0x5d2eb2=chunkArray(_0x51cd2c,0x190);for(const _0x2555f7 of _0x5d2eb2){const _0x9bf6a1=writeBatch(db);_0x2555f7['forEach'](_0x4f17c9=>_0x9bf6a1[_0x47b705(0x26f)](doc(collection(db,cardCollectionPath)),_0x4f17c9)),await _0x9bf6a1[_0x47b705(0x200)]();}},'handleFileSelect':_0x266e03=>{const _0x570d05=_0x27412c,_0x1ae1ae=_0x266e03['target'][_0x570d05(0x2ea)][0x0];_0x1ae1ae&&(document['getElementById']('file-name')[_0x570d05(0x1f5)]=_0x1ae1ae[_0x570d05(0x2ad)],document['getElementById'](_0x570d05(0x2c6))['classList']['remove']('hidden'),document['getElementById'](_0x570d05(0x289))[_0x570d05(0x21f)]=![]);},'clearFileSelection':()=>{const _0x13c0ee=_0x27412c;document[_0x13c0ee(0x280)]('file-upload')[_0x13c0ee(0x253)]='',document[_0x13c0ee(0x280)]('file-info')[_0x13c0ee(0x2d1)][_0x13c0ee(0x30b)](_0x13c0ee(0x2d7)),document[_0x13c0ee(0x280)]('btn-import')[_0x13c0ee(0x21f)]=!![];},'processImport':async()=>{const _0x1cde12=_0x27412c,_0x351885=document[_0x1cde12(0x280)](_0x1cde12(0x2e7)),_0x2880e5=_0x351885[_0x1cde12(0x2ea)][0x0];if(!_0x2880e5)return;document[_0x1cde12(0x280)]('import-progress')[_0x1cde12(0x2d1)][_0x1cde12(0x1a1)](_0x1cde12(0x2d7));const _0x45bb1a=document[_0x1cde12(0x280)](_0x1cde12(0x23b)),_0x530354=new FileReader();_0x530354[_0x1cde12(0x1b7)]=async _0x2c71c5=>{const _0x1e8f4e=_0x1cde12;try{const _0x440209=_0x2880e5['name'][_0x1e8f4e(0x301)](_0x1e8f4e(0x1b2))?JSON[_0x1e8f4e(0x2c4)](_0x2c71c5[_0x1e8f4e(0x269)][_0x1e8f4e(0x244)]):csvToJson(_0x2c71c5['target'][_0x1e8f4e(0x244)]),_0x3c904c=_0x440209[_0x1e8f4e(0x29b)];for(let _0x26c537=0x0;_0x26c537<_0x3c904c;_0x26c537+=0x190){const _0x323bc3=_0x440209[_0x1e8f4e(0x2bb)](_0x26c537,_0x26c537+0x190),_0xb1c05b=writeBatch(db),_0xd5beb6=_0x323bc3[_0x1e8f4e(0x1db)](async(_0x328cbb,_0x480e89)=>{const _0x3d5e43=_0x1e8f4e,_0x400482=String(_0x328cbb[_0x3d5e43(0x261)]||'')[_0x3d5e43(0x21d)](/-/g,'')['trim'](),_0x4d6158=await sha256(_0x400482),_0x27e095=(_0x26c537+_0x480e89+0x1)['toString'](),_0x2cb8e5=doc(collection(db,finalCollectionPath));_0xb1c05b[_0x3d5e43(0x26f)](_0x2cb8e5,{'citizenId':_0x4d6158,'no':_0x27e095,'EmpName':_0x328cbb[_0x3d5e43(0x225)]||_0x328cbb[_0x3d5e43(0x252)]||'','Dateworking':_0x328cbb[_0x3d5e43(0x26c)]||'','Datework':_0x328cbb[_0x3d5e43(0x27f)]||'','Reward':_0x328cbb[_0x3d5e43(0x203)]||'','DateLogin':_0x328cbb['DateLogin']||'','StatusReward':_0x328cbb[_0x3d5e43(0x1d7)]||'','DateReward':_0x328cbb['DateReward']||'','DateCheck':_0x328cbb[_0x3d5e43(0x264)]||'','importedAt':serverTimestamp()});});await Promise[_0x1e8f4e(0x308)](_0xd5beb6),await _0xb1c05b['commit'](),_0x45bb1a[_0x1e8f4e(0x26b)][_0x1e8f4e(0x235)]=Math[_0x1e8f4e(0x1a7)](0x64,Math[_0x1e8f4e(0x1d0)]((_0x26c537+_0x323bc3['length'])/_0x3c904c*0x64))+'%';}window[_0x1e8f4e(0x307)]['showToast']('นำเข้าข้อมูลเรียบร้อย'),window['app']['clearFileSelection']();}catch(_0x98cb02){window[_0x1e8f4e(0x307)]['showToast']('ผิดพลาด:\x20'+_0x98cb02['message'],'error');}finally{document[_0x1e8f4e(0x280)](_0x1e8f4e(0x274))[_0x1e8f4e(0x2d1)][_0x1e8f4e(0x30b)](_0x1e8f4e(0x2d7));}},_0x530354[_0x1cde12(0x1c5)](_0x2880e5);},'refreshCharts':()=>{const _0x2184a1=_0x27412c,_0x2c9f95=document[_0x2184a1(0x280)](_0x2184a1(0x2a5));if(_0x2c9f95){if(window[_0x2184a1(0x2a1)])window[_0x2184a1(0x2a1)][_0x2184a1(0x1d9)]();const _0xd3b0a0=state[_0x2184a1(0x2c1)][_0x2184a1(0x1e9)](_0x1e0ecb=>_0x1e0ecb[_0x2184a1(0x264)]&&_0x1e0ecb[_0x2184a1(0x264)]!=='')[_0x2184a1(0x29b)];window[_0x2184a1(0x2a1)]=new Chart(_0x2c9f95,{'type':'doughnut','data':{'labels':[_0x2184a1(0x262),'ยังไม่ลงทะเบียน'],'datasets':[{'data':[_0xd3b0a0,Math[_0x2184a1(0x21c)](0x0,state['users'][_0x2184a1(0x29b)]-_0xd3b0a0)],'backgroundColor':[_0x2184a1(0x2bf),_0x2184a1(0x21a)]}]},'options':{'maintainAspectRatio':![]}});}const _0x41c515=document[_0x2184a1(0x280)](_0x2184a1(0x2d8));if(_0x41c515){if(window[_0x2184a1(0x2fc)])window['regLine'][_0x2184a1(0x1d9)]();window[_0x2184a1(0x2fc)]=new Chart(_0x41c515,{'type':_0x2184a1(0x226),'data':{'labels':Array[_0x2184a1(0x2ce)]({'length':0x18},(_0x4f4b22,_0x232549)=>_0x232549+':00'),'datasets':[{'label':_0x2184a1(0x305),'data':state[_0x2184a1(0x1e3)],'borderColor':_0x2184a1(0x1c3),'fill':!![],'tension':0.4}]},'options':{'maintainAspectRatio':![]}});}window[_0x2184a1(0x307)][_0x2184a1(0x304)]();},'renderManualHistory':()=>{const _0x255e28=_0x27412c,_0xc51a5d=document[_0x255e28(0x280)](_0x255e28(0x273)),_0x540699=state[_0x255e28(0x2c1)]['filter'](_0x267d91=>_0x267d91[_0x255e28(0x264)]&&_0x267d91[_0x255e28(0x264)]!=='')[_0x255e28(0x30f)]((_0xe6e57,_0x4acef9)=>{const _0x393dff=_0x255e28,_0xa3dc16=_0xe6e57[_0x393dff(0x264)]?.['toDate']?_0xe6e57[_0x393dff(0x264)][_0x393dff(0x1c1)]():new Date(_0xe6e57[_0x393dff(0x264)]),_0x375ea1=_0x4acef9[_0x393dff(0x264)]?.[_0x393dff(0x1c1)]?_0x4acef9['DateCheck']['toDate']():new Date(_0x4acef9[_0x393dff(0x264)]);return _0x375ea1-_0xa3dc16;})[_0x255e28(0x2bb)](0x0,0xa);_0xc51a5d&&(_0xc51a5d[_0x255e28(0x2a4)]=_0x540699[_0x255e28(0x29b)]?_0x540699['map'](_0x217e6a=>_0x255e28(0x2bc)+(_0x217e6a[_0x255e28(0x225)]||_0x255e28(0x297))+_0x255e28(0x288)+(_0x217e6a[_0x255e28(0x203)]||'-')+_0x255e28(0x2ca)+formatDate(_0x217e6a[_0x255e28(0x264)])+_0x255e28(0x27a))[_0x255e28(0x24a)](''):'<div\x20class=\x22text-center\x20text-slate-300\x20py-8\x20text-base\x20font-medium\x22>ไม่มีกิจกรรม</div>');},'resetMemberData':async _0x3e5f93=>{const _0x2eb4b0=_0x27412c;if(!confirm(_0x2eb4b0(0x2f1)))return;try{await updateDoc(doc(db,finalCollectionPath,_0x3e5f93),{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':'','AgreeDate':'','Agreement':''}),window['app'][_0x2eb4b0(0x23c)]('สำเร็จ');}catch(_0x533b15){window[_0x2eb4b0(0x307)][_0x2eb4b0(0x23c)](_0x2eb4b0(0x20c),'error');}},'resetLabelRecord':async _0x97a0ea=>{const _0x599628=_0x27412c;if(!confirm(_0x599628(0x1ee)))return;try{await updateDoc(doc(db,cardCollectionPath,_0x97a0ea),{'EmpName':'','Datetime':'','citizenId':''}),window[_0x599628(0x307)][_0x599628(0x23c)](_0x599628(0x259));}catch(_0x5c677a){window[_0x599628(0x307)]['showToast'](_0x599628(0x20c),'error');}},'openEditRewardModal':(_0x1b72a0,_0x56aeaa)=>{const _0x21b117=_0x27412c;document[_0x21b117(0x280)]('edit-reward-input')[_0x21b117(0x253)]=_0x56aeaa,document[_0x21b117(0x280)]('edit-reward-confirm-btn')[_0x21b117(0x293)]=async()=>{const _0xaf76b=_0x21b117,_0x360c5d=document[_0xaf76b(0x280)](_0xaf76b(0x23f))[_0xaf76b(0x253)][_0xaf76b(0x26a)]();try{await updateDoc(doc(db,cardCollectionPath,_0x1b72a0),{'rewardname':_0x360c5d}),window[_0xaf76b(0x307)][_0xaf76b(0x23c)](_0xaf76b(0x216)),window[_0xaf76b(0x307)]['closeEditRewardModal']();}catch(_0x5d0f08){window[_0xaf76b(0x307)][_0xaf76b(0x23c)](_0xaf76b(0x20c),'error');}},document[_0x21b117(0x280)](_0x21b117(0x1ef))[_0x21b117(0x2d1)][_0x21b117(0x1a1)](_0x21b117(0x2d7));},'showLabelModal':(_0x2c2816,_0x36db58,_0x58dec6,_0xa9f4db,_0x24a79a)=>{const _0x4008ab=_0x27412c,_0x305724=document['getElementById']('label-confirm-modal'),_0x3fcfe6=document[_0x4008ab(0x280)](_0x4008ab(0x283));document[_0x4008ab(0x280)](_0x4008ab(0x2b7))[_0x4008ab(0x1f5)]=_0x36db58,document[_0x4008ab(0x280)](_0x4008ab(0x1c9))[_0x4008ab(0x1f5)]=_0x58dec6;const _0x59c249=document['getElementById'](_0x4008ab(0x2ab));_0x59c249[_0x4008ab(0x2bd)]=_0x4008ab(0x282)+_0xa9f4db+_0x4008ab(0x306)+_0xa9f4db+_0x4008ab(0x23d),_0x59c249['innerHTML']=_0x4008ab(0x2d0)+(_0x2c2816===_0x4008ab(0x2a8)?_0x4008ab(0x1a3):'check-circle')+_0x4008ab(0x1e1),document[_0x4008ab(0x280)]('label-modal-input-container')[_0x4008ab(0x2d1)][_0x4008ab(0x1a1)](_0x4008ab(0x2d7));const _0x45aaf3=document[_0x4008ab(0x280)](_0x4008ab(0x2b0));_0x45aaf3[_0x4008ab(0x253)]='',_0x45aaf3[_0x4008ab(0x24b)]=_0x4008ab(0x281)+_0x2c2816+_0x4008ab(0x250),_0x3fcfe6[_0x4008ab(0x2bd)]=_0x4008ab(0x1d5)+(_0xa9f4db==='red'?_0x4008ab(0x201):_0xa9f4db==='orange'?_0x4008ab(0x2fe):_0x4008ab(0x2da))+'\x20text-white\x20font-bold\x20hover:opacity-90\x20transition\x20font-bold',_0x3fcfe6[_0x4008ab(0x1f5)]='ยืนยัน',_0x3fcfe6[_0x4008ab(0x293)]=async()=>{const _0x386c07=_0x4008ab;if(_0x45aaf3['value']!==_0x2c2816)return window['app'][_0x386c07(0x23c)](_0x386c07(0x20b),_0x386c07(0x1da));_0x3fcfe6['disabled']=!![],_0x3fcfe6[_0x386c07(0x1f5)]=_0x386c07(0x221);try{await _0x24a79a(),window['app'][_0x386c07(0x1a8)]();}finally{_0x3fcfe6['disabled']=![],_0x3fcfe6['innerText']=_0x386c07(0x1ba);}},_0x305724[_0x4008ab(0x2d1)]['remove'](_0x4008ab(0x2d7)),lucide[_0x4008ab(0x242)]();},'closeLabelModal':()=>document[_0x27412c(0x280)](_0x27412c(0x2af))[_0x27412c(0x2d1)]['add']('hidden'),'closeEditRewardModal':()=>document[_0x27412c(0x280)](_0x27412c(0x1ef))[_0x27412c(0x2d1)][_0x27412c(0x30b)](_0x27412c(0x2d7)),'closeGeneralModal':()=>document[_0x27412c(0x280)](_0x27412c(0x1aa))[_0x27412c(0x2d1)][_0x27412c(0x30b)]('hidden'),'onLabelGroupChange':_0x2cca9d=>{const _0x21096a=_0x27412c;state[_0x21096a(0x1eb)]=normalizeReward(_0x2cca9d),state[_0x21096a(0x1ea)]=0x1,window[_0x21096a(0x307)][_0x21096a(0x21b)]();},'onDataRewardFilterChange':_0x189d0c=>{const _0x512a08=_0x27412c;state[_0x512a08(0x2d4)]=_0x189d0c,state[_0x512a08(0x2ec)]=0x1,window[_0x512a08(0x307)][_0x512a08(0x2ac)]();},'handleSearch':_0xb75f76=>{const _0x261ce1=_0x27412c;state[_0x261ce1(0x1c6)]=_0xb75f76[_0x261ce1(0x1dd)](),state[_0x261ce1(0x2ec)]=0x1,window[_0x261ce1(0x307)]['renderTable']();},'changeRowsLimit':_0x2772ff=>{const _0x26f261=_0x27412c;state[_0x26f261(0x1c8)]=parseInt(_0x2772ff),state['currentPage']=0x1,window[_0x26f261(0x307)]['renderTable']();},'changePage':_0x35a20e=>{const _0xe1289a=_0x27412c;state[_0xe1289a(0x2ec)]+=_0x35a20e,window['app'][_0xe1289a(0x2ac)]();},'changeSort':_0x41901b=>{const _0x37a9be=_0x27412c;state[_0x37a9be(0x234)]=state['sortBy']===_0x41901b?state['sortOrder']===_0x37a9be(0x25c)?_0x37a9be(0x285):_0x37a9be(0x25c):_0x41901b==='no'?_0x37a9be(0x25c):_0x37a9be(0x285),state[_0x37a9be(0x1b6)]=_0x41901b,window[_0x37a9be(0x307)][_0x37a9be(0x2ac)]();},'changeLogPage':_0x13be93=>{const _0x545081=_0x27412c;state[_0x545081(0x2f0)]+=_0x13be93,window['app'][_0x545081(0x267)]();},'changeLogSort':_0x38a5df=>{const _0x16d827=_0x27412c;state[_0x16d827(0x2e4)]=state[_0x16d827(0x2c9)]===_0x38a5df?state[_0x16d827(0x2e4)]==='asc'?_0x16d827(0x285):_0x16d827(0x25c):'desc',state['logSortKey']=_0x38a5df,window[_0x16d827(0x307)][_0x16d827(0x267)]();}};async function init(){const _0x10f9e4=_0x27412c;try{if(typeof __initial_auth_token!==_0x10f9e4(0x208)&&__initial_auth_token)await signInWithCustomToken(auth,__initial_auth_token);else await signInAnonymously(auth);document[_0x10f9e4(0x280)](_0x10f9e4(0x1f7))?.['classList'][_0x10f9e4(0x21d)](_0x10f9e4(0x1b1),'bg-green-500');if(document[_0x10f9e4(0x280)](_0x10f9e4(0x247)))document[_0x10f9e4(0x280)](_0x10f9e4(0x247))[_0x10f9e4(0x1f5)]='Online';onSnapshot(collection(db,finalCollectionPath),_0xd4ccd9=>{const _0x273204=_0x10f9e4;state[_0x273204(0x2c1)]=_0xd4ccd9[_0x273204(0x2b2)]['map'](_0x50e025=>({'id':_0x50e025['id'],..._0x50e025['data']()})),document[_0x273204(0x280)](_0x273204(0x2fb))['innerText']=_0xd4ccd9['size'][_0x273204(0x248)](),document[_0x273204(0x280)](_0x273204(0x2be))[_0x273204(0x1f5)]=_0xd4ccd9['size']['toLocaleString']();const _0x5dc9dd=state[_0x273204(0x2c1)][_0x273204(0x1e9)](_0x42f0af=>_0x42f0af[_0x273204(0x264)]&&_0x42f0af[_0x273204(0x264)]!=='')[_0x273204(0x29b)];document[_0x273204(0x280)](_0x273204(0x29f))['innerText']=_0x5dc9dd['toLocaleString'](),document[_0x273204(0x280)](_0x273204(0x2f9))[_0x273204(0x1f5)]=_0xd4ccd9[_0x273204(0x294)]>0x0?(_0x5dc9dd/_0xd4ccd9['size']*0x64)[_0x273204(0x27e)](0x1)+'%':'0%';const _0x280332=Array(0x18)['fill'](0x0);state[_0x273204(0x2c1)][_0x273204(0x1c0)](_0x415d2c=>{const _0x2be00d=_0x273204;if(_0x415d2c[_0x2be00d(0x264)])try{let _0x367059=_0x415d2c[_0x2be00d(0x264)]['toDate']?_0x415d2c[_0x2be00d(0x264)][_0x2be00d(0x1c1)]():new Date(_0x415d2c[_0x2be00d(0x264)]);if(!isNaN(_0x367059[_0x2be00d(0x22e)]()))_0x280332[_0x367059[_0x2be00d(0x2f3)]()]++;}catch(_0x2cb65c){}}),state['hourlyData']=_0x280332;const _0x3087c4=[...new Set(state[_0x273204(0x2c1)][_0x273204(0x1db)](_0x3db6c6=>String(_0x3db6c6[_0x273204(0x203)]||'')[_0x273204(0x26a)]())['filter'](_0x5ba2d9=>_0x5ba2d9!==''))]['sort']((_0x5a7127,_0xfa4b2c)=>_0x5a7127['localeCompare'](_0xfa4b2c)),_0x502a5f=document['getElementById'](_0x273204(0x277));if(_0x502a5f){const _0x220d60=_0x502a5f['value'];_0x502a5f[_0x273204(0x2a4)]=_0x273204(0x2e2)+_0x3087c4[_0x273204(0x1db)](_0x499045=>_0x273204(0x25a)+_0x499045+'\x22>'+_0x499045+_0x273204(0x260))['join'](''),_0x502a5f[_0x273204(0x253)]=_0x3087c4[_0x273204(0x30a)](_0x220d60)?_0x220d60:'';}window[_0x273204(0x307)]['renderTable'](),window['app']['renderDataSummary'](),window[_0x273204(0x307)][_0x273204(0x1bd)](),window['app'][_0x273204(0x1e7)]();}),onSnapshot(collection(db,cardCollectionPath),_0x4002f3=>{const _0x2c5dcb=_0x10f9e4;state[_0x2c5dcb(0x20e)]=_0x4002f3['docs'][_0x2c5dcb(0x1db)](_0x3633f4=>({'id':_0x3633f4['id'],..._0x3633f4[_0x2c5dcb(0x265)]()}));const _0x4daaf8=[_0x2c5dcb(0x28f),_0x2c5dcb(0x211),_0x2c5dcb(0x1c7),_0x2c5dcb(0x1b8)],_0x1ffde4={};_0x4daaf8[_0x2c5dcb(0x1c0)](_0x46442a=>_0x1ffde4[_0x46442a]={'total':0x0,'used':0x0}),state[_0x2c5dcb(0x20e)][_0x2c5dcb(0x1c0)](_0x177ddd=>{const _0x4f4caa=_0x2c5dcb,_0x4dfc09=normalizeReward(_0x177ddd[_0x4f4caa(0x203)]);if(_0x1ffde4[_0x4f4caa(0x298)](_0x4dfc09)){_0x1ffde4[_0x4dfc09]['total']++;if(_0x177ddd['Datetime']&&_0x177ddd[_0x4f4caa(0x1fe)]!=='')_0x1ffde4[_0x4dfc09]['used']++;}}),_0x4daaf8[_0x2c5dcb(0x1c0)](_0x373fb3=>{const _0x1e05aa=_0x2c5dcb,_0x34bac5=_0x1ffde4[_0x373fb3],_0x511559=_0x34bac5[_0x1e05aa(0x223)]>0x0?Math[_0x1e05aa(0x1d0)](_0x34bac5['used']/_0x34bac5[_0x1e05aa(0x223)]*0x64):0x0;if(document[_0x1e05aa(0x280)](_0x1e05aa(0x1a4)+_0x373fb3))document[_0x1e05aa(0x280)](_0x1e05aa(0x1a4)+_0x373fb3)[_0x1e05aa(0x2a4)]=_0x34bac5[_0x1e05aa(0x223)][_0x1e05aa(0x248)]()+'\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>สลาก</span>';if(document['getElementById']('card-used-'+_0x373fb3))document[_0x1e05aa(0x280)](_0x1e05aa(0x279)+_0x373fb3)[_0x1e05aa(0x1f5)]=_0x34bac5[_0x1e05aa(0x1a9)][_0x1e05aa(0x248)]();if(document[_0x1e05aa(0x280)]('card-percent-'+_0x373fb3))document[_0x1e05aa(0x280)](_0x1e05aa(0x292)+_0x373fb3)[_0x1e05aa(0x1f5)]=_0x511559+'%';if(document[_0x1e05aa(0x280)](_0x1e05aa(0x1f6)+_0x373fb3))document[_0x1e05aa(0x280)](_0x1e05aa(0x1f6)+_0x373fb3)['style'][_0x1e05aa(0x235)]=_0x511559+'%';});const _0x477f9c=[...new Set(state[_0x2c5dcb(0x20e)][_0x2c5dcb(0x1db)](_0xceda8f=>normalizeReward(_0xceda8f[_0x2c5dcb(0x203)])))]['filter'](_0x41224d=>_0x41224d!=='')[_0x2c5dcb(0x30f)]((_0x102c2e,_0x3e74ae)=>_0x102c2e['localeCompare'](_0x3e74ae,undefined,{'numeric':!![]})),_0x489ee6=document[_0x2c5dcb(0x280)]('label-group-select');if(_0x489ee6){const _0x1c4d7e=_0x489ee6[_0x2c5dcb(0x253)];_0x489ee6[_0x2c5dcb(0x2a4)]=_0x2c5dcb(0x22b)+_0x477f9c[_0x2c5dcb(0x1db)](_0x5c1c95=>_0x2c5dcb(0x25a)+_0x5c1c95+'\x22>'+_0x5c1c95+_0x2c5dcb(0x260))[_0x2c5dcb(0x24a)](''),_0x489ee6[_0x2c5dcb(0x253)]=_0x1c4d7e||'';}window[_0x2c5dcb(0x307)][_0x2c5dcb(0x21b)](),window[_0x2c5dcb(0x307)][_0x2c5dcb(0x1bd)]();}),onSnapshot(collection(db,logCollectionPath),_0x4ccc3f=>{const _0x54209f=_0x10f9e4;state[_0x54209f(0x20d)]=_0x4ccc3f[_0x54209f(0x2b2)][_0x54209f(0x1db)](_0x4b8b01=>({'id':_0x4b8b01['id'],..._0x4b8b01[_0x54209f(0x265)]()}));if(state['activeTab']==='logs')window['app'][_0x54209f(0x267)]();}),window[_0x10f9e4(0x307)][_0x10f9e4(0x23a)](state['activeTab']);}catch(_0x5319ec){console['error'](_0x5319ec);}}setInterval(()=>{const _0x5ed462=_0x27412c;if(document['getElementById'](_0x5ed462(0x205)))document[_0x5ed462(0x280)]('current-time')[_0x5ed462(0x1f5)]=new Date()[_0x5ed462(0x2c3)](_0x5ed462(0x1d6));},0x3e8),init();
//const _0x45c2bc=_0x50b8;(function(_0x37f484,_0x9c3862){const _0x1a49c6=_0x50b8,_0xe278cd=_0x37f484();while(!![]){try{const _0x406bb0=parseInt(_0x1a49c6(0x1af))/0x1*(parseInt(_0x1a49c6(0x12b))/0x2)+parseInt(_0x1a49c6(0x1b6))/0x3+-parseInt(_0x1a49c6(0x1b1))/0x4*(parseInt(_0x1a49c6(0x164))/0x5)+parseInt(_0x1a49c6(0x137))/0x6*(parseInt(_0x1a49c6(0x129))/0x7)+-parseInt(_0x1a49c6(0xf4))/0x8*(-parseInt(_0x1a49c6(0x12a))/0x9)+-parseInt(_0x1a49c6(0x16c))/0xa*(-parseInt(_0x1a49c6(0xac))/0xb)+-parseInt(_0x1a49c6(0xec))/0xc;if(_0x406bb0===_0x9c3862)break;else _0xe278cd['push'](_0xe278cd['shift']());}catch(_0x46060b){_0xe278cd['push'](_0xe278cd['shift']());}}}(_0x4181,0xa36b4));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x45c2bc(0xf1),CARDS_COLLECTION_NAME=_0x45c2bc(0x1c0),LOGS_COLLECTION_NAME=_0x45c2bc(0x185),isSandboxEnv=typeof __firebase_config!==_0x45c2bc(0x133);let firebaseConfig,finalCollectionPath,cardCollectionPath,logCollectionPath;const appId=typeof __app_id!==_0x45c2bc(0x133)?__app_id:_0x45c2bc(0xd2);isSandboxEnv?(firebaseConfig=JSON['parse'](__firebase_config),finalCollectionPath='artifacts/'+appId+_0x45c2bc(0x17b)+TARGET_COLLECTION_NAME,cardCollectionPath=_0x45c2bc(0xb7)+appId+_0x45c2bc(0x17b)+CARDS_COLLECTION_NAME,logCollectionPath=_0x45c2bc(0xb7)+appId+_0x45c2bc(0x17b)+LOGS_COLLECTION_NAME):(firebaseConfig={'apiKey':_0x45c2bc(0x8b),'authDomain':'ttb-register.firebaseapp.com','projectId':_0x45c2bc(0x154),'storageBucket':_0x45c2bc(0x189),'messagingSenderId':_0x45c2bc(0x147),'appId':_0x45c2bc(0xd3)},finalCollectionPath=TARGET_COLLECTION_NAME,cardCollectionPath=CARDS_COLLECTION_NAME,logCollectionPath=LOGS_COLLECTION_NAME);const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'cards':[],'logs':[],'activeTab':_0x45c2bc(0xd6),'searchTerm':'','rowsPerPage':0x32,'currentPage':0x1,'sortBy':'no','sortOrder':_0x45c2bc(0x10c),'hourlyData':Array(0x18)['fill'](0x0),'selectedLabelGroup':'','labelPage':0x1,'labelRowsPerPage':0x32,'labelSortKey':_0x45c2bc(0x1db),'labelSortOrder':_0x45c2bc(0x10c),'logPage':0x1,'logRowsPerPage':0x32,'logSortKey':_0x45c2bc(0x1dc),'logSortOrder':_0x45c2bc(0x1d7),'selectedDataReward':''},formatDate=_0x53abf0=>{const _0x4d04af=_0x45c2bc;if(!_0x53abf0)return'-';try{if(_0x53abf0[_0x4d04af(0xd0)]){const _0x448bf5=_0x53abf0[_0x4d04af(0xd0)]();return _0x448bf5[_0x4d04af(0x186)](_0x4d04af(0x139))+'\x20'+_0x448bf5[_0x4d04af(0x194)]('th-TH');}const _0x3b2432=new Date(_0x53abf0);if(!isNaN(_0x3b2432[_0x4d04af(0x116)]()))return _0x3b2432[_0x4d04af(0x186)]('th-TH')+'\x20'+_0x3b2432[_0x4d04af(0x194)]('th-TH');}catch(_0x56a014){}return _0x53abf0;},normalizeReward=_0x24c27b=>String(_0x24c27b||'')[_0x45c2bc(0x173)](/,/g,'')[_0x45c2bc(0xf7)]();async function sha256(_0x31fbf0){const _0x289434=_0x45c2bc,_0x3d8de7=new TextEncoder()['encode'](_0x31fbf0),_0x16a1de=await crypto['subtle']['digest'](_0x289434(0xa2),_0x3d8de7);return Array['from'](new Uint8Array(_0x16a1de))[_0x289434(0xcd)](_0x551ac6=>_0x551ac6[_0x289434(0x1bd)](0x10)[_0x289434(0x144)](0x2,'0'))[_0x289434(0xc6)]('');}function _0x50b8(_0x2a1bff,_0x231dd7){_0x2a1bff=_0x2a1bff-0x7f;const _0x418139=_0x4181();let _0x50b8d8=_0x418139[_0x2a1bff];return _0x50b8d8;}function chunkArray(_0x2a2fec,_0x1751f8){const _0x53f8b9=_0x45c2bc,_0x56f9c5=[];for(let _0x74ae6f=0x0;_0x74ae6f<_0x2a2fec['length'];_0x74ae6f+=_0x1751f8)_0x56f9c5[_0x53f8b9(0xbb)](_0x2a2fec[_0x53f8b9(0x1cc)](_0x74ae6f,_0x74ae6f+_0x1751f8));return _0x56f9c5;}function csvToJson(_0x12f239){const _0x3a5c26=_0x45c2bc,_0x407017=_0x12f239[_0x3a5c26(0x16e)]('\x0a');if(_0x407017[_0x3a5c26(0x184)]===0x0)return[];const _0x20ea44=_0x407017[0x0][_0x3a5c26(0x16e)](',')[_0x3a5c26(0xcd)](_0x31b068=>_0x31b068[_0x3a5c26(0xf7)]());return _0x407017[_0x3a5c26(0x1cc)](0x1)[_0x3a5c26(0xcd)](_0x1c6df0=>{const _0x2864be=_0x3a5c26,_0xa25c63=_0x1c6df0[_0x2864be(0x16e)](',');if(_0xa25c63[_0x2864be(0x184)]<_0x20ea44['length'])return null;return _0x20ea44[_0x2864be(0x84)]((_0x27241f,_0x3be1a7,_0x2d909c)=>{const _0x118ac4=_0x2864be;return _0x27241f[_0x3be1a7]=_0xa25c63[_0x2d909c]?_0xa25c63[_0x2d909c][_0x118ac4(0xf7)]():'',_0x27241f;},{});})['filter'](_0x9e2a6d=>_0x9e2a6d);}window[_0x45c2bc(0xc9)]={'showToast':(_0x596063,_0x95642d='success')=>{const _0x4eea38=_0x45c2bc,_0x3ac639=document[_0x4eea38(0xf9)](_0x4eea38(0x18d));if(!_0x3ac639)return;const _0x3d8f66=document['createElement'](_0x4eea38(0xae));_0x3d8f66['className']=_0x4eea38(0x174)+(_0x95642d===_0x4eea38(0x160)?'border-green-500':'border-red-500')+'\x20p-4\x20rounded-xl\x20shadow-lg\x20toast-enter\x20pointer-events-auto',_0x3d8f66['innerHTML']=_0x4eea38(0x1c9)+_0x596063+_0x4eea38(0x95),_0x3ac639[_0x4eea38(0x170)](_0x3d8f66),setTimeout(()=>{const _0x38508e=_0x4eea38;_0x3d8f66['classList'][_0x38508e(0x11c)](_0x38508e(0x103)),setTimeout(()=>_0x3d8f66['remove'](),0x12c);},0xbb8);},'switchTab':_0xe41e56=>{const _0x1589b7=_0x45c2bc;document[_0x1589b7(0xd5)](_0x1589b7(0x195))[_0x1589b7(0x127)](_0x1fc47c=>_0x1fc47c['classList'][_0x1589b7(0x11c)](_0x1589b7(0x14d)));const _0x5037e2=document[_0x1589b7(0xf9)]('view-'+_0xe41e56);if(_0x5037e2)_0x5037e2[_0x1589b7(0x1da)][_0x1589b7(0x93)](_0x1589b7(0x14d));document['querySelectorAll']('.nav-item')[_0x1589b7(0x127)](_0x5abb32=>_0x5abb32[_0x1589b7(0x1da)][_0x1589b7(0x93)](_0x1589b7(0x12f),_0x1589b7(0x1a6)));const _0x11aef4=document[_0x1589b7(0xf9)]('nav-'+_0xe41e56);if(_0x11aef4)_0x11aef4['classList'][_0x1589b7(0x11c)]('bg-slate-700',_0x1589b7(0x1a6));state[_0x1589b7(0x13f)]=_0xe41e56;const _0x2dc095={'dashboard':_0x1589b7(0xcf),'data':_0x1589b7(0x11d),'winners':'รางวัลโชคชั้นที่\x202','import':_0x1589b7(0x9f),'labels':_0x1589b7(0x167),'qrcode-in':'QR\x20Code\x20ฮั่งเปา','logs':_0x1589b7(0x1d5)};document[_0x1589b7(0xf9)]('page-title')[_0x1589b7(0x85)]=_0x2dc095[_0xe41e56]||_0xe41e56;if(_0xe41e56==='labels')window[_0x1589b7(0xc9)]['renderLabelTable']();_0xe41e56===_0x1589b7(0xfd)&&(window[_0x1589b7(0xc9)][_0x1589b7(0x141)](),window[_0x1589b7(0xc9)][_0x1589b7(0x114)]());if(_0xe41e56===_0x1589b7(0xa5))window[_0x1589b7(0xc9)]['renderWinnersView']();if(_0xe41e56==='dashboard')window['app'][_0x1589b7(0x140)]();if(_0xe41e56===_0x1589b7(0xce))window[_0x1589b7(0xc9)][_0x1589b7(0xbc)]();lucide[_0x1589b7(0x18a)]();},'renderDataSummary':()=>{const _0x254f60=_0x45c2bc,_0x3358cd=document[_0x254f60(0xf9)](_0x254f60(0x111));if(!_0x3358cd||state['activeTab']!==_0x254f60(0xfd))return;const _0x3c3ddd=state[_0x254f60(0x1cd)][_0x254f60(0x1d4)](_0x3e75a8=>_0x3e75a8['DateCheck']&&_0x3e75a8[_0x254f60(0x12d)]!=='')['length'],_0x3dcff1=[],_0x5414cc=[{'bg':'bg-blue-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':'bg-indigo-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':'bg-emerald-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':_0x254f60(0x1a9),'bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':_0x254f60(0x188),'bar':'bg-white/30','text':_0x254f60(0x1a6)}];_0x3dcff1[_0x254f60(0xbb)]({'type':_0x254f60(0x91),'label':_0x254f60(0x151),'total':state[_0x254f60(0x1cd)]['length'],'registered':_0x3c3ddd,'percent':state[_0x254f60(0x1cd)][_0x254f60(0x184)]>0x0?Math[_0x254f60(0x1e0)](_0x3c3ddd/state[_0x254f60(0x1cd)][_0x254f60(0x184)]*0x64):0x0});const _0x3b4a40=[_0x254f60(0x17f),_0x254f60(0x1e1),_0x254f60(0xaf),_0x254f60(0x14f)];_0x3b4a40[_0x254f60(0x127)](_0x40ff14=>{const _0x350698=_0x254f60,_0x1ce9e5=state[_0x350698(0x1cd)][_0x350698(0x1d4)](_0x1bd1d4=>normalizeReward(_0x1bd1d4['Reward'])===_0x40ff14),_0x37f0e7=_0x1ce9e5[_0x350698(0x1d4)](_0x1451cd=>_0x1451cd[_0x350698(0x12d)]&&_0x1451cd[_0x350698(0x12d)]!=='')[_0x350698(0x184)];_0x3dcff1[_0x350698(0xbb)]({'type':_0x350698(0x193),'label':_0x40ff14,'total':_0x1ce9e5['length'],'registered':_0x37f0e7,'percent':_0x1ce9e5[_0x350698(0x184)]>0x0?Math['round'](_0x37f0e7/_0x1ce9e5['length']*0x64):0x0});}),_0x3358cd[_0x254f60(0x126)]=_0x3dcff1[_0x254f60(0xcd)]((_0xf1f13b,_0x4b5172)=>{const _0x4ff327=_0x254f60,_0x4d72a1=_0x5414cc[_0x4b5172%_0x5414cc['length']];return _0x4ff327(0x128)+_0x4d72a1['bg']+_0x4ff327(0x1b7)+_0x4d72a1['text']+_0x4ff327(0x14c)+(_0xf1f13b[_0x4ff327(0xde)]===_0x4ff327(0x91)?_0xf1f13b[_0x4ff327(0x100)]:'กลุ่มรางวัล\x20'+_0xf1f13b[_0x4ff327(0x100)])+_0x4ff327(0x17d)+_0xf1f13b[_0x4ff327(0x91)][_0x4ff327(0x199)]()+_0x4ff327(0x8f)+_0xf1f13b[_0x4ff327(0x1d0)][_0x4ff327(0x199)]()+_0x4ff327(0xf6)+_0xf1f13b[_0x4ff327(0xfa)]+_0x4ff327(0x19e)+_0x4d72a1[_0x4ff327(0xf8)]+_0x4ff327(0x1ca)+_0xf1f13b[_0x4ff327(0xfa)]+'%\x22></div></div></div>';})[_0x254f60(0xc6)]('');},'renderWinnersView':()=>{const _0x47f4c1=_0x45c2bc,_0x4db8b1=document[_0x47f4c1(0xf9)](_0x47f4c1(0xf3));if(!_0x4db8b1||state[_0x47f4c1(0x13f)]!==_0x47f4c1(0xa5))return;const _0x28de35=['1000',_0x47f4c1(0x1e1),_0x47f4c1(0xaf),_0x47f4c1(0x14f)],_0x35bf8a={'1000':'rose','2000':'emerald','3000':'sky','4000':_0x47f4c1(0x1ad)};_0x4db8b1[_0x47f4c1(0x126)]=_0x28de35['map'](_0x9571a8=>{const _0x2480f2=_0x47f4c1,_0x1eba23=_0x35bf8a[_0x9571a8]||_0x2480f2(0x16d),_0x5e435a=state[_0x2480f2(0xd8)][_0x2480f2(0x1d4)](_0x18de39=>normalizeReward(_0x18de39[_0x2480f2(0x8c)])===_0x9571a8),_0x4edee1=state[_0x2480f2(0x1cd)][_0x2480f2(0x1d4)](_0xd98beb=>normalizeReward(_0xd98beb['Reward'])===_0x9571a8),_0x55248f=[...new Set(_0x5e435a[_0x2480f2(0xcd)](_0x17f267=>_0x17f267[_0x2480f2(0x1ac)])['filter'](_0x1fd0c2=>_0x1fd0c2&&_0x1fd0c2[_0x2480f2(0xf7)]()!==''))],_0x5b1312=_0x5e435a[_0x2480f2(0x1d4)](_0x15a07e=>_0x15a07e[_0x2480f2(0x1dc)]&&_0x15a07e[_0x2480f2(0x1dc)]!==''),_0x13bb16=_0x5b1312[_0x2480f2(0x1d4)](_0x1a1bb6=>_0x1a1bb6[_0x2480f2(0x1ac)]&&_0x1a1bb6[_0x2480f2(0x1ac)][_0x2480f2(0xf7)]()!==''),_0xeca3dc=_0x13bb16[_0x2480f2(0x184)]===0x0?_0x2480f2(0x132):_0x13bb16['map'](_0x277dac=>_0x2480f2(0x1b2)+(_0x277dac['EmpName']||_0x2480f2(0x1c6))+_0x2480f2(0xfb)+_0x1eba23+_0x2480f2(0xe4)+_0x277dac[_0x2480f2(0x1ac)]+_0x2480f2(0x1d1)+formatDate(_0x277dac[_0x2480f2(0x1dc)])+_0x2480f2(0xba))[_0x2480f2(0xc6)]('');return'<div\x20class=\x22bg-white\x20rounded-[2rem]\x20shadow-sm\x20border\x20border-slate-100\x20flex\x20flex-col\x20overflow-hidden\x20transition-all\x20hover:shadow-lg\x22><div\x20class=\x22bg-'+_0x1eba23+_0x2480f2(0xe5)+_0x9571a8+_0x2480f2(0x1ba)+_0x1eba23+'-50\x20p-3\x20border-b\x20text-center\x22><div\x20class=\x22text-sm\x20font-black\x20text-'+_0x1eba23+_0x2480f2(0x1c7)+(_0x55248f[_0x2480f2(0x184)]>0x0?_0x55248f[_0x2480f2(0xc6)](',\x20'):'(ไม่มีของรางวัล)')+_0x2480f2(0x187)+_0xeca3dc+_0x2480f2(0x119)+_0x5b1312[_0x2480f2(0x184)]+_0x2480f2(0xb9)+_0x5e435a[_0x2480f2(0x184)]+_0x2480f2(0x136)+_0x1eba23+_0x2480f2(0x1c1)+(_0x5e435a[_0x2480f2(0x184)]?_0x5b1312['length']/_0x5e435a[_0x2480f2(0x184)]*0x64:0x0)+_0x2480f2(0xf5)+_0x4edee1[_0x2480f2(0x184)]+_0x2480f2(0xea);})[_0x47f4c1(0xc6)]('');},'renderLabelTable':()=>{const _0x1f1f36=_0x45c2bc,_0x14ec0b=document[_0x1f1f36(0xf9)]('label-table-body'),_0x3ad008=document[_0x1f1f36(0xf9)]('label-table-info'),_0x96171e=document[_0x1f1f36(0xf9)](_0x1f1f36(0x169));if(!_0x14ec0b||state[_0x1f1f36(0x13f)]!=='labels')return;let _0x37a6f7=state['selectedLabelGroup']===''?[...state[_0x1f1f36(0xd8)]]:state[_0x1f1f36(0xd8)]['filter'](_0x3d9be0=>normalizeReward(_0x3d9be0[_0x1f1f36(0x8c)])===state[_0x1f1f36(0x105)]);_0x37a6f7[_0x1f1f36(0x161)]((_0x1bf8a7,_0x119c51)=>{const _0x5c63ee=_0x1f1f36;let _0x48417d=_0x1bf8a7[state[_0x5c63ee(0xff)]],_0x4c9755=_0x119c51[state['labelSortKey']];if(state['labelSortKey']===_0x5c63ee(0x1db)||state[_0x5c63ee(0xff)]===_0x5c63ee(0x8c)){const _0x17e60d=parseFloat(String(_0x48417d||'')[_0x5c63ee(0x173)](/,/g,''))||0x0,_0x5950dc=parseFloat(String(_0x4c9755||'')[_0x5c63ee(0x173)](/,/g,''))||0x0;return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?_0x17e60d-_0x5950dc:_0x5950dc-_0x17e60d;}if(state[_0x5c63ee(0xff)]==='Datetime'){const _0x1ee140=_0x48417d?.[_0x5c63ee(0xd0)]?_0x48417d[_0x5c63ee(0xd0)]()['getTime']():new Date(_0x48417d)['getTime']()||0x0,_0x42cad1=_0x4c9755?.['toDate']?_0x4c9755['toDate']()[_0x5c63ee(0x116)]():new Date(_0x4c9755)['getTime']()||0x0;return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?_0x1ee140-_0x42cad1:_0x42cad1-_0x1ee140;}return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?String(_0x48417d||'')[_0x5c63ee(0x1a3)](String(_0x4c9755||''),'th',{'numeric':!![]}):String(_0x4c9755||'')[_0x5c63ee(0x1a3)](String(_0x48417d||''),'th',{'numeric':!![]});});const _0x149789=_0x37a6f7[_0x1f1f36(0x184)],_0xb4f301=Math['ceil'](_0x149789/0x32)||0x1;if(state[_0x1f1f36(0x134)]>_0xb4f301)state[_0x1f1f36(0x134)]=_0xb4f301;const _0x4a3bdb=_0x37a6f7[_0x1f1f36(0x1cc)]((state[_0x1f1f36(0x134)]-0x1)*0x32,state[_0x1f1f36(0x134)]*0x32);if(_0x3ad008)_0x3ad008[_0x1f1f36(0x85)]=_0x1f1f36(0xd4)+((state[_0x1f1f36(0x134)]-0x1)*0x32+0x1)+_0x1f1f36(0x7f)+Math['min'](state[_0x1f1f36(0x134)]*0x32,_0x149789)+_0x1f1f36(0x1a5)+_0x149789;if(_0x96171e)_0x96171e[_0x1f1f36(0x126)]='<button\x20onclick=\x22window.app.changeLabelPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20'+(state[_0x1f1f36(0x134)]<=0x1?'disabled':'')+_0x1f1f36(0x1ce)+state['labelPage']+'/'+_0xb4f301+_0x1f1f36(0xe3)+(state[_0x1f1f36(0x134)]>=_0xb4f301?_0x1f1f36(0x15b):'')+'>Next</button>';_0x14ec0b[_0x1f1f36(0x126)]=_0x4a3bdb[_0x1f1f36(0xcd)](_0x106a6e=>{const _0x595268=_0x1f1f36,_0x51e40e=!!_0x106a6e[_0x595268(0x1dc)],_0x5d0124=(_0x106a6e['rewardname']||'')[_0x595268(0x173)](/'/g,'\x5c\x27');return _0x595268(0x9e)+(_0x106a6e[_0x595268(0x1db)]||'-')+'</td><td\x20class=\x22px-6\x22>'+(_0x106a6e[_0x595268(0x8c)]||'-')+_0x595268(0x197)+(_0x106a6e[_0x595268(0x1ac)]||'-')+'</td><td\x20class=\x22px-6\x20font-bold\x20text-slate-800\x20font-bold\x22>'+(_0x106a6e[_0x595268(0xee)]||'-')+_0x595268(0xb4)+formatDate(_0x106a6e[_0x595268(0x1dc)])+'</td><td\x20class=\x22px-6\x20text-right\x22><div\x20class=\x22flex\x20items-center\x20justify-end\x20gap-2\x22><button\x20onclick=\x22'+(!_0x51e40e?_0x595268(0xa0)+_0x106a6e['id']+_0x595268(0x172)+_0x5d0124+'\x27)':'')+'\x22\x20class=\x22text-indigo-600\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-indigo-200\x20rounded-lg\x20hover:bg-indigo-50\x20transition\x20'+(_0x51e40e?'opacity-20\x20cursor-not-allowed':'')+'\x22\x20'+(_0x51e40e?_0x595268(0x15b):'')+_0x595268(0x1c3)+(!!_0x106a6e[_0x595268(0x1dc)]?_0x595268(0xc0)+_0x106a6e['id']+'\x27)':'')+_0x595268(0x102)+(!_0x106a6e[_0x595268(0x1dc)]?'opacity-20\x20cursor-not-allowed':'hover:bg-red-50')+'\x20transition\x22\x20'+(!_0x106a6e['Datetime']?_0x595268(0x15b):'')+_0x595268(0xc1);})['join'](''),lucide['createIcons']();},'exportDataToCSV':()=>{const _0x59c547=_0x45c2bc;let _0x18fd06=state[_0x59c547(0x1cd)][_0x59c547(0x1d4)](_0x1e74f2=>(_0x1e74f2[_0x59c547(0xee)]||'')[_0x59c547(0x1a8)]()[_0x59c547(0x165)](state['searchTerm'])&&(state[_0x59c547(0x15d)]===''||String(_0x1e74f2[_0x59c547(0x8c)])===String(state[_0x59c547(0x15d)])));if(_0x18fd06[_0x59c547(0x184)]===0x0)return window[_0x59c547(0xc9)]['showToast']('ไม่มีข้อมูลสำหรับดาวน์โหลด',_0x59c547(0x179));_0x18fd06[_0x59c547(0x161)]((_0x23d5e1,_0x19513c)=>(parseFloat(_0x23d5e1['no'])||0x0)-(parseFloat(_0x19513c['no'])||0x0));const _0x21bfe1=[_0x59c547(0x1bc),'ชื่อ-นามสกุล',_0x59c547(0x107),'Login\x20(DateCheck)',_0x59c547(0xc5),_0x59c547(0x131),_0x59c547(0xd9)],_0x422143=_0x18fd06[_0x59c547(0xcd)](_0x3220c0=>[_0x3220c0['no']||'',_0x3220c0[_0x59c547(0xee)]||'',_0x3220c0[_0x59c547(0x8c)]||'',formatDate(_0x3220c0['DateCheck']),formatDate(_0x3220c0[_0x59c547(0x8d)]),formatDate(_0x3220c0['DateReward']),_0x3220c0['StatusReward']||'']),_0x13b155='\ufeff'+[_0x21bfe1,..._0x422143]['map'](_0xc10b83=>_0xc10b83[_0x59c547(0xcd)](_0x340230=>'\x22'+_0x340230+'\x22')[_0x59c547(0xc6)](','))[_0x59c547(0xc6)]('\x0a'),_0x37c49a=new Blob([_0x13b155],{'type':'text/csv;charset=utf-8;'}),_0x11b9ad=document[_0x59c547(0xe0)]('a'),_0x507070=URL[_0x59c547(0x157)](_0x37c49a);_0x11b9ad[_0x59c547(0x118)](_0x59c547(0x10f),_0x507070),_0x11b9ad['setAttribute'](_0x59c547(0x18e),'registration_data_'+new Date()[_0x59c547(0x116)]()+_0x59c547(0x192)),_0x11b9ad[_0x59c547(0x196)]['visibility']=_0x59c547(0x14d),document[_0x59c547(0x1b0)][_0x59c547(0x170)](_0x11b9ad),_0x11b9ad[_0x59c547(0x90)](),document[_0x59c547(0x1b0)][_0x59c547(0x10a)](_0x11b9ad);},'exportLabelsToCSV':()=>{const _0x37d3ee=_0x45c2bc;let _0xc1f516=state[_0x37d3ee(0x105)]===''?[...state[_0x37d3ee(0xd8)]]:state['cards'][_0x37d3ee(0x1d4)](_0x386670=>normalizeReward(_0x386670[_0x37d3ee(0x8c)])===state['selectedLabelGroup']);if(_0xc1f516[_0x37d3ee(0x184)]===0x0)return window[_0x37d3ee(0xc9)]['showToast'](_0x37d3ee(0xdd),_0x37d3ee(0x179));_0xc1f516[_0x37d3ee(0x161)]((_0x5cea97,_0x3b7d68)=>(parseInt(_0x5cea97[_0x37d3ee(0x1db)])||0x0)-(parseInt(_0x3b7d68['CardNo'])||0x0));const _0xf857c6=['ลำดับที่','Reward\x20(กลุ่ม)',_0x37d3ee(0xdb),_0x37d3ee(0x198),_0x37d3ee(0x1dc)],_0x2456c4=_0xc1f516[_0x37d3ee(0xcd)](_0x30a5b6=>[_0x30a5b6[_0x37d3ee(0x1db)]||'',_0x30a5b6[_0x37d3ee(0x8c)]||'',_0x30a5b6['rewardname']||'',_0x30a5b6[_0x37d3ee(0xee)]||'',formatDate(_0x30a5b6[_0x37d3ee(0x1dc)])]),_0x3c9626='\ufeff'+[_0xf857c6,..._0x2456c4][_0x37d3ee(0xcd)](_0x2c9035=>_0x2c9035[_0x37d3ee(0xcd)](_0x3f0ef8=>'\x22'+_0x3f0ef8+'\x22')[_0x37d3ee(0xc6)](','))[_0x37d3ee(0xc6)]('\x0a'),_0x2b95f9=new Blob([_0x3c9626],{'type':_0x37d3ee(0x16f)}),_0x3a2815=document[_0x37d3ee(0xe0)]('a'),_0x8490ba=URL[_0x37d3ee(0x157)](_0x2b95f9);_0x3a2815[_0x37d3ee(0x118)](_0x37d3ee(0x10f),_0x8490ba),_0x3a2815[_0x37d3ee(0x118)](_0x37d3ee(0x18e),_0x37d3ee(0x1b4)+(state[_0x37d3ee(0x105)]||_0x37d3ee(0x15a))+'_'+new Date()[_0x37d3ee(0x116)]()+'.csv'),_0x3a2815[_0x37d3ee(0x196)][_0x37d3ee(0x112)]=_0x37d3ee(0x14d),document[_0x37d3ee(0x1b0)][_0x37d3ee(0x170)](_0x3a2815),_0x3a2815['click'](),document['body'][_0x37d3ee(0x10a)](_0x3a2815);},'renderLogTable':()=>{const _0x10b7cd=_0x45c2bc,_0x1e44f5=document[_0x10b7cd(0xf9)](_0x10b7cd(0x1a4)),_0xe4cf90=document[_0x10b7cd(0xf9)](_0x10b7cd(0x19d));if(!_0x1e44f5)return;let _0x7e5319=[...state['logs']];_0x7e5319[_0x10b7cd(0x161)]((_0x57d20b,_0x1cf1cb)=>{const _0x5247b8=_0x10b7cd;let _0x52fb21=_0x57d20b[state[_0x5247b8(0x9c)]],_0x1625b1=_0x1cf1cb[state[_0x5247b8(0x9c)]];state['logSortKey']===_0x5247b8(0x1dc)&&(_0x52fb21=_0x57d20b['Datetime']?.['toDate']?_0x57d20b['Datetime'][_0x5247b8(0xd0)]()[_0x5247b8(0x116)]():new Date(_0x57d20b['Datetime'])[_0x5247b8(0x116)](),_0x1625b1=_0x1cf1cb[_0x5247b8(0x1dc)]?.[_0x5247b8(0xd0)]?_0x1cf1cb[_0x5247b8(0x1dc)]['toDate']()[_0x5247b8(0x116)]():new Date(_0x1cf1cb[_0x5247b8(0x1dc)])[_0x5247b8(0x116)]());if(state['logSortKey']===_0x5247b8(0xa3))return state[_0x5247b8(0xf0)]===_0x5247b8(0x10c)?0x1:-0x1;return state[_0x5247b8(0xf0)]===_0x5247b8(0x10c)?String(_0x52fb21||'')['localeCompare'](String(_0x1625b1||''),'th'):String(_0x1625b1||'')[_0x5247b8(0x1a3)](String(_0x52fb21||''),'th');});const _0xed82af=_0x7e5319[_0x10b7cd(0x184)],_0x461ac3=Math[_0x10b7cd(0x120)](_0xed82af/0x32)||0x1;if(state[_0x10b7cd(0xdf)]>_0x461ac3)state['logPage']=_0x461ac3;const _0x5e6c6=_0x7e5319[_0x10b7cd(0x1cc)]((state[_0x10b7cd(0xdf)]-0x1)*0x32,state['logPage']*0x32);if(document[_0x10b7cd(0xf9)](_0x10b7cd(0x191)))document['getElementById']('log-total-count')[_0x10b7cd(0x85)]=_0xed82af['toLocaleString']();_0x1e44f5['innerHTML']=_0x5e6c6[_0x10b7cd(0xcd)]((_0x3a07ce,_0x74bb68)=>_0x10b7cd(0x88)+((state[_0x10b7cd(0xdf)]-0x1)*0x32+_0x74bb68+0x1)+_0x10b7cd(0xe7)+_0x3a07ce[_0x10b7cd(0x175)]+'\x22>'+(_0x3a07ce[_0x10b7cd(0x175)]||'-')+_0x10b7cd(0x1c5)+(_0x3a07ce['EmpName']||'-')+_0x10b7cd(0x1cb)+(_0x3a07ce[_0x10b7cd(0x1be)]||_0x10b7cd(0x135))+'</span></td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-400\x20font-normal\x20text-sm\x22>'+(_0x3a07ce[_0x10b7cd(0x166)]||'-')+_0x10b7cd(0x104)+formatDate(_0x3a07ce[_0x10b7cd(0x1dc)])+_0x10b7cd(0x9b))[_0x10b7cd(0xc6)]('');if(_0xe4cf90)_0xe4cf90['innerHTML']=_0x10b7cd(0x9d)+(state[_0x10b7cd(0xdf)]<=0x1?_0x10b7cd(0x15b):'')+'>Prev</button><span\x20class=\x22text-xs\x20font-bold\x20px-2\x22>Page\x20'+state[_0x10b7cd(0xdf)]+'/'+_0x461ac3+_0x10b7cd(0xad)+(state[_0x10b7cd(0xdf)]>=_0x461ac3?'disabled':'')+_0x10b7cd(0x183);lucide[_0x10b7cd(0x18a)]();},'openDeleteLogsModal':()=>{const _0x2c5108=_0x45c2bc;window[_0x2c5108(0xc9)][_0x2c5108(0x106)](_0x2c5108(0x158),_0x2c5108(0x16a),_0x2c5108(0x182),_0x2c5108(0x122),async()=>{const _0x2e3c54=_0x2c5108;try{const _0x54b2c0=await getDocs(collection(db,logCollectionPath)),_0x1beaa6=0x190,_0xc0dc16=chunkArray(_0x54b2c0[_0x2e3c54(0x13a)],_0x1beaa6);for(const _0x3e73d8 of _0xc0dc16){const _0x13849c=writeBatch(db);_0x3e73d8[_0x2e3c54(0x127)](_0x5fd3c4=>_0x13849c[_0x2e3c54(0x17e)](_0x5fd3c4[_0x2e3c54(0x1a0)])),await _0x13849c[_0x2e3c54(0x163)]();}window[_0x2e3c54(0xc9)][_0x2e3c54(0x83)](_0x2e3c54(0x9a));}catch(_0x5944ed){window[_0x2e3c54(0xc9)][_0x2e3c54(0x83)](_0x2e3c54(0xeb),_0x2e3c54(0x179));}});},'changeLogSort':_0x2c279e=>{const _0x14d5ea=_0x45c2bc;state[_0x14d5ea(0xf0)]=state['logSortKey']===_0x2c279e?state['logSortOrder']==='asc'?_0x14d5ea(0x1d7):'asc':_0x14d5ea(0x1d7),state[_0x14d5ea(0x9c)]=_0x2c279e,window['app'][_0x14d5ea(0xbc)]();},'exportLogsToCSV':()=>{const _0x1a7646=_0x45c2bc;if(state[_0x1a7646(0xce)]['length']===0x0)return window[_0x1a7646(0xc9)][_0x1a7646(0x83)](_0x1a7646(0xdd),'error');const _0x5c6b7d=['ลำดับที่',_0x1a7646(0x175),_0x1a7646(0xee),_0x1a7646(0x1be),_0x1a7646(0x166),_0x1a7646(0x1dc)],_0x257ee7=state[_0x1a7646(0xce)][_0x1a7646(0xcd)]((_0x48fd1f,_0x239cf2)=>[_0x239cf2+0x1,'\x09'+(_0x48fd1f[_0x1a7646(0x175)]||''),_0x48fd1f['EmpName']||'',_0x48fd1f[_0x1a7646(0x1be)]||_0x1a7646(0x135),_0x48fd1f[_0x1a7646(0x166)]||'',formatDate(_0x48fd1f[_0x1a7646(0x1dc)])]),_0x3dcae8='\ufeff'+[_0x5c6b7d,..._0x257ee7][_0x1a7646(0xcd)](_0x3c0e35=>_0x3c0e35[_0x1a7646(0xcd)](_0x4ef834=>'\x22'+_0x4ef834+'\x22')[_0x1a7646(0xc6)](','))[_0x1a7646(0xc6)]('\x0a'),_0xa199ee=new Blob([_0x3dcae8],{'type':'text/csv;charset=utf-8;'}),_0xdc85c2=document[_0x1a7646(0xe0)]('a'),_0x2c254e=URL[_0x1a7646(0x157)](_0xa199ee);_0xdc85c2[_0x1a7646(0x118)](_0x1a7646(0x10f),_0x2c254e),_0xdc85c2[_0x1a7646(0x118)](_0x1a7646(0x18e),_0x1a7646(0x138)+new Date()[_0x1a7646(0x116)]()+_0x1a7646(0x192)),_0xdc85c2[_0x1a7646(0x196)]['visibility']=_0x1a7646(0x14d),document[_0x1a7646(0x1b0)]['appendChild'](_0xdc85c2),_0xdc85c2['click'](),document[_0x1a7646(0x1b0)]['removeChild'](_0xdc85c2);},'onDataRewardFilterChange':_0x585798=>{const _0x47108f=_0x45c2bc;state[_0x47108f(0x15d)]=_0x585798,state['currentPage']=0x1,window[_0x47108f(0xc9)][_0x47108f(0x114)]();},'handleSearch':_0x25e5d0=>{const _0xa90904=_0x45c2bc;state[_0xa90904(0x1d6)]=_0x25e5d0[_0xa90904(0x1a8)](),state[_0xa90904(0x13d)]=0x1,window['app']['renderTable']();},'changeRowsLimit':_0x1745f2=>{const _0x505713=_0x45c2bc;state[_0x505713(0xa7)]=parseInt(_0x1745f2),state['currentPage']=0x1,window['app']['renderTable']();},'changePage':_0x134394=>{const _0x59b3b9=_0x45c2bc;state['currentPage']+=_0x134394,window[_0x59b3b9(0xc9)][_0x59b3b9(0x114)]();},'changeSort':_0x20c860=>{const _0x2dbc2f=_0x45c2bc;state[_0x2dbc2f(0x1b9)]=state['sortBy']===_0x20c860?state['sortOrder']==='asc'?_0x2dbc2f(0x1d7):'asc':_0x20c860==='no'?_0x2dbc2f(0x10c):_0x2dbc2f(0x1d7),state['sortBy']=_0x20c860,window[_0x2dbc2f(0xc9)][_0x2dbc2f(0x114)]();},'renderTable':()=>{const _0x3b6ef8=_0x45c2bc,_0x79ab9e=document[_0x3b6ef8(0xf9)]('table-body');if(!_0x79ab9e||state['activeTab']!==_0x3b6ef8(0xfd))return;let _0x43eb52=state[_0x3b6ef8(0x1cd)]['filter'](_0x2902a1=>(_0x2902a1[_0x3b6ef8(0xee)]||'')['toLowerCase']()[_0x3b6ef8(0x165)](state[_0x3b6ef8(0x1d6)])&&(state[_0x3b6ef8(0x15d)]===''||String(_0x2902a1['Reward'])===String(state[_0x3b6ef8(0x15d)])));_0x43eb52[_0x3b6ef8(0x161)]((_0x2e3858,_0xf1ff81)=>{const _0x438c64=_0x3b6ef8,_0x55a07e=_0x2e3858[state['sortBy']],_0x33fb33=_0xf1ff81[state[_0x438c64(0x82)]];if(state[_0x438c64(0x82)]==='no'||!isNaN(_0x55a07e)&&!isNaN(_0x33fb33)&&_0x55a07e!==''&&_0x33fb33!=='')return state[_0x438c64(0x1b9)]===_0x438c64(0x10c)?(parseFloat(_0x55a07e)||0x0)-(parseFloat(_0x33fb33)||0x0):(parseFloat(_0x33fb33)||0x0)-(parseFloat(_0x55a07e)||0x0);return state['sortOrder']===_0x438c64(0x10c)?String(_0x55a07e||'')[_0x438c64(0x1a3)](String(_0x33fb33||''),'th',{'numeric':!![]}):String(_0x33fb33||'')[_0x438c64(0x1a3)](String(_0x55a07e||''),'th',{'numeric':!![]});});const _0x3a5b25=_0x43eb52[_0x3b6ef8(0x1cc)]((state[_0x3b6ef8(0x13d)]-0x1)*state[_0x3b6ef8(0xa7)],state[_0x3b6ef8(0x13d)]*state[_0x3b6ef8(0xa7)]);_0x79ab9e[_0x3b6ef8(0x126)]=_0x3a5b25[_0x3b6ef8(0xcd)](_0x4320af=>_0x3b6ef8(0x180)+(_0x4320af['no']||'-')+_0x3b6ef8(0x15e)+(_0x4320af['EmpName']||'-')+'</td><td\x20class=\x22px-6\x20py-4\x20font-normal\x20font-bold\x22>'+(_0x4320af[_0x3b6ef8(0x8c)]||'-')+_0x3b6ef8(0xe1)+formatDate(_0x4320af['DateCheck'])+_0x3b6ef8(0x145)+formatDate(_0x4320af[_0x3b6ef8(0x8d)])+_0x3b6ef8(0x145)+formatDate(_0x4320af[_0x3b6ef8(0x1ae)])+_0x3b6ef8(0x168)+(_0x4320af[_0x3b6ef8(0x125)]||'-')+_0x3b6ef8(0x150)+_0x4320af['id']+_0x3b6ef8(0xe8))['join']('');if(document[_0x3b6ef8(0xf9)](_0x3b6ef8(0xca)))document['getElementById']('data-table-info')[_0x3b6ef8(0x85)]=_0x3b6ef8(0x19c)+_0x3a5b25[_0x3b6ef8(0x184)]+'\x20จาก\x20'+_0x43eb52['length']+'\x20รายการ';const _0x22d162=document[_0x3b6ef8(0xf9)](_0x3b6ef8(0x17a));if(_0x22d162)_0x22d162[_0x3b6ef8(0x126)]=_0x3b6ef8(0x109)+(state[_0x3b6ef8(0x13d)]<=0x1?_0x3b6ef8(0x15b):'')+_0x3b6ef8(0x15f)+state['currentPage']+'</span><button\x20onclick=\x22window.app.changePage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20'+(state[_0x3b6ef8(0x13d)]*state['rowsPerPage']>=_0x43eb52[_0x3b6ef8(0x184)]?_0x3b6ef8(0x15b):'')+_0x3b6ef8(0x13e);lucide['createIcons']();},'openResetModal':()=>{const _0x21edb5=_0x45c2bc;window[_0x21edb5(0xc9)][_0x21edb5(0x106)](_0x21edb5(0xef),'ยืนยัน\x20Reset\x20Register?',_0x21edb5(0x86),_0x21edb5(0x1aa),async()=>{const _0x5d2891=_0x21edb5;try{const _0x1fec05=await getDocs(collection(db,finalCollectionPath)),_0x1a55bb=writeBatch(db);_0x1fec05[_0x5d2891(0x13a)][_0x5d2891(0x127)](_0x34c7f9=>_0x1a55bb[_0x5d2891(0xa4)](_0x34c7f9['ref'],{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''})),await _0x1a55bb[_0x5d2891(0x163)](),window['app'][_0x5d2891(0x83)](_0x5d2891(0x18c));}catch(_0x1565de){window[_0x5d2891(0xc9)][_0x5d2891(0x83)](_0x5d2891(0xeb),_0x5d2891(0x179));}});},'openDeleteModal':()=>{const _0x3c7903=_0x45c2bc;window[_0x3c7903(0xc9)][_0x3c7903(0x106)]('Delete',_0x3c7903(0x13b),_0x3c7903(0x155),_0x3c7903(0x122),async()=>{const _0x1fe1f8=_0x3c7903;try{const _0x227fd1=await getDocs(collection(db,finalCollectionPath)),_0x7f740a=chunkArray(_0x227fd1[_0x1fe1f8(0x13a)],0x190);for(const _0x51a249 of _0x7f740a){const _0x25c6c3=writeBatch(db);_0x51a249[_0x1fe1f8(0x127)](_0x21d2db=>_0x25c6c3[_0x1fe1f8(0x17e)](_0x21d2db[_0x1fe1f8(0x1a0)])),await _0x25c6c3['commit']();}window[_0x1fe1f8(0xc9)]['showToast'](_0x1fe1f8(0x110));}catch(_0x169ec2){window[_0x1fe1f8(0xc9)][_0x1fe1f8(0x83)]('เกิดข้อผิดพลาด',_0x1fe1f8(0x179));}});},'openDeleteLabelsModal':()=>{const _0xb45ea4=_0x45c2bc;window[_0xb45ea4(0xc9)]['showLabelModal'](_0xb45ea4(0x158),'ลบฉลากทั้งหมด?',_0xb45ea4(0xb3),_0xb45ea4(0x122),async()=>{const _0x4f7baf=_0xb45ea4;try{const _0x170703=await getDocs(collection(db,cardCollectionPath)),_0x150fcd=chunkArray(_0x170703[_0x4f7baf(0x13a)],0x190);for(const _0x22865b of _0x150fcd){const _0x555736=writeBatch(db);_0x22865b[_0x4f7baf(0x127)](_0x3d2b60=>_0x555736[_0x4f7baf(0x17e)](_0x3d2b60[_0x4f7baf(0x1a0)])),await _0x555736[_0x4f7baf(0x163)]();}const _0x3a30da=await getDocs(collection(db,finalCollectionPath)),_0x3e6ce0=chunkArray(_0x3a30da[_0x4f7baf(0x13a)],0x190);for(const _0x54bafa of _0x3e6ce0){const _0x3c3be9=writeBatch(db);_0x54bafa[_0x4f7baf(0x127)](_0x255e10=>_0x3c3be9[_0x4f7baf(0xa4)](_0x255e10[_0x4f7baf(0x1a0)],{'DateLogin':'','StatusReward':'','DateReward':'','CardNo':''})),await _0x3c3be9[_0x4f7baf(0x163)]();}window[_0x4f7baf(0xc9)][_0x4f7baf(0x83)]('ลบฉลากสำเร็จ');}catch(_0x123650){window['app'][_0x4f7baf(0x83)](_0x4f7baf(0xeb),'error');}});},'openCreateLabelsModal':()=>{const _0x33e9e7=_0x45c2bc;window['app'][_0x33e9e7(0x106)]('Confirm',_0x33e9e7(0x87),_0x33e9e7(0x1ab),_0x33e9e7(0xfe),async()=>{const _0x286328=_0x33e9e7;try{await window['app'][_0x286328(0x19a)](),window['app'][_0x286328(0x83)](_0x286328(0x19b));}catch(_0x593a1a){window['app'][_0x286328(0x83)](_0x286328(0xeb),_0x286328(0x179));}});},'generateLabels':async()=>{const _0x45beab=_0x45c2bc;if(state['users'][_0x45beab(0x184)]===0x0){window['app'][_0x45beab(0x83)]('ยังไม่มีข้อมูลสมาชิก','error');return;}const _0x396dc4=await getDocs(collection(db,cardCollectionPath)),_0x180b54=chunkArray(_0x396dc4[_0x45beab(0x13a)],0x190);for(const _0x391d15 of _0x180b54){const _0x4bc230=writeBatch(db);_0x391d15[_0x45beab(0x127)](_0x5ecfed=>_0x4bc230[_0x45beab(0x17e)](_0x5ecfed[_0x45beab(0x1a0)])),await _0x4bc230[_0x45beab(0x163)]();}const _0x33b46d={},_0x461e3e=state[_0x45beab(0x1cd)]['map'](_0x2a017e=>{const _0x59dbe4=_0x45beab,_0x4610de=String(_0x2a017e['Reward']||_0x59dbe4(0xa6))[_0x59dbe4(0xf7)]();return _0x33b46d[_0x4610de]=(_0x33b46d[_0x4610de]||0x0)+0x1,{'Reward':_0x4610de,'rewardname':'','CardNo':String(_0x33b46d[_0x4610de]),'EmpName':'','citizenId':'','Datetime':''};}),_0x2af709=chunkArray(_0x461e3e,0x190);for(const _0x545547 of _0x2af709){const _0x5a7723=writeBatch(db);_0x545547[_0x45beab(0x127)](_0xb94951=>_0x5a7723[_0x45beab(0x98)](doc(collection(db,cardCollectionPath)),_0xb94951)),await _0x5a7723['commit']();}},'handleFileSelect':_0x4802a3=>{const _0x41c91d=_0x45c2bc,_0x37b0cd=_0x4802a3[_0x41c91d(0x14b)]['files'][0x0];_0x37b0cd&&(document[_0x41c91d(0xf9)](_0x41c91d(0xe2))['innerText']=_0x37b0cd[_0x41c91d(0x18b)],document[_0x41c91d(0xf9)](_0x41c91d(0xbd))[_0x41c91d(0x1da)][_0x41c91d(0x93)](_0x41c91d(0x14d)),document[_0x41c91d(0xf9)](_0x41c91d(0x1b8))[_0x41c91d(0x15b)]=![]);},'clearFileSelection':()=>{const _0x448f55=_0x45c2bc;document[_0x448f55(0xf9)](_0x448f55(0xc3))['value']='',document[_0x448f55(0xf9)](_0x448f55(0xbd))[_0x448f55(0x1da)][_0x448f55(0x11c)]('hidden'),document[_0x448f55(0xf9)](_0x448f55(0x1b8))['disabled']=!![];},'processImport':async()=>{const _0x311c39=_0x45c2bc,_0x4a259c=document[_0x311c39(0xf9)](_0x311c39(0xc3)),_0x116bbf=_0x4a259c[_0x311c39(0x124)][0x0];if(!_0x116bbf)return;document[_0x311c39(0xf9)](_0x311c39(0xb8))[_0x311c39(0x1da)][_0x311c39(0x93)](_0x311c39(0x14d));const _0x1863ff=document[_0x311c39(0xf9)](_0x311c39(0x113)),_0x435994=new FileReader();_0x435994[_0x311c39(0x1c8)]=async _0x3342ef=>{const _0x4a57fb=_0x311c39;try{const _0x37a08c=_0x116bbf[_0x4a57fb(0x18b)][_0x4a57fb(0xbf)]('.json')?JSON[_0x4a57fb(0xf2)](_0x3342ef['target'][_0x4a57fb(0xab)]):csvToJson(_0x3342ef[_0x4a57fb(0x14b)]['result']),_0x64f159=_0x37a08c[_0x4a57fb(0x184)];for(let _0x4e48e3=0x0;_0x4e48e3<_0x64f159;_0x4e48e3+=0x190){const _0x398ff2=_0x37a08c[_0x4a57fb(0x1cc)](_0x4e48e3,_0x4e48e3+0x190),_0x93651e=writeBatch(db),_0x10e6fe=_0x398ff2[_0x4a57fb(0xcd)](async(_0xcec295,_0x5d3e81)=>{const _0x1397ea=_0x4a57fb,_0x17adb8=String(_0xcec295['citizenId']||'')[_0x1397ea(0x173)](/-/g,'')[_0x1397ea(0xf7)](),_0x388b2d=await sha256(_0x17adb8),_0x31412d=(_0x4e48e3+_0x5d3e81+0x1)[_0x1397ea(0x1bd)](),_0x705bab=doc(collection(db,finalCollectionPath));_0x93651e[_0x1397ea(0x98)](_0x705bab,{'citizenId':_0x388b2d,'no':_0x31412d,'EmpName':_0xcec295[_0x1397ea(0xee)]||_0xcec295[_0x1397ea(0x8a)]||'','Dateworking':_0xcec295[_0x1397ea(0x1b5)]||'','Datework':_0xcec295[_0x1397ea(0x1b3)]||'','Reward':_0xcec295[_0x1397ea(0x8c)]||'','DateLogin':_0xcec295[_0x1397ea(0x8d)]||'','StatusReward':_0xcec295[_0x1397ea(0x125)]||'','DateReward':_0xcec295[_0x1397ea(0x1ae)]||'','DateCheck':_0xcec295[_0x1397ea(0x12d)]||'','importedAt':serverTimestamp()});});await Promise[_0x4a57fb(0x15a)](_0x10e6fe),await _0x93651e[_0x4a57fb(0x163)](),_0x1863ff[_0x4a57fb(0x196)][_0x4a57fb(0xa9)]=Math['min'](0x64,Math['round']((_0x4e48e3+_0x398ff2['length'])/_0x64f159*0x64))+'%';}window[_0x4a57fb(0xc9)][_0x4a57fb(0x83)](_0x4a57fb(0x92)),window[_0x4a57fb(0xc9)][_0x4a57fb(0xa8)]();}catch(_0x3e5031){window[_0x4a57fb(0xc9)][_0x4a57fb(0x83)](_0x4a57fb(0xda)+_0x3e5031[_0x4a57fb(0x10d)],_0x4a57fb(0x179));}finally{document[_0x4a57fb(0xf9)](_0x4a57fb(0xb8))[_0x4a57fb(0x1da)][_0x4a57fb(0x11c)]('hidden');}},_0x435994[_0x311c39(0x1bb)](_0x116bbf);},'refreshCharts':()=>{const _0x3a8a90=_0x45c2bc,_0x4ab2db=document[_0x3a8a90(0xf9)](_0x3a8a90(0x130));if(_0x4ab2db){if(window[_0x3a8a90(0xe9)])window['regPie'][_0x3a8a90(0x81)]();const _0xc13d86=state[_0x3a8a90(0x1cd)][_0x3a8a90(0x1d4)](_0x425bbc=>_0x425bbc['DateCheck']&&_0x425bbc[_0x3a8a90(0x12d)]!=='')[_0x3a8a90(0x184)];window['regPie']=new Chart(_0x4ab2db,{'type':_0x3a8a90(0x96),'data':{'labels':[_0x3a8a90(0xd7),_0x3a8a90(0x1c2)],'datasets':[{'data':[_0xc13d86,Math['max'](0x0,state[_0x3a8a90(0x1cd)][_0x3a8a90(0x184)]-_0xc13d86)],'backgroundColor':[_0x3a8a90(0x16b),'#e2e8f0']}]},'options':{'maintainAspectRatio':![]}});}const _0x4522ca=document[_0x3a8a90(0xf9)](_0x3a8a90(0x94));if(_0x4522ca){if(window['regLine'])window[_0x3a8a90(0x117)][_0x3a8a90(0x81)]();window[_0x3a8a90(0x117)]=new Chart(_0x4522ca,{'type':_0x3a8a90(0x156),'data':{'labels':Array['from']({'length':0x18},(_0x4d73fc,_0x411aca)=>_0x411aca+_0x3a8a90(0xe6)),'datasets':[{'label':_0x3a8a90(0x1a1),'data':state['hourlyData'],'borderColor':_0x3a8a90(0x1d8),'fill':!![],'tension':0.4}]},'options':{'maintainAspectRatio':![]}});}window[_0x3a8a90(0xc9)]['renderManualHistory']();},'renderManualHistory':()=>{const _0x502a97=_0x45c2bc,_0x14ac14=document[_0x502a97(0xf9)](_0x502a97(0x19f)),_0x4428f1=state[_0x502a97(0x1cd)]['filter'](_0x1c406c=>_0x1c406c[_0x502a97(0x12d)]&&_0x1c406c[_0x502a97(0x12d)]!=='')['sort']((_0x1ffe25,_0x27927f)=>{const _0x25ca63=_0x502a97,_0x44640d=_0x1ffe25[_0x25ca63(0x12d)]?.['toDate']?_0x1ffe25[_0x25ca63(0x12d)]['toDate']():new Date(_0x1ffe25['DateCheck']),_0x4eb672=_0x27927f[_0x25ca63(0x12d)]?.['toDate']?_0x27927f[_0x25ca63(0x12d)][_0x25ca63(0xd0)]():new Date(_0x27927f[_0x25ca63(0x12d)]);return _0x4eb672-_0x44640d;})[_0x502a97(0x1cc)](0x0,0xa);_0x14ac14&&(_0x14ac14[_0x502a97(0x126)]=_0x4428f1[_0x502a97(0x184)]?_0x4428f1[_0x502a97(0xcd)](_0x1280af=>_0x502a97(0x97)+(_0x1280af[_0x502a97(0xee)]||'Unknown')+_0x502a97(0x8e)+(_0x1280af['Reward']||'-')+_0x502a97(0xc8)+formatDate(_0x1280af[_0x502a97(0x12d)])+_0x502a97(0x10e))['join'](''):'<div\x20class=\x22text-center\x20text-slate-300\x20py-8\x20text-base\x20font-medium\x22>ไม่มีกิจกรรม</div>');},'resetMemberData':async _0x19c333=>{const _0x492124=_0x45c2bc;if(!confirm(_0x492124(0xed)))return;try{await updateDoc(doc(db,finalCollectionPath,_0x19c333),{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''}),window['app'][_0x492124(0x83)](_0x492124(0x1c4));}catch(_0x14fc3c){window['app'][_0x492124(0x83)]('ผิดพลาด',_0x492124(0x179));}},'resetLabelRecord':async _0x1819e0=>{const _0x187fe0=_0x45c2bc;if(!confirm('ล้างข้อมูลฉลากใบนี้?'))return;try{await updateDoc(doc(db,cardCollectionPath,_0x1819e0),{'EmpName':'','Datetime':'','citizenId':''}),window[_0x187fe0(0xc9)][_0x187fe0(0x83)](_0x187fe0(0xa1));}catch(_0x1717ec){window[_0x187fe0(0xc9)][_0x187fe0(0x83)](_0x187fe0(0xdc),_0x187fe0(0x179));}},'openEditRewardModal':(_0x396eb7,_0x1d7dda)=>{const _0x4db810=_0x45c2bc;document[_0x4db810(0xf9)](_0x4db810(0x89))['value']=_0x1d7dda,document['getElementById'](_0x4db810(0x143))['onclick']=async()=>{const _0x5b77a6=_0x4db810,_0xb7d3b4=document[_0x5b77a6(0xf9)](_0x5b77a6(0x89))[_0x5b77a6(0x1cf)]['trim']();try{await updateDoc(doc(db,cardCollectionPath,_0x396eb7),{'rewardname':_0xb7d3b4}),window[_0x5b77a6(0xc9)][_0x5b77a6(0x83)](_0x5b77a6(0x1c4)),window[_0x5b77a6(0xc9)]['closeEditRewardModal']();}catch(_0x4579fc){window[_0x5b77a6(0xc9)][_0x5b77a6(0x83)](_0x5b77a6(0xdc),_0x5b77a6(0x179));}},document[_0x4db810(0xf9)](_0x4db810(0x13c))[_0x4db810(0x1da)][_0x4db810(0x93)](_0x4db810(0x14d));},'showLabelModal':(_0x369805,_0x4ee955,_0x335407,_0x2fe543,_0x4fb9fb)=>{const _0x438cbf=_0x45c2bc,_0x28de9d=document[_0x438cbf(0xf9)](_0x438cbf(0x176)),_0x2babbb=document[_0x438cbf(0xf9)](_0x438cbf(0x181));document['getElementById'](_0x438cbf(0xb6))[_0x438cbf(0x85)]=_0x4ee955,document[_0x438cbf(0xf9)](_0x438cbf(0x123))[_0x438cbf(0x85)]=_0x335407;const _0x2febfc=document[_0x438cbf(0xf9)](_0x438cbf(0xcc));_0x2febfc[_0x438cbf(0x1d2)]='w-16\x20h-16\x20rounded-full\x20flex\x20items-center\x20justify-center\x20mx-auto\x20mb-4\x20bg-'+_0x2fe543+_0x438cbf(0xb1)+_0x2fe543+_0x438cbf(0x1bf),_0x2febfc['innerHTML']=_0x438cbf(0x1a2)+(_0x369805===_0x438cbf(0x158)?_0x438cbf(0x11f):_0x438cbf(0xc7))+_0x438cbf(0x152),document[_0x438cbf(0xf9)](_0x438cbf(0xb2))['classList'][_0x438cbf(0x93)](_0x438cbf(0x14d));const _0x4963ef=document['getElementById']('label-modal-input');_0x4963ef[_0x438cbf(0x1cf)]='',_0x4963ef[_0x438cbf(0x153)]=_0x438cbf(0x11a)+_0x369805+_0x438cbf(0x121),_0x2babbb[_0x438cbf(0x1d2)]=_0x438cbf(0x12c)+(_0x2fe543===_0x438cbf(0x122)?'red-600':_0x2fe543===_0x438cbf(0x1aa)?'orange-600':_0x438cbf(0xc4))+_0x438cbf(0x14a),_0x2babbb[_0x438cbf(0x85)]='ยืนยัน',_0x2babbb[_0x438cbf(0x99)]=async()=>{const _0x270235=_0x438cbf;if(_0x4963ef[_0x270235(0x1cf)]!==_0x369805)return window[_0x270235(0xc9)][_0x270235(0x83)](_0x270235(0x1df),_0x270235(0x179));_0x2babbb['disabled']=!![],_0x2babbb[_0x270235(0x85)]=_0x270235(0x80);try{await _0x4fb9fb(),window['app'][_0x270235(0x108)]();}finally{_0x2babbb[_0x270235(0x15b)]=![],_0x2babbb[_0x270235(0x85)]=_0x270235(0x171);}},_0x28de9d[_0x438cbf(0x1da)][_0x438cbf(0x93)](_0x438cbf(0x14d)),lucide[_0x438cbf(0x18a)]();},'closeLabelModal':()=>document[_0x45c2bc(0xf9)]('label-confirm-modal')[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'closeEditRewardModal':()=>document['getElementById'](_0x45c2bc(0x13c))[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'closeGeneralModal':()=>document[_0x45c2bc(0xf9)](_0x45c2bc(0x1a7))[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'onLabelGroupChange':_0x3ebd16=>{const _0xaec09f=_0x45c2bc;state['selectedLabelGroup']=normalizeReward(_0x3ebd16),state[_0xaec09f(0x134)]=0x1,window[_0xaec09f(0xc9)][_0xaec09f(0x146)]();},'onDataRewardFilterChange':_0x95f4c9=>{const _0x39473d=_0x45c2bc;state[_0x39473d(0x15d)]=_0x95f4c9,state[_0x39473d(0x13d)]=0x1,window[_0x39473d(0xc9)][_0x39473d(0x114)]();},'handleSearch':_0x47c826=>{const _0x34ff75=_0x45c2bc;state['searchTerm']=_0x47c826[_0x34ff75(0x1a8)](),state[_0x34ff75(0x13d)]=0x1,window[_0x34ff75(0xc9)]['renderTable']();},'changeRowsLimit':_0x13db11=>{const _0x5f5454=_0x45c2bc;state[_0x5f5454(0xa7)]=parseInt(_0x13db11),state[_0x5f5454(0x13d)]=0x1,window[_0x5f5454(0xc9)][_0x5f5454(0x114)]();},'changePage':_0xdae538=>{const _0x30bf96=_0x45c2bc;state[_0x30bf96(0x13d)]+=_0xdae538,window[_0x30bf96(0xc9)][_0x30bf96(0x114)]();},'changeSort':_0x2bfe5f=>{const _0x5618b4=_0x45c2bc;state[_0x5618b4(0x1b9)]=state[_0x5618b4(0x82)]===_0x2bfe5f?state[_0x5618b4(0x1b9)]==='asc'?_0x5618b4(0x1d7):_0x5618b4(0x10c):_0x2bfe5f==='no'?_0x5618b4(0x10c):'desc',state[_0x5618b4(0x82)]=_0x2bfe5f,window[_0x5618b4(0xc9)][_0x5618b4(0x114)]();},'changeLogPage':_0x38d337=>{const _0x2ec1ab=_0x45c2bc;state[_0x2ec1ab(0xdf)]+=_0x38d337,window['app'][_0x2ec1ab(0xbc)]();},'changeLogSort':_0x1adf37=>{const _0x17b995=_0x45c2bc;state[_0x17b995(0xf0)]=state[_0x17b995(0x9c)]===_0x1adf37?state['logSortOrder']===_0x17b995(0x10c)?'desc':'asc':_0x17b995(0x1d7),state[_0x17b995(0x9c)]=_0x1adf37,window[_0x17b995(0xc9)]['renderLogTable']();}};async function init(){const _0x2e0c26=_0x45c2bc;try{if(typeof __initial_auth_token!==_0x2e0c26(0x133)&&__initial_auth_token)await signInWithCustomToken(auth,__initial_auth_token);else await signInAnonymously(auth);document[_0x2e0c26(0xf9)](_0x2e0c26(0x14e))?.['classList'][_0x2e0c26(0x173)](_0x2e0c26(0x177),_0x2e0c26(0x18f));if(document[_0x2e0c26(0xf9)](_0x2e0c26(0xbe)))document['getElementById'](_0x2e0c26(0xbe))[_0x2e0c26(0x85)]=_0x2e0c26(0x11e);onSnapshot(collection(db,finalCollectionPath),_0x44a161=>{const _0x42116d=_0x2e0c26;state[_0x42116d(0x1cd)]=_0x44a161[_0x42116d(0x13a)][_0x42116d(0xcd)](_0x5b210c=>({'id':_0x5b210c['id'],..._0x5b210c[_0x42116d(0xfd)]()})),document[_0x42116d(0xf9)](_0x42116d(0x190))['innerText']=_0x44a161[_0x42116d(0x101)][_0x42116d(0x199)](),document[_0x42116d(0xf9)](_0x42116d(0x115))['innerText']=_0x44a161[_0x42116d(0x101)][_0x42116d(0x199)]();const _0x14139e=state[_0x42116d(0x1cd)][_0x42116d(0x1d4)](_0x2ccca0=>_0x2ccca0[_0x42116d(0x12d)]&&_0x2ccca0[_0x42116d(0x12d)]!=='')[_0x42116d(0x184)];document[_0x42116d(0xf9)](_0x42116d(0x149))['innerText']=_0x14139e[_0x42116d(0x199)](),document[_0x42116d(0xf9)](_0x42116d(0xcb))[_0x42116d(0x85)]=_0x44a161[_0x42116d(0x101)]>0x0?(_0x14139e/_0x44a161[_0x42116d(0x101)]*0x64)['toFixed'](0x1)+'%':'0%';const _0x2e20d3=Array(0x18)[_0x42116d(0x1dd)](0x0);state[_0x42116d(0x1cd)][_0x42116d(0x127)](_0x3234bf=>{const _0x5ec567=_0x42116d;if(_0x3234bf['DateCheck'])try{let _0x1b8f4f=_0x3234bf['DateCheck'][_0x5ec567(0xd0)]?_0x3234bf['DateCheck'][_0x5ec567(0xd0)]():new Date(_0x3234bf[_0x5ec567(0x12d)]);if(!isNaN(_0x1b8f4f[_0x5ec567(0x116)]()))_0x2e20d3[_0x1b8f4f[_0x5ec567(0x17c)]()]++;}catch(_0x1c784d){}}),state[_0x42116d(0xfc)]=_0x2e20d3;const _0x55ecaa=[...new Set(state[_0x42116d(0x1cd)][_0x42116d(0xcd)](_0x31ffe2=>String(_0x31ffe2[_0x42116d(0x8c)]||'')[_0x42116d(0xf7)]())['filter'](_0x271393=>_0x271393!==''))][_0x42116d(0x161)]((_0x2fad0f,_0x2e3e08)=>_0x2fad0f['localeCompare'](_0x2e3e08)),_0xbef67b=document[_0x42116d(0xf9)](_0x42116d(0x148));if(_0xbef67b){const _0x5968c3=_0xbef67b[_0x42116d(0x1cf)];_0xbef67b['innerHTML']=_0x42116d(0xaa)+_0x55ecaa[_0x42116d(0xcd)](_0x12d3cb=>'<option\x20value=\x22'+_0x12d3cb+'\x22>'+_0x12d3cb+_0x42116d(0x142))['join'](''),_0xbef67b[_0x42116d(0x1cf)]=_0x55ecaa[_0x42116d(0x165)](_0x5968c3)?_0x5968c3:'';}window[_0x42116d(0xc9)][_0x42116d(0x114)](),window[_0x42116d(0xc9)]['renderDataSummary'](),window[_0x42116d(0xc9)][_0x42116d(0x10b)](),window[_0x42116d(0xc9)][_0x42116d(0x140)]();}),onSnapshot(collection(db,cardCollectionPath),_0x4cc93a=>{const _0x1b0406=_0x2e0c26;state[_0x1b0406(0xd8)]=_0x4cc93a['docs'][_0x1b0406(0xcd)](_0x1889cc=>({'id':_0x1889cc['id'],..._0x1889cc[_0x1b0406(0xfd)]()}));const _0x16ff3d=[_0x1b0406(0x17f),_0x1b0406(0x1e1),_0x1b0406(0xaf),'4000'],_0x5e0300={};_0x16ff3d[_0x1b0406(0x127)](_0x6a4986=>_0x5e0300[_0x6a4986]={'total':0x0,'used':0x0}),state['cards'][_0x1b0406(0x127)](_0xba1b68=>{const _0x59d003=_0x1b0406,_0x726765=normalizeReward(_0xba1b68[_0x59d003(0x8c)]);if(_0x5e0300[_0x59d003(0xc2)](_0x726765)){_0x5e0300[_0x726765]['total']++;if(_0xba1b68['Datetime']&&_0xba1b68[_0x59d003(0x1dc)]!=='')_0x5e0300[_0x726765][_0x59d003(0x178)]++;}}),_0x16ff3d[_0x1b0406(0x127)](_0x2f076b=>{const _0x17e943=_0x1b0406,_0x14eb29=_0x5e0300[_0x2f076b],_0x21b8c0=_0x14eb29[_0x17e943(0x91)]>0x0?Math['round'](_0x14eb29[_0x17e943(0x178)]/_0x14eb29[_0x17e943(0x91)]*0x64):0x0;if(document[_0x17e943(0xf9)](_0x17e943(0xd1)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0xd1)+_0x2f076b)[_0x17e943(0x126)]=_0x14eb29['total'][_0x17e943(0x199)]()+_0x17e943(0x162);if(document['getElementById']('card-used-'+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0x12e)+_0x2f076b)['innerText']=_0x14eb29[_0x17e943(0x178)][_0x17e943(0x199)]();if(document['getElementById'](_0x17e943(0x1d9)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0x1d9)+_0x2f076b)[_0x17e943(0x85)]=_0x21b8c0+'%';if(document['getElementById'](_0x17e943(0xb0)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0xb0)+_0x2f076b)[_0x17e943(0x196)][_0x17e943(0xa9)]=_0x21b8c0+'%';});const _0x48f4e1=[...new Set(state[_0x1b0406(0xd8)][_0x1b0406(0xcd)](_0x5805ba=>normalizeReward(_0x5805ba[_0x1b0406(0x8c)])))][_0x1b0406(0x1d4)](_0xb57c2d=>_0xb57c2d!=='')[_0x1b0406(0x161)]((_0x1c7af9,_0x8d3dc)=>_0x1c7af9[_0x1b0406(0x1a3)](_0x8d3dc,undefined,{'numeric':!![]})),_0x54924f=document[_0x1b0406(0xf9)](_0x1b0406(0xb5));if(_0x54924f){const _0x525024=_0x54924f[_0x1b0406(0x1cf)];_0x54924f[_0x1b0406(0x126)]=_0x1b0406(0x15c)+_0x48f4e1['map'](_0x1ceb85=>_0x1b0406(0x159)+_0x1ceb85+'\x22>'+_0x1ceb85+_0x1b0406(0x142))[_0x1b0406(0xc6)](''),_0x54924f['value']=_0x525024||'';}window[_0x1b0406(0xc9)][_0x1b0406(0x146)](),window[_0x1b0406(0xc9)][_0x1b0406(0x10b)]();}),onSnapshot(collection(db,logCollectionPath),_0x223ecd=>{const _0x30c77d=_0x2e0c26;state[_0x30c77d(0xce)]=_0x223ecd[_0x30c77d(0x13a)][_0x30c77d(0xcd)](_0xbef011=>({'id':_0xbef011['id'],..._0xbef011['data']()}));if(state[_0x30c77d(0x13f)]===_0x30c77d(0xce))window['app'][_0x30c77d(0xbc)]();}),window[_0x2e0c26(0xc9)]['switchTab'](state[_0x2e0c26(0x13f)]);}catch(_0x3eb455){console[_0x2e0c26(0x179)](_0x3eb455);}}function _0x4181(){const _0x11a4be=['bg-rose-600','ttb-register.firebasestorage.app','createIcons','name','รีเซ็ตสำเร็จ','toast-container','download','bg-green-500','stat-checkin','log-total-count','.csv','group','toLocaleTimeString','.view-section','style','</td><td\x20class=\x22px-6\x20text-indigo-600\x20font-bold\x20font-bold\x22>','ผู้รับรางวัล\x20(EmpName)','toLocaleString','generateLabels','สร้างฉลากใหม่สำเร็จ','แสดง\x20','log-pagination-controls','%</span></div><div\x20class=\x22w-full\x20','recent-activity-list','ref','ความถี่การลงทะเบียน','<i\x20data-lucide=\x22','localeCompare','log-table-body','\x20จากทั้งหมด\x20','text-white','general-modal','toLowerCase','bg-amber-600','orange','ยืนยันการสร้างสลากใหม่โดยอ้างอิงจากรายชื่อสมาชิกที่มีอยู่จริงในระบบ','rewardname','amber','DateReward','75wMLzWe','body','370196VUlTNG','<div\x20class=\x22flex\x20flex-col\x20py-2\x20border-b\x20border-slate-50\x20last:border-0\x20px-2\x20font-bold\x22><span\x20class=\x22text-slate-800\x20text-lg\x22>','Datework','labels_export_','Dateworking','1385805ouvJtQ','\x20p-5\x20rounded-2xl\x20shadow-xl\x20border\x20border-white/10\x20flex\x20flex-col\x20transition-all\x20hover:shadow-2xl\x20hover:scale-[1.02]\x20h-full\x20','btn-import','sortOrder','\x20บาท</h4></div><div\x20class=\x22bg-','readAsText','NO.','toString','StatusReg','-600\x20font-bold','Outsources_card','-500\x20h-2\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','ยังไม่ลงทะเบียน','>แก้ไข</button><button\x20onclick=\x22','สำเร็จ','</td><td\x20class=\x22px-4\x20py-3\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22>','---','-700\x22>','onload','<span\x20class=\x22text-sm\x20font-bold\x20text-slate-700\x22>','\x20h-1.5\x20mt-auto\x20rounded-full\x20overflow-hidden\x20mt-3\x20shadow-inner\x22><div\x20class=\x22bg-white\x20h-1.5\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','</td><td\x20class=\x22px-4\x20py-3\x20font-bold\x22><span\x20class=\x22px-2\x20py-0.5\x20rounded-full\x20text-[10px]\x20bg-blue-100\x20text-blue-600\x20font-bold\x22>','slice','users','>Prev</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','value','registered','</span><span\x20class=\x22text-[9px]\x20text-slate-300\x20font-normal\x20mt-0.5\x22>','className','current-time','filter','ตรวจสอบรายการ','searchTerm','desc','#3b82f6','card-percent-','classList','CardNo','Datetime','fill','labelSortOrder','คำยืนยันไม่ถูกต้อง','round','2000','\x20-\x20','กำลังดำเนินการ...','destroy','sortBy','showToast','reduce','innerText','พิมพ์\x20Reset\x20เพื่อล้างข้อมูลการล็อกอินและผลการสุ่มทั้งหมด','สร้างฉลากใหม่?','<tr\x20class=\x22hover:bg-blue-50/50\x20transition\x20font-bold\x20text-slate-700\x20text-sm\x22><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-slate-400\x20font-normal\x20text-sm\x22>','edit-reward-input','Name','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','Reward','DateLogin','</b>\x20<span\x20class=\x22text-slate-400\x20font-normal\x20mx-1\x22>กลุ่ม:</span>\x20<span\x20class=\x22text-indigo-600\x22>','\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>ราย</span></h3><div\x20class=\x22mt-2\x20flex\x20justify-between\x20items-baseline\x20font-bold\x22><span\x20class=\x22text-sm\x22>','click','total','นำเข้าข้อมูลเรียบร้อย','remove','realtimeLineChart','</span>','doughnut','<div\x20class=\x22p-3\x20bg-white\x20rounded-lg\x20text-sm\x20shadow-sm\x20border\x20border-slate-100\x20mb-1\x20font-bold\x22><b\x20class=\x22text-slate-800\x20font-black\x22>','set','onclick','ลบประวัติ\x20Log\x20เรียบร้อยแล้ว','</td></tr>','logSortKey','<button\x20onclick=\x22window.app.changeLogPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-50\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22><td\x20class=\x22px-6\x20font-mono\x20text-slate-500\x22>','จัดการข้อมูล','window.app.openEditRewardModal(\x27','ล้างข้อมูลแล้ว','SHA-256','index','update','winners','ไม่ระบุกลุ่ม','rowsPerPage','clearFileSelection','width','<option\x20value=\x22\x22>--\x20ทั้งหมด\x20--</option>','result','11unxABl','</span><button\x20onclick=\x22window.app.changeLogPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','div','3000','card-bar-','-100\x20text-','label-modal-input-container','พิมพ์\x20Delete\x20เพื่อลบสลากทั้งหมดออกจากระบบและรีเซ็ตสถานะสุ่ม','</td><td\x20class=\x22px-6\x20text-slate-500\x20font-bold\x22>','label-group-select','label-modal-title','artifacts/','import-progress','\x20/\x20','</span></div>','push','renderLogTable','file-info','status-text','endsWith','window.app.resetLabelRecord(\x27','>ล้างผลสุ่ม</button></div></td></tr>','hasOwnProperty','file-upload','indigo-600','สุ่มครั้งที่\x201\x20(DateLogin)','join','check-circle','</span>\x20<div\x20class=\x22text-[10px]\x20text-slate-400\x20mt-1\x20font-normal\x22>ลงทะเบียนเมื่อ\x20','app','data-table-info','stat-percent','label-modal-icon','map','logs','ภาพรวมระบบ','toDate','card-total-','default-app-id','1:1070273157855:web:5c8120e1df27e233d8676a','แสดงรายการที่\x20','querySelectorAll','dashboard','ลงทะเบียนแล้ว','cards','รางวัล\x20(StatusReward)','ผิดพลาด:\x20','ของรางวัล\x20(Reward\x20Name)','ผิดพลาด','ไม่มีข้อมูลสำหรับดาวน์โหลด','type','logPage','createElement','</td><td\x20class=\x22px-6\x20py-4\x20text-indigo-600\x20font-normal\x20font-bold\x22>','file-name','</span><button\x20onclick=\x22window.app.changeLabelPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','-600\x22>','-500\x20text-white\x20p-3\x20text-center\x22><p\x20class=\x22text-[13px]\x20font-black\x20opacity-80\x20tracking-widest\x20uppercase\x22>กลุ่มรางวัล</p><h4\x20class=\x22text-xl\x20font-black\x22>',':00','</td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-500\x20font-normal\x20text-sm\x20truncate\x20max-w-[120px]\x22\x20title=\x22','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20transition\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2218\x22></i></button></td></tr>','regPie','\x20คน</p></div></div>','เกิดข้อผิดพลาด','14341896xDHCcf','ยืนยันการล้างข้อมูล?','EmpName','Reset','logSortOrder','Outsources','parse','winners-container','1950528hZbFng','%\x22></div></div><p\x20class=\x22text-[12px]\x20text-slate-400\x20mt-2\x20text-right\x20font-bold\x20text-slate-600\x20italic\x22>พนักงานในกลุ่มนี้:\x20','\x20<span\x20class=\x22text-[10px]\x20opacity-70\x20font-normal\x22>ลงทะเบียนแล้ว</span></span><span\x20class=\x22text-lg\x20font-black\x22>','trim','bar','getElementById','percent','</span><span\x20class=\x22text-xs\x20text-','hourlyData','data','indigo','labelSortKey','label','size','\x22\x20class=\x22text-red-500\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-red-200\x20rounded-lg\x20','opacity-0','</td><td\x20class=\x22px-4\x20py-3\x20text-slate-500\x20font-normal\x20text-sm\x22>','selectedLabelGroup','showLabelModal','Reward\x20(Group)','closeLabelModal','<button\x20onclick=\x22window.app.changePage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','removeChild','renderWinnersView','asc','message','</div></div>','href','ลบสำเร็จ','data-summary-container','visibility','import-bar','renderTable','manage-total-docs','getTime','regLine','setAttribute','</div><div\x20class=\x22bg-slate-50\x20p-5\x20border-t\x22><div\x20class=\x22flex\x20justify-between\x20items-center\x20mb-1.5\x20font-bold\x22><span\x20class=\x22text-[12px]\x20text-slate-500\x22>สถิติการสุ่มรางวัล</span><span\x20class=\x22text-xs\x20text-slate-700\x22>','พิมพ์\x20','bg-white/30','add','ข้อมูลลงทะเบียน','Online','trash-2','ceil','\x20เพื่อยืนยัน','red','label-modal-message','files','StatusReward','innerHTML','forEach','<div\x20class=\x22','9744XjaqZv','9IlnfZq','14430hZjkHf','flex-1\x20py-3\x20rounded-xl\x20bg-','DateCheck','card-used-','bg-slate-700','registrationChart','สุ่มครั้งที่\x202\x20(DateReward)','<div\x20class=\x22text-base\x20text-slate-400\x20py-6\x20text-center\x20italic\x22>ยังไม่มีผู้ได้รับรางวัล</div>','undefined','labelPage','Success','\x20ราย</span></div><div\x20class=\x22w-full\x20bg-slate-200\x20rounded-full\x20h-2\x22><div\x20class=\x22bg-','3840JJodnK','outsources_logs_','th-TH','docs','ลบข้อมูลพนักงานทั้งหมด?','edit-reward-modal','currentPage','>ถัดไป</button>','activeTab','refreshCharts','renderDataSummary','</option>','edit-reward-confirm-btn','padStart','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-normal\x20font-bold\x22>','renderLabelTable','1070273157855','filter-data-reward','stat-checkout','\x20text-white\x20font-bold\x20hover:opacity-90\x20transition\x20font-bold','target','\x20font-bold\x22><p\x20class=\x22text-[11px]\x20font-bold\x20uppercase\x20tracking-wider\x20opacity-80\x22>','hidden','status-indicator','4000','</td><td\x20class=\x22px-6\x20py-4\x20text-right\x20font-bold\x22><button\x20onclick=\x22window.app.resetMemberData(\x27','สมาชิกทั้งหมด','\x22\x20width=\x2232\x22></i>','placeholder','ttb-register','พิมพ์\x20Delete\x20เพื่อลบรายชื่อพนักงานทั้งหมดออกจากฐานข้อมูล','line','createObjectURL','Delete','<option\x20value=\x22','all','disabled','<option\x20value=\x22\x22>รางวัลทั้งหมด</option>','selectedDataReward','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-700\x20font-normal\x20font-bold\x22>','>ย้อนกลับ</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','success','sort','\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>สลาก</span>','commit','35UWqsRE','includes','deviceID','ระบบจัดการฉลาก','</td><td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20font-normal\x20font-bold\x22>','label-pagination-controls','ลบประวัติรายการทั้งหมด?','#10b981','3746090imjrRQ','blue','split','text/csv;charset=utf-8;','appendChild','ยืนยัน','\x27,\x20\x27','replace','bg-white\x20border-l-4\x20','citizenId','label-confirm-modal','bg-red-500','used','error','pagination-controls','/public/data/','getHours','</p><h3\x20class=\x22text-3xl\x20font-black\x20mt-1\x20leading-tight\x22>','delete','1000','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-100\x20font-bold\x22><td\x20class=\x22px-6\x20py-4\x20text-slate-600\x20font-normal\x22>','label-modal-confirm-btn','พิมพ์\x20Delete\x20เพื่อลบประวัติ\x20Log\x20การทำรายการทั้งหมดถาวร','>Next</button>','length','Outsources_log','toLocaleDateString','</div></div><div\x20class=\x22p-4\x20flex-1\x20overflow-y-auto\x20max-h-[350px]\x20custom-scroll-dark\x22><p\x20class=\x22text-[10px]\x20text-slate-400\x20mb-2\x20font-bold\x20uppercase\x20tracking-tighter\x22>รายชื่อผู้ได้รับรางวัลล่าสุด</p>'];_0x4181=function(){return _0x11a4be;};return _0x4181();}setInterval(()=>{const _0x3f114c=_0x45c2bc;if(document['getElementById'](_0x3f114c(0x1d3)))document['getElementById'](_0x3f114c(0x1d3))[_0x3f114c(0x85)]=new Date()[_0x3f114c(0x194)]('th-TH');},0x3e8),init();
    </script>
</body>

</html>

