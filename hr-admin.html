<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        .table-compact tr { height: 30px; }
        .table-compact td { padding-top: 0px; padding-bottom: 0px; vertical-align: middle; line-height: 1; }
        #table-body tr:nth-child(even), #label-table-body tr:nth-child(even), #log-table-body tr:nth-child(even) { background-color: #f8fafc; }
        #table-body tr:nth-child(odd), #label-table-body tr:nth-child(odd), #log-table-body tr:nth-child(odd) { background-color: #ffffff; }
        .table-compact th { height: 35px; padding-top: 4px; padding-bottom: 4px; }
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">HR Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการข้อมูลพนักงาน</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('winners')" id="nav-winners" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                <i data-lucide="trophy" width="20"></i> รางวัลโชคชั้นที่ 2
            </button>
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">Management</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
                </button>
                <button onclick="window.app.switchTab('labels')" id="nav-labels" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="tags" width="20"></i> ระบบจัดการฉลาก
                </button>
                <button onclick="window.app.switchTab('logs')" id="nav-logs" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="file-search" width="20"></i> ตรวจสอบรายการ
                </button>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all font-bold">
                    <i data-lucide="qr-code" width="20"></i> QR Code ฮั่งเปา
                </button>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4 font-bold">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">แดชบอร์ด</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block font-bold">
                    <p class="text-sm text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">A</div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="users" width="60" height="60" class="text-blue-600"></i></div>
                        <p class="text-slate-500 text-sm">สมาชิกทั้งหมด</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="user-check" width="60" height="60" class="text-green-600"></i></div>
                        <p class="text-slate-500 text-sm">สมาชิกลงทะเบียน</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group font-bold">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="percent" width="60" height="60" class="text-orange-400"></i></div>
                        <p class="text-slate-500 text-sm">% ลงทะเบียน</p>
                        <h3 id="stat-percent" class="text-2xl font-bold text-slate-800 mt-2">0%</h3>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100 h-full flex flex-col">
                        <h3 class="font-bold text-lg text-slate-700 mb-4 flex items-center gap-2"><div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สัดส่วนการลงทะเบียน</h3>
                        <div class="h-64 flex justify-center"><canvas id="registrationChart"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1 text-base font-bold text-slate-700"></div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h3 class="font-bold text-lg text-slate-700 mb-4 flex items-center gap-2"><i data-lucide="activity" width="20" class="text-blue-500"></i> สถิติการลงทะเบียนรายชั่วโมง</h3>
                    <div class="h-64"><canvas id="realtimeLineChart"></canvas></div>
                </div>
            </div>

            <!-- VIEW 2: DATA TABLE -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                 <div id="data-summary-container" class="grid grid-cols-1 md:grid-cols-5 gap-4"></div>
                 <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-4 flex-wrap justify-end">
                             <div class="flex items-center gap-2 font-bold">
                                <label class="text-sm text-slate-600">กรอง Reward:</label>
                                <select id="filter-data-reward" onchange="window.app.onDataRewardFilterChange(this.value)" class="bg-white border border-slate-200 text-slate-600 text-sm rounded-lg p-2 w-48 shadow-sm">
                                    <option value="">-- ทั้งหมด --</option>
                                </select>
                             </div>
                             <div class="flex items-center gap-2 font-bold">
                                <label class="text-sm text-slate-600">แสดง:</label>
                                <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-white border border-slate-200 text-slate-600 text-sm rounded-lg p-2">
                                    <option value="20">20 แถว</option>
                                    <option value="50" selected>50 แถว</option>
                                    <option value="100">100 แถว</option>
                                </select>
                             </div>
                             <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 font-bold">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100 text-base">
                                <tr>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('no')">NO. <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('EmpName')">ชื่อ-นามสกุล <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('Reward')">Group <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateCheck')">Login <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateLogin')">สุ่มครั้งที่ 1 <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('DateReward')">สุ่มครั้งที่ 2 <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeSort('StatusReward')">รางวัล <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 py-4 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100 text-sm font-normal text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="p-4 border-t bg-slate-50 flex justify-between items-center px-6">
                        <p class="text-sm text-slate-400 font-bold" id="data-table-info"></p>
                        <div class="flex gap-4 items-center">
                            <button onclick="window.app.exportDataToCSV()" class="px-4 py-1.5 bg-emerald-600 text-white rounded-lg font-bold text-xs hover:bg-emerald-700 flex items-center gap-2 shadow-sm transition">
                                <i data-lucide="download" width="14"></i> Download CSV File
                            </button>
                            <div class="flex gap-2" id="pagination-controls"></div>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- VIEW 3: WINNERS -->
            <div id="view-winners" class="view-section hidden space-y-6 fade-in-up">
                 <div id="winners-container" class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-[80%] mx-auto font-bold"></div>
            </div>

            <!-- VIEW 4: IMPORT -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up font-bold">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2 font-bold"><i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูล (JSON/CSV)</h3>
                        <p class="text-sm text-slate-500 mb-4">ระบบจะรันหมายเลข <code>no</code> ให้อัตโนมัติทุกครั้งที่นำเข้าใหม่</p>
                        <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('file-upload').click()">
                            <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                            <p class="text-sm font-bold text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากมาวางที่นี่</p>
                            <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                        </div>
                        <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700 mt-4">
                            <span id="file-name" class="font-bold"></span>
                            <button onclick="window.app.clearFileSelection()"><i data-lucide="x" width="16"></i></button>
                        </div>
                        <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold mt-4 hover:bg-blue-700 transition shadow-lg shadow-blue-100 font-bold">เริ่มนำเข้าข้อมูล</button>
                        <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5 mt-4">
                            <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 font-bold">จัดการระบบ</h3>
                         <div class="space-y-4">
                             <div class="bg-slate-50 p-4 rounded-xl flex justify-between items-center">
                                <div><p class="text-sm text-slate-500 font-bold">พนักงานในระบบ</p><h2 class="text-2xl font-bold" id="manage-total-docs">0</h2></div>
                                <i data-lucide="database" class="text-slate-300" width="40"></i>
                             </div>
                             <div class="grid grid-cols-2 gap-2">
                                <button onclick="window.app.openResetModal()" class="w-full py-3 border border-orange-300 text-orange-700 rounded-xl font-bold text-sm hover:bg-orange-50 transition">Reset Register</button>
                                <button onclick="window.app.openDeleteModal()" class="w-full py-3 border border-red-300 text-red-700 rounded-xl font-bold text-sm hover:bg-red-50 transition">Delete All</button>
                             </div>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: LABELS -->
            <div id="view-labels" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                    <h3 class="font-bold text-lg text-slate-800 mb-6 flex items-center gap-2"><i data-lucide="tags" width="20" class="text-indigo-600"></i> ระบบจัดการฉลาก</h3>
                    <div id="label-summary-container" class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
                        <!-- Stats boxes populated in init() -->
                        <div class="bg-rose-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 1,000</p>
                            <h4 id="card-total-1000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-1000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-1000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-1000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-emerald-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 2,000</p>
                            <h4 id="card-total-2000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-2000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-2000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-2000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-sky-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 3,000</p>
                            <h4 id="card-total-3000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-3000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-3000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-3000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                        <div class="bg-amber-600 text-white p-5 rounded-2xl flex flex-col justify-center shadow-xl border border-white/10 transition-all hover:scale-[1.02]">
                            <p class="text-[11px] font-bold uppercase tracking-wider opacity-80">กลุ่ม 4,000</p>
                            <h4 id="card-total-4000" class="text-2xl font-black mt-1">0 <span class="text-xs font-normal opacity-70">สลาก</span></h4>
                            <div class="mt-2 flex justify-between items-baseline font-bold"><span class="text-xs"><span id="card-used-4000">0</span> <span class="opacity-70 font-normal">ใช้แล้ว</span></span><span class="text-sm font-black" id="card-percent-4000">0%</span></div>
                            <div class="w-full bg-white/30 h-1 mt-2 rounded-full overflow-hidden"><div id="card-bar-4000" class="bg-white h-1 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="flex flex-col md:flex-row gap-3">
                        <button onclick="window.app.openDeleteLabelsModal()" class="flex-1 min-h-[50px] bg-red-50 text-red-600 border border-red-200 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-red-100 transition shadow-sm group">
                            <i data-lucide="trash-2" width="20"></i> ลบฉลากทั้งหมด
                        </button>
                        <button onclick="window.app.openCreateLabelsModal()" class="flex-1 min-h-[50px] bg-indigo-600 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-indigo-700 transition shadow-lg shadow-indigo-200 group">
                            <i data-lucide="plus-circle" width="20"></i> สร้างฉลากใหม่
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden mt-6">
                    <div class="p-4 bg-slate-50 border-b flex justify-between items-center">
                        <h3 class="font-bold text-slate-700 text-lg">ตารางแสดงผลฉลากตามกลุ่ม</h3>
                        <div class="flex items-center gap-3 font-bold">
                            <label class="text-sm text-slate-600">เลือกกลุ่มรางวัล:</label>
                            <select id="label-group-select" onchange="window.app.onLabelGroupChange(this.value)" class="w-48 p-2 border rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                                <option value="">รางวัลทั้งหมด</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-base table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold uppercase text-xs">
                                <tr>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('CardNo')">ลำดับที่ <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('Reward')">Reward (กลุ่ม) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('rewardname')">ของรางวัล (Reward Name) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('EmpName')">ผู้รับรางวัล (EmpName) <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 cursor-pointer hover:bg-slate-300 transition" onclick="window.app.changeLabelSort('Datetime')">Datetime <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-6 text-right">Admin</th>
                                </tr>
                            </thead>
                            <tbody id="label-table-body" class="divide-y divide-slate-100 font-normal text-sm text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="p-4 border-t bg-slate-50 flex justify-between items-center px-6">
                        <p class="text-sm text-slate-400 font-bold" id="label-table-info"></p>
                        <div class="flex gap-4 items-center">
                            <button onclick="window.app.exportLabelsToCSV()" class="px-4 py-1.5 bg-emerald-600 text-white rounded-lg font-bold text-xs hover:bg-emerald-700 flex items-center gap-2 shadow-sm transition">
                                <i data-lucide="download" width="14"></i> Download CSV File
                            </button>
                            <div class="flex gap-2" id="label-pagination-controls"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: LOGS -->
            <div id="view-logs" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 font-bold">
                    <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2 font-bold"><i data-lucide="file-search" width="20" class="text-blue-600"></i> ตรวจสอบรายการ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-white">
                        <div class="bg-blue-600 p-4 rounded-xl flex justify-between items-center border border-white/10 shadow-xl">
                            <div>
                                <p class="text-xs font-bold uppercase tracking-wider opacity-80">จำนวนข้อมูลทั้งหมด</p>
                                <h2 class="text-3xl font-black" id="log-total-count">0</h2>
                            </div>
                            <i data-lucide="list" class="opacity-30" width="40"></i>
                        </div>
                        <div class="bg-rose-600 p-4 rounded-xl flex justify-between items-center border border-white/10 shadow-xl">
                            <div>
                                <p class="text-xs font-bold uppercase tracking-wider opacity-80">จัดการข้อมูล</p>
                                <button onclick="window.app.openDeleteLogsModal()" class="mt-2 px-4 py-2 bg-white text-rose-600 rounded-lg font-bold text-xs hover:bg-slate-100 transition shadow-lg flex items-center gap-2">
                                    <i data-lucide="trash-2" width="14"></i> ลบ Log File ทั้งหมด
                                </button>
                            </div>
                            <i data-lucide="alert-triangle" class="opacity-30" width="40"></i>
                        </div>
                    </div>
                    <div class="overflow-x-auto rounded-xl border border-slate-100">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold text-sm">
                                <tr>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('index')">ลำดับที่ <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('citizenId')">citizenId <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('EmpName')">EmpName <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('StatusReg')">StatusReg <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('deviceID')">deviceID <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                    <th class="px-4 py-3 cursor-pointer hover:bg-slate-300" onclick="window.app.changeLogSort('Datetime')">Datetime <i data-lucide="chevrons-up-down" class="inline w-3"></i></th>
                                </tr>
                            </thead>
                            <tbody id="log-table-body" class="divide-y divide-slate-100 text-sm font-normal text-slate-700"></tbody>
                        </table>
                    </div>
                    <div class="mt-4 flex flex-col md:flex-row justify-between items-center gap-4">
                        <button onclick="window.app.exportLogsToCSV()" class="px-6 py-2 bg-emerald-600 text-white rounded-lg font-bold text-sm hover:bg-emerald-700 flex items-center gap-2 shadow-lg shadow-emerald-100 transition font-bold">
                            <i data-lucide="download" width="16"></i> Download CSV File
                        </button>
                        <div class="flex gap-2" id="log-pagination-controls"></div>
                    </div>
                </div>
            </div>

            <!-- VIEW 7: QR CODE -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2 font-bold text-2xl text-center">ลงทะเบียน</h2>
                    <div class="bg-white p-4 rounded-xl border border-slate-300 mb-6 mt-6">
                        <img src="./images/QRCodeHR2026.png" alt="QR" class="w-80 h-80 object-contain mx-auto" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://suvittmb.github.io/HRLuckyDraw/hr2026.html'">
                    </div>
                    <button onclick="window.print()" class="px-6 py-2 bg-slate-100 text-slate-600 rounded-lg text-sm border flex items-center gap-2 transition mx-auto font-bold"><i data-lucide="printer" width="16"></i> พิมพ์หน้านี้</button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Confirm Modal -->
    <div id="label-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop font-bold">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[90%] md:max-w-[40%] p-8 text-center transition-all duration-300 font-bold">
            <div id="label-modal-icon" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 font-bold"></div>
            <h3 id="label-modal-title" class="text-xl font-bold mb-2"></h3>
            <p id="label-modal-message" class="text-slate-500 text-sm mb-6"></p>
            <div id="label-modal-input-container" class="hidden mb-4"><input type="text" id="label-modal-input" class="w-full p-3 border rounded-xl text-center font-bold outline-none focus:ring-2"></div>
            <div class="flex gap-3 font-bold">
                <button onclick="window.app.closeLabelModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-slate-500">ยกเลิก</button>
                <button id="label-modal-confirm-btn" class="flex-1 py-3 rounded-xl bg-slate-800 text-white font-bold transition"></button>
            </div>
        </div>
    </div>

    <!-- Edit Reward Modal -->
    <div id="edit-reward-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop font-bold">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-8 text-center font-bold">
            <h3 class="text-xl font-bold mb-2 text-slate-800">แก้ไขของรางวัล</h3>
            <p class="text-sm text-slate-500 mb-4 text-center">ระบุชื่อรางวัลสำหรับฉลากลำดับนี้</p>
            <input type="text" id="edit-reward-input" class="w-full p-3 border rounded-xl text-center font-bold outline-none focus:ring-2 focus:ring-indigo-100 mb-6 font-bold">
            <div class="flex gap-3 font-bold">
                <button onclick="window.app.closeEditRewardModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-slate-500">ยกเลิก</button>
                <button id="edit-reward-confirm-btn" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold">บันทึก</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
const _0x4ec7f2=_0x440f;(function(_0x146053,_0x43cbae){const _0xe67450=_0x440f,_0x1ddbb8=_0x146053();while(!![]){try{const _0x5ac4dc=parseInt(_0xe67450(0x19c))/0x1*(-parseInt(_0xe67450(0x218))/0x2)+-parseInt(_0xe67450(0x15b))/0x3+parseInt(_0xe67450(0x21e))/0x4+parseInt(_0xe67450(0x19a))/0x5+parseInt(_0xe67450(0x261))/0x6*(-parseInt(_0xe67450(0x221))/0x7)+-parseInt(_0xe67450(0x267))/0x8*(-parseInt(_0xe67450(0x19b))/0x9)+-parseInt(_0xe67450(0x1f0))/0xa*(-parseInt(_0xe67450(0x155))/0xb);if(_0x5ac4dc===_0x43cbae)break;else _0x1ddbb8['push'](_0x1ddbb8['shift']());}catch(_0x459b81){_0x1ddbb8['push'](_0x1ddbb8['shift']());}}}(_0x5e1d,0x367c1));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';function _0x5e1d(){const _0x307b43=['StatusReg','\x20transition\x22\x20','-600\x20font-bold','encode','เกิดข้อผิดพลาด','href','citizenId','className','ระบบจัดการฉลาก','indigo-600','bar','body','35790iLzzcJ','DateLogin','</span></td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-400\x20font-normal\x20text-sm\x22>','</td><td\x20class=\x22px-6\x20py-4\x20font-normal\x20font-bold\x22>','files','>Prev</button><span\x20class=\x22text-xs\x20font-bold\x20px-2\x22>Page\x20','card-percent-','Login\x20(DateCheck)','regLine','<div\x20class=\x22','ลบข้อมูลพนักงานทั้งหมด?','recent-activity-list','ผิดพลาด','app','Reward','line','</div><div\x20class=\x22bg-slate-50\x20p-5\x20border-t\x22><div\x20class=\x22flex\x20justify-between\x20items-center\x20mb-1.5\x20font-bold\x22><span\x20class=\x22text-[12px]\x20text-slate-500\x22>สถิติการสุ่มรางวัล</span><span\x20class=\x22text-xs\x20text-slate-700\x22>','ผู้รับรางวัล\x20(EmpName)','DateCheck','trash-2','createObjectURL','map','</td><td\x20class=\x22px-6\x22>','border-green-500','ภาพรวมระบบ','</span>','value','disabled','add','สำเร็จ','สุ่มครั้งที่\x201\x20(DateLogin)','2000','nav-','desc','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-700\x20font-normal\x20font-bold\x22>','error','labels_export_','<div\x20class=\x22text-center\x20text-slate-300\x20py-8\x20text-base\x20font-medium\x22>ไม่มีกิจกรรม</div>','CardNo','querySelectorAll','392308BgXobZ','\x22\x20class=\x22text-red-500\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-red-200\x20rounded-lg\x20','percent','name','\x20p-5\x20rounded-2xl\x20shadow-xl\x20border\x20border-white/10\x20flex\x20flex-col\x20transition-all\x20hover:shadow-2xl\x20hover:scale-[1.02]\x20h-full\x20',')</td><td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-normal\x20text-xs\x22>','1241416jjiNDh','opacity-20\x20cursor-not-allowed','length','672dBAULf','\x20จาก\x20','\x20รายการ','success','style','classList','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20transition\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2218\x22></i></button></td></tr>','window.app.openEditRewardModal(\x27','</span><span\x20class=\x22text-xs\x20text-','group','onload','<div\x20class=\x22p-3\x20bg-white\x20rounded-lg\x20text-sm\x20shadow-sm\x20border\x20border-slate-100\x20mb-1\x20font-bold\x22><b\x20class=\x22text-slate-800\x20font-black\x22>','พิมพ์\x20','all','พิมพ์\x20Delete\x20เพื่อลบรายชื่อพนักงานทั้งหมดออกจากฐานข้อมูล','toLocaleString','trim','registrationChart','push','3000','message','width','users','parse','ยืนยันการสร้างสลากใหม่โดยอ้างอิงจากรายชื่อสมาชิกที่มีอยู่จริงในระบบ','แสดงรายการที่\x20','ttb-register','พิมพ์\x20Reset\x20เพื่อล้างข้อมูลการล็อกอินและผลการสุ่มทั้งหมด','delete','ttb-register.firebaseapp.com','toLowerCase','filter-data-reward','สมาชิกทั้งหมด','<option\x20value=\x22\x22>รางวัลทั้งหมด</option>','/public/data/','bg-slate-700','นำเข้าข้อมูลเรียบร้อย','dashboard','log-total-count','regPie','renderDataSummary','refreshCharts','docs','logs','label','ลบฉลากทั้งหมด?','Delete','emerald','text-white','QR\x20Code\x20ฮั่งเปา','includes','\x20บาท</h4></div><div\x20class=\x22bg-','undefined','target','setAttribute','DateReward','hover:bg-red-50','size','card-total-','4000','total','set','-500\x20text-white\x20p-3\x20text-center\x22><p\x20class=\x22text-[13px]\x20font-black\x20opacity-80\x20tracking-widest\x20uppercase\x22>กลุ่มรางวัล</p><h4\x20class=\x22text-xl\x20font-black\x22>','Agreement','8214yqOazv','</option>','bg-rose-600','filter','สร้างฉลากใหม่?','</td></tr>','112TyvvEC','จัดการข้อมูล','readAsText','รีเซ็ตสำเร็จ','innerHTML','update','subtle','sortBy','manage-total-docs','currentPage','</td><td\x20class=\x22px-4\x20py-3\x20text-slate-500\x20font-normal\x20text-sm\x22>','label-table-body','from','ความถี่การลงทะเบียน','Datetime','Online','type','พิมพ์\x20Delete\x20เพื่อลบประวัติ\x20Log\x20การทำรายการทั้งหมดถาวร','</td><td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20font-normal\x20font-bold\x22>','reduce','padStart','destroy','orange','onclick','renderTable','1:1070273157855:web:5c8120e1df27e233d8676a','ไม่ระบุกลุ่ม','\x27,\x20\x27','toDate','file-name','</span><button\x20onclick=\x22window.app.changeLogPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','used','pagination-controls','Success','ceil','1000','getHours','file-info','<button\x20onclick=\x22window.app.changeLabelPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','\x20font-bold\x22><p\x20class=\x22text-[11px]\x20font-bold\x20uppercase\x20tracking-wider\x20opacity-80\x22>','appendChild','</td><td\x20class=\x22px-4\x20py-3\x20font-bold\x22><span\x20class=\x22px-2\x20py-0.5\x20rounded-full\x20text-[10px]\x20bg-blue-100\x20text-blue-600\x20font-bold\x22>','showToast','ลบฉลากสำเร็จ','rowsPerPage','>ย้อนกลับ</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','label-modal-input','min','</span><button\x20onclick=\x22window.app.changePage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','cards','#10b981','\x20เพื่อยืนยัน','</td><td\x20class=\x22px-6\x20text-right\x22><div\x20class=\x22flex\x20items-center\x20justify-end\x20gap-2\x22><button\x20onclick=\x22','switchTab','orange-600','logSortOrder','getElementById','log-pagination-controls','createIcons','slice','hasOwnProperty','1070273157855','รางวัลโชคชั้นที่\x202','logPage','(ไม่มีของรางวัล)','data','<div\x20class=\x22text-base\x20text-slate-400\x20py-6\x20text-center\x20italic\x22>ยังไม่มีผู้ได้รับรางวัล</div>','index','general-modal','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-50\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22><td\x20class=\x22px-6\x20font-mono\x20text-slate-500\x22>','คำยืนยันไม่ถูกต้อง','ลงทะเบียนแล้ว',':00','import-bar','<option\x20value=\x22\x22>--\x20ทั้งหมด\x20--</option>','\x22\x20class=\x22text-indigo-600\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-indigo-200\x20rounded-lg\x20hover:bg-indigo-50\x20transition\x20','join','.view-section','\x20text-white\x20font-bold\x20hover:opacity-90\x20transition\x20font-bold','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','กำลังดำเนินการ...','</td><td\x20class=\x22px-6\x20text-slate-500\x20font-bold\x22>','w-16\x20h-16\x20rounded-full\x20flex\x20items-center\x20justify-center\x20mx-auto\x20mb-4\x20bg-','selectedDataReward','StatusReward','\x20คน</p></div></div>','</p><h3\x20class=\x22text-3xl\x20font-black\x20mt-1\x20leading-tight\x22>','renderWinnersView','858FhGlkX','flex-1\x20py-3\x20rounded-xl\x20bg-','</td><td\x20class=\x22px-6\x20py-4\x20text-right\x20font-bold\x22><button\x20onclick=\x22window.app.resetMemberData(\x27','%\x22></div></div><p\x20class=\x22text-[12px]\x20text-slate-400\x20mt-2\x20text-right\x20font-bold\x20text-slate-600\x20italic\x22>พนักงานในกลุ่มนี้:\x20','status-text','generateLabels','1288785aJlmxx','Reward\x20(Group)','red','\x20<span\x20class=\x22text-[10px]\x20opacity-70\x20font-normal\x22>ลงทะเบียนแล้ว</span></span><span\x20class=\x22text-lg\x20font-black\x22>','sky','max','remove','showLabelModal','current-time','import-progress','amber','NO.','</div></div><div\x20class=\x22p-4\x20flex-1\x20overflow-y-auto\x20max-h-[350px]\x20custom-scroll-dark\x22><p\x20class=\x22text-[10px]\x20text-slate-400\x20mb-2\x20font-bold\x20uppercase\x20tracking-tighter\x22>รายชื่อผู้ได้รับรางวัลล่าสุด</p>','registration_data_','outsources_logs_','EmpName','-600\x22>','>Next</button>','%\x22></div></div></div>','label-modal-title','label-modal-message','placeholder','edit-reward-confirm-btn','th-TH','edit-reward-input','.csv','replace','แสดง\x20','ข้อมูลลงทะเบียน','visibility','-100\x20text-','digest','result','</span></div>','renderLogTable','>ล้างผลสุ่ม</button></div></td></tr>','data-table-info','asc','stat-checkout','รางวัล\x20(StatusReward)','round','toFixed','winners-container','toast-container','\x20/\x20','ยังไม่มีข้อมูลสมาชิก','innerText','btn-import','\x20h-1.5\x20mt-auto\x20rounded-full\x20overflow-hidden\x20mt-3\x20shadow-inner\x22><div\x20class=\x22bg-white\x20h-1.5\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','rewardname','red-600','สุ่มครั้งที่\x202\x20(DateReward)','clearFileSelection','labelSortOrder','window.app.resetLabelRecord(\x27','label-group-select','click','labels','\x22\x20width=\x2232\x22></i>','ชื่อ-นามสกุล','renderLabelTable','bg-emerald-600','Reset','45300dPRKSX','245421shuuJH','1YwzbgO','\x20p-4\x20rounded-xl\x20shadow-lg\x20toast-enter\x20pointer-events-auto','stat-percent','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-100\x20font-bold\x22><td\x20class=\x22px-6\x20py-4\x20text-slate-600\x20font-normal\x22>','status-indicator','<div\x20class=\x22flex\x20flex-col\x20py-2\x20border-b\x20border-slate-50\x20last:border-0\x20px-2\x20font-bold\x22><span\x20class=\x22text-slate-800\x20text-lg\x22>','ล้างข้อมูลฉลากใบนี้?','sort','check-circle','label-table-info','fill','ลบประวัติ\x20Log\x20เรียบร้อยแล้ว','renderManualHistory','ล้างข้อมูลแล้ว','labelPage','card-used-','toLocaleTimeString','getTime','activeTab','text/csv;charset=utf-8;','Reward\x20(กลุ่ม)','ไม่มีข้อมูลสำหรับดาวน์โหลด','ref','---','searchTerm','-500\x20h-2\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','label-confirm-modal','ยืนยัน','<button\x20onclick=\x22window.app.changePage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','Outsources_card','</span><button\x20onclick=\x22window.app.changeLabelPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','label-modal-confirm-btn','removeChild','forEach','split','bg-indigo-600','winners','bg-white\x20border-l-4\x20','ยังไม่ลงทะเบียน','default-app-id','logSortKey','bg-amber-600','toString','\x20-\x20','hourlyData','</div></div>','artifacts/','label-modal-icon','download','selectedLabelGroup','file-upload','realtimeLineChart','sortOrder','createElement','blue','hidden','deviceID','bg-white/30','</td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-500\x20font-normal\x20text-sm\x20truncate\x20max-w-[120px]\x22\x20title=\x22','Dateworking','closeLabelModal','.json','edit-reward-modal','ลำดับที่','localeCompare','Outsources_log','toLocaleDateString','commit','.nav-item','SHA-256','endsWith','labelSortKey'];_0x5e1d=function(){return _0x307b43;};return _0x5e1d();}import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME='Outsources',CARDS_COLLECTION_NAME=_0x4ec7f2(0x1b9),LOGS_COLLECTION_NAME=_0x4ec7f2(0x1dd),isSandboxEnv=typeof __firebase_config!==_0x4ec7f2(0x255);let firebaseConfig,finalCollectionPath,cardCollectionPath,logCollectionPath;const appId=typeof __app_id!==_0x4ec7f2(0x255)?__app_id:_0x4ec7f2(0x1c3);isSandboxEnv?(firebaseConfig=JSON[_0x4ec7f2(0x238)](__firebase_config),finalCollectionPath=_0x4ec7f2(0x1ca)+appId+_0x4ec7f2(0x243)+TARGET_COLLECTION_NAME,cardCollectionPath=_0x4ec7f2(0x1ca)+appId+_0x4ec7f2(0x243)+CARDS_COLLECTION_NAME,logCollectionPath=_0x4ec7f2(0x1ca)+appId+_0x4ec7f2(0x243)+LOGS_COLLECTION_NAME):(firebaseConfig={'apiKey':_0x4ec7f2(0x2b6),'authDomain':_0x4ec7f2(0x23e),'projectId':_0x4ec7f2(0x23b),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x4ec7f2(0x2a4),'appId':_0x4ec7f2(0x280)},finalCollectionPath=TARGET_COLLECTION_NAME,cardCollectionPath=CARDS_COLLECTION_NAME,logCollectionPath=LOGS_COLLECTION_NAME);function _0x440f(_0x12f3d5,_0xe104ad){_0x12f3d5=_0x12f3d5-0x14d;const _0x5e1da1=_0x5e1d();let _0x440f45=_0x5e1da1[_0x12f3d5];return _0x440f45;}const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'cards':[],'logs':[],'activeTab':_0x4ec7f2(0x246),'searchTerm':'','rowsPerPage':0x32,'currentPage':0x1,'sortBy':'no','sortOrder':'asc','hourlyData':Array(0x18)[_0x4ec7f2(0x1a6)](0x0),'selectedLabelGroup':'','labelPage':0x1,'labelRowsPerPage':0x32,'labelSortKey':_0x4ec7f2(0x216),'labelSortOrder':_0x4ec7f2(0x180),'logPage':0x1,'logRowsPerPage':0x32,'logSortKey':_0x4ec7f2(0x275),'logSortOrder':'desc','selectedDataReward':''},formatDate=_0x363164=>{const _0xa81242=_0x4ec7f2;if(!_0x363164)return'-';try{if(_0x363164[_0xa81242(0x283)]){const _0x2dcb1d=_0x363164[_0xa81242(0x283)]();return _0x2dcb1d[_0xa81242(0x1de)](_0xa81242(0x172))+'\x20'+_0x2dcb1d[_0xa81242(0x1ac)](_0xa81242(0x172));}const _0x5de7e7=new Date(_0x363164);if(!isNaN(_0x5de7e7[_0xa81242(0x1ad)]()))return _0x5de7e7[_0xa81242(0x1de)](_0xa81242(0x172))+'\x20'+_0x5de7e7['toLocaleTimeString']('th-TH');}catch(_0x1dac23){}return _0x363164;},normalizeReward=_0x4186f6=>String(_0x4186f6||'')[_0x4ec7f2(0x175)](/,/g,'')[_0x4ec7f2(0x231)]();async function sha256(_0x3e7aba){const _0x49107f=_0x4ec7f2,_0x211d05=new TextEncoder()[_0x49107f(0x1e7)](_0x3e7aba),_0x37d74f=await crypto[_0x49107f(0x26d)][_0x49107f(0x17a)](_0x49107f(0x1e1),_0x211d05);return Array[_0x49107f(0x273)](new Uint8Array(_0x37d74f))[_0x49107f(0x205)](_0x3d5c3e=>_0x3d5c3e['toString'](0x10)[_0x49107f(0x27b)](0x2,'0'))[_0x49107f(0x2b3)]('');}function chunkArray(_0x29bb44,_0xc89334){const _0x5bee91=_0x4ec7f2,_0x4c7f75=[];for(let _0x194653=0x0;_0x194653<_0x29bb44[_0x5bee91(0x220)];_0x194653+=_0xc89334)_0x4c7f75[_0x5bee91(0x233)](_0x29bb44['slice'](_0x194653,_0x194653+_0xc89334));return _0x4c7f75;}function csvToJson(_0x49f182){const _0x4e1777=_0x4ec7f2,_0x2cb254=_0x49f182['split']('\x0a');if(_0x2cb254[_0x4e1777(0x220)]===0x0)return[];const _0x57dbd5=_0x2cb254[0x0][_0x4e1777(0x1be)](',')[_0x4e1777(0x205)](_0x39dbc4=>_0x39dbc4[_0x4e1777(0x231)]());return _0x2cb254[_0x4e1777(0x2a2)](0x1)[_0x4e1777(0x205)](_0x615aa=>{const _0x4651a4=_0x4e1777,_0x50ea3c=_0x615aa[_0x4651a4(0x1be)](',');if(_0x50ea3c['length']<_0x57dbd5[_0x4651a4(0x220)])return null;return _0x57dbd5[_0x4651a4(0x27a)]((_0x307190,_0x3a6ccf,_0x7128cb)=>{const _0x5023be=_0x4651a4;return _0x307190[_0x3a6ccf]=_0x50ea3c[_0x7128cb]?_0x50ea3c[_0x7128cb][_0x5023be(0x231)]():'',_0x307190;},{});})[_0x4e1777(0x264)](_0x250345=>_0x250345);}window[_0x4ec7f2(0x1fd)]={'showToast':(_0x5d908a,_0x1c864e=_0x4ec7f2(0x224))=>{const _0x5c7d15=_0x4ec7f2,_0x3dfdc6=document[_0x5c7d15(0x29f)](_0x5c7d15(0x186));if(!_0x3dfdc6)return;const _0x46b205=document[_0x5c7d15(0x1d1)]('div');_0x46b205['className']=_0x5c7d15(0x1c1)+(_0x1c864e===_0x5c7d15(0x224)?_0x5c7d15(0x207):'border-red-500')+_0x5c7d15(0x19d),_0x46b205[_0x5c7d15(0x26b)]='<span\x20class=\x22text-sm\x20font-bold\x20text-slate-700\x22>'+_0x5d908a+_0x5c7d15(0x209),_0x3dfdc6[_0x5c7d15(0x28f)](_0x46b205),setTimeout(()=>{const _0x3257ae=_0x5c7d15;_0x46b205[_0x3257ae(0x226)][_0x3257ae(0x20c)]('opacity-0'),setTimeout(()=>_0x46b205[_0x3257ae(0x161)](),0x12c);},0xbb8);},'switchTab':_0x51cef8=>{const _0x29aaa5=_0x4ec7f2;document[_0x29aaa5(0x217)](_0x29aaa5(0x2b4))['forEach'](_0x2489bb=>_0x2489bb[_0x29aaa5(0x226)]['add']('hidden'));const _0x1f6625=document['getElementById']('view-'+_0x51cef8);if(_0x1f6625)_0x1f6625[_0x29aaa5(0x226)]['remove'](_0x29aaa5(0x1d3));document[_0x29aaa5(0x217)](_0x29aaa5(0x1e0))[_0x29aaa5(0x1bd)](_0x46872b=>_0x46872b[_0x29aaa5(0x226)][_0x29aaa5(0x161)](_0x29aaa5(0x244),_0x29aaa5(0x251)));const _0x35464a=document[_0x29aaa5(0x29f)](_0x29aaa5(0x210)+_0x51cef8);if(_0x35464a)_0x35464a[_0x29aaa5(0x226)][_0x29aaa5(0x20c)](_0x29aaa5(0x244),_0x29aaa5(0x251));state[_0x29aaa5(0x1ae)]=_0x51cef8;const _0x190b09={'dashboard':_0x29aaa5(0x208),'data':_0x29aaa5(0x177),'winners':_0x29aaa5(0x2a5),'import':_0x29aaa5(0x268),'labels':_0x29aaa5(0x1ec),'qrcode-in':_0x29aaa5(0x252),'logs':'ตรวจสอบรายการ'};document[_0x29aaa5(0x29f)]('page-title')[_0x29aaa5(0x189)]=_0x190b09[_0x51cef8]||_0x51cef8;if(_0x51cef8==='labels')window['app']['renderLabelTable']();_0x51cef8===_0x29aaa5(0x2a8)&&(window[_0x29aaa5(0x1fd)][_0x29aaa5(0x249)](),window[_0x29aaa5(0x1fd)]['renderTable']());if(_0x51cef8===_0x29aaa5(0x1c0))window['app'][_0x29aaa5(0x154)]();if(_0x51cef8===_0x29aaa5(0x246))window[_0x29aaa5(0x1fd)]['refreshCharts']();if(_0x51cef8===_0x29aaa5(0x24c))window[_0x29aaa5(0x1fd)][_0x29aaa5(0x17d)]();lucide['createIcons']();},'renderDataSummary':()=>{const _0x78426f=_0x4ec7f2,_0x234659=document[_0x78426f(0x29f)]('data-summary-container');if(!_0x234659||state[_0x78426f(0x1ae)]!==_0x78426f(0x2a8))return;const _0x4f455b=state[_0x78426f(0x237)][_0x78426f(0x264)](_0x511c22=>_0x511c22['DateCheck']&&_0x511c22['DateCheck']!=='')['length'],_0x5adeb6=[],_0x47f7b8=[{'bg':'bg-blue-600','bar':_0x78426f(0x1d5),'text':'text-white'},{'bg':_0x78426f(0x1bf),'bar':_0x78426f(0x1d5),'text':'text-white'},{'bg':_0x78426f(0x198),'bar':_0x78426f(0x1d5),'text':_0x78426f(0x251)},{'bg':_0x78426f(0x1c5),'bar':_0x78426f(0x1d5),'text':_0x78426f(0x251)},{'bg':_0x78426f(0x263),'bar':'bg-white/30','text':_0x78426f(0x251)}];_0x5adeb6[_0x78426f(0x233)]({'type':'total','label':_0x78426f(0x241),'total':state[_0x78426f(0x237)][_0x78426f(0x220)],'registered':_0x4f455b,'percent':state['users']['length']>0x0?Math['round'](_0x4f455b/state[_0x78426f(0x237)][_0x78426f(0x220)]*0x64):0x0});const _0x240e7e=[_0x78426f(0x28a),_0x78426f(0x20f),_0x78426f(0x234),_0x78426f(0x25c)];_0x240e7e[_0x78426f(0x1bd)](_0x1352c3=>{const _0x333ea8=_0x78426f,_0x2601be=state[_0x333ea8(0x237)][_0x333ea8(0x264)](_0x3c04f1=>normalizeReward(_0x3c04f1['Reward'])===_0x1352c3),_0x540769=_0x2601be[_0x333ea8(0x264)](_0x1918ca=>_0x1918ca[_0x333ea8(0x202)]&&_0x1918ca[_0x333ea8(0x202)]!=='')['length'];_0x5adeb6[_0x333ea8(0x233)]({'type':_0x333ea8(0x22a),'label':_0x1352c3,'total':_0x2601be['length'],'registered':_0x540769,'percent':_0x2601be[_0x333ea8(0x220)]>0x0?Math['round'](_0x540769/_0x2601be[_0x333ea8(0x220)]*0x64):0x0});}),_0x234659[_0x78426f(0x26b)]=_0x5adeb6[_0x78426f(0x205)]((_0x479309,_0x314be7)=>{const _0x5a618c=_0x78426f,_0x54787f=_0x47f7b8[_0x314be7%_0x47f7b8[_0x5a618c(0x220)]];return _0x5a618c(0x1f9)+_0x54787f['bg']+_0x5a618c(0x21c)+_0x54787f['text']+_0x5a618c(0x28e)+(_0x479309[_0x5a618c(0x277)]===_0x5a618c(0x25d)?_0x479309['label']:'กลุ่มรางวัล\x20'+_0x479309[_0x5a618c(0x24d)])+_0x5a618c(0x153)+_0x479309[_0x5a618c(0x25d)][_0x5a618c(0x230)]()+'\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>ราย</span></h3><div\x20class=\x22mt-2\x20flex\x20justify-between\x20items-baseline\x20font-bold\x22><span\x20class=\x22text-sm\x22>'+_0x479309['registered'][_0x5a618c(0x230)]()+_0x5a618c(0x15e)+_0x479309[_0x5a618c(0x21a)]+'%</span></div><div\x20class=\x22w-full\x20'+_0x54787f[_0x5a618c(0x1ee)]+_0x5a618c(0x18b)+_0x479309[_0x5a618c(0x21a)]+_0x5a618c(0x16d);})[_0x78426f(0x2b3)]('');},'renderWinnersView':()=>{const _0x4236ae=_0x4ec7f2,_0x228cd8=document[_0x4236ae(0x29f)](_0x4236ae(0x185));if(!_0x228cd8||state[_0x4236ae(0x1ae)]!==_0x4236ae(0x1c0))return;const _0x5a8cdb=[_0x4236ae(0x28a),_0x4236ae(0x20f),_0x4236ae(0x234),_0x4236ae(0x25c)],_0x2a8164={'1000':'rose','2000':_0x4236ae(0x250),'3000':_0x4236ae(0x15f),'4000':_0x4236ae(0x165)};_0x228cd8[_0x4236ae(0x26b)]=_0x5a8cdb[_0x4236ae(0x205)](_0x448bf5=>{const _0x5631f7=_0x4236ae,_0x2f2ef8=_0x2a8164[_0x448bf5]||_0x5631f7(0x1d2),_0x26d25d=state[_0x5631f7(0x298)][_0x5631f7(0x264)](_0x3d6283=>normalizeReward(_0x3d6283['Reward'])===_0x448bf5),_0x562c13=state['users']['filter'](_0x4254f5=>normalizeReward(_0x4254f5[_0x5631f7(0x1fe)])===_0x448bf5),_0x17c0b3=[...new Set(_0x26d25d[_0x5631f7(0x205)](_0x3e5d9f=>_0x3e5d9f[_0x5631f7(0x18c)])['filter'](_0x20f40b=>_0x20f40b&&_0x20f40b[_0x5631f7(0x231)]()!==''))],_0x5568d6=_0x26d25d[_0x5631f7(0x264)](_0x38b757=>_0x38b757['Datetime']&&_0x38b757[_0x5631f7(0x275)]!==''),_0xc8f4cc=_0x5568d6[_0x5631f7(0x264)](_0x3f2743=>_0x3f2743[_0x5631f7(0x18c)]&&_0x3f2743[_0x5631f7(0x18c)][_0x5631f7(0x231)]()!==''),_0x3d76a4=_0xc8f4cc[_0x5631f7(0x220)]===0x0?_0x5631f7(0x2a9):_0xc8f4cc[_0x5631f7(0x205)](_0x241a77=>_0x5631f7(0x1a1)+(_0x241a77[_0x5631f7(0x16a)]||_0x5631f7(0x1b3))+_0x5631f7(0x229)+_0x2f2ef8+_0x5631f7(0x16b)+_0x241a77[_0x5631f7(0x18c)]+'</span><span\x20class=\x22text-[9px]\x20text-slate-300\x20font-normal\x20mt-0.5\x22>'+formatDate(_0x241a77[_0x5631f7(0x275)])+_0x5631f7(0x17c))[_0x5631f7(0x2b3)]('');return'<div\x20class=\x22bg-white\x20rounded-[2rem]\x20shadow-sm\x20border\x20border-slate-100\x20flex\x20flex-col\x20overflow-hidden\x20transition-all\x20hover:shadow-lg\x22><div\x20class=\x22bg-'+_0x2f2ef8+_0x5631f7(0x25f)+_0x448bf5+_0x5631f7(0x254)+_0x2f2ef8+'-50\x20p-3\x20border-b\x20text-center\x22><div\x20class=\x22text-sm\x20font-black\x20text-'+_0x2f2ef8+'-700\x22>'+(_0x17c0b3[_0x5631f7(0x220)]>0x0?_0x17c0b3[_0x5631f7(0x2b3)](',\x20'):_0x5631f7(0x2a7))+_0x5631f7(0x167)+_0x3d76a4+_0x5631f7(0x200)+_0x5568d6['length']+_0x5631f7(0x187)+_0x26d25d[_0x5631f7(0x220)]+'\x20ราย</span></div><div\x20class=\x22w-full\x20bg-slate-200\x20rounded-full\x20h-2\x22><div\x20class=\x22bg-'+_0x2f2ef8+_0x5631f7(0x1b5)+(_0x26d25d[_0x5631f7(0x220)]?_0x5568d6[_0x5631f7(0x220)]/_0x26d25d['length']*0x64:0x0)+_0x5631f7(0x158)+_0x562c13[_0x5631f7(0x220)]+_0x5631f7(0x152);})[_0x4236ae(0x2b3)]('');},'renderLabelTable':()=>{const _0xcda6ab=_0x4ec7f2,_0x587a67=document[_0xcda6ab(0x29f)](_0xcda6ab(0x272)),_0x384aa7=document[_0xcda6ab(0x29f)](_0xcda6ab(0x1a5)),_0x49279a=document[_0xcda6ab(0x29f)]('label-pagination-controls');if(!_0x587a67||state[_0xcda6ab(0x1ae)]!==_0xcda6ab(0x194))return;let _0xfbc417=state[_0xcda6ab(0x1cd)]===''?[...state[_0xcda6ab(0x298)]]:state[_0xcda6ab(0x298)][_0xcda6ab(0x264)](_0x4751e7=>normalizeReward(_0x4751e7['Reward'])===state[_0xcda6ab(0x1cd)]);_0xfbc417['sort']((_0x4257a1,_0x43a90d)=>{const _0x38c5f5=_0xcda6ab;let _0x1c49d9=_0x4257a1[state[_0x38c5f5(0x1e3)]],_0x36e501=_0x43a90d[state['labelSortKey']];if(state[_0x38c5f5(0x1e3)]===_0x38c5f5(0x216)||state[_0x38c5f5(0x1e3)]==='Reward'){const _0x1a5093=parseFloat(String(_0x1c49d9||'')['replace'](/,/g,''))||0x0,_0x38023b=parseFloat(String(_0x36e501||'')[_0x38c5f5(0x175)](/,/g,''))||0x0;return state[_0x38c5f5(0x190)]==='asc'?_0x1a5093-_0x38023b:_0x38023b-_0x1a5093;}if(state[_0x38c5f5(0x1e3)]==='Datetime'){const _0x13a1f0=_0x1c49d9?.['toDate']?_0x1c49d9[_0x38c5f5(0x283)]()[_0x38c5f5(0x1ad)]():new Date(_0x1c49d9)[_0x38c5f5(0x1ad)]()||0x0,_0x183a2f=_0x36e501?.['toDate']?_0x36e501[_0x38c5f5(0x283)]()['getTime']():new Date(_0x36e501)[_0x38c5f5(0x1ad)]()||0x0;return state[_0x38c5f5(0x190)]===_0x38c5f5(0x180)?_0x13a1f0-_0x183a2f:_0x183a2f-_0x13a1f0;}return state[_0x38c5f5(0x190)]===_0x38c5f5(0x180)?String(_0x1c49d9||'')[_0x38c5f5(0x1dc)](String(_0x36e501||''),'th',{'numeric':!![]}):String(_0x36e501||'')[_0x38c5f5(0x1dc)](String(_0x1c49d9||''),'th',{'numeric':!![]});});const _0x3e3514=_0xfbc417['length'],_0x28c499=Math[_0xcda6ab(0x289)](_0x3e3514/0x32)||0x1;if(state[_0xcda6ab(0x1aa)]>_0x28c499)state[_0xcda6ab(0x1aa)]=_0x28c499;const _0x1dd51b=_0xfbc417[_0xcda6ab(0x2a2)]((state['labelPage']-0x1)*0x32,state[_0xcda6ab(0x1aa)]*0x32);if(_0x384aa7)_0x384aa7[_0xcda6ab(0x189)]=_0xcda6ab(0x23a)+((state['labelPage']-0x1)*0x32+0x1)+_0xcda6ab(0x1c7)+Math[_0xcda6ab(0x296)](state[_0xcda6ab(0x1aa)]*0x32,_0x3e3514)+'\x20จากทั้งหมด\x20'+_0x3e3514;if(_0x49279a)_0x49279a['innerHTML']=_0xcda6ab(0x28d)+(state[_0xcda6ab(0x1aa)]<=0x1?_0xcda6ab(0x20b):'')+'>Prev</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20'+state[_0xcda6ab(0x1aa)]+'/'+_0x28c499+_0xcda6ab(0x1ba)+(state[_0xcda6ab(0x1aa)]>=_0x28c499?'disabled':'')+_0xcda6ab(0x16c);_0x587a67[_0xcda6ab(0x26b)]=_0x1dd51b[_0xcda6ab(0x205)](_0x5e718e=>{const _0x479944=_0xcda6ab,_0x3d7714=!!_0x5e718e[_0x479944(0x275)],_0x2f1923=(_0x5e718e[_0x479944(0x18c)]||'')[_0x479944(0x175)](/'/g,'\x5c\x27');return _0x479944(0x2ac)+(_0x5e718e['CardNo']||'-')+_0x479944(0x206)+(_0x5e718e['Reward']||'-')+'</td><td\x20class=\x22px-6\x20text-indigo-600\x20font-bold\x20font-bold\x22>'+(_0x5e718e[_0x479944(0x18c)]||'-')+'</td><td\x20class=\x22px-6\x20font-bold\x20text-slate-800\x20font-bold\x22>'+(_0x5e718e['EmpName']||'-')+_0x479944(0x14e)+formatDate(_0x5e718e[_0x479944(0x275)])+_0x479944(0x29b)+(!_0x3d7714?_0x479944(0x228)+_0x5e718e['id']+_0x479944(0x282)+_0x2f1923+'\x27)':'')+_0x479944(0x2b2)+(_0x3d7714?_0x479944(0x21f):'')+'\x22\x20'+(_0x3d7714?_0x479944(0x20b):'')+'>แก้ไข</button><button\x20onclick=\x22'+(!!_0x5e718e[_0x479944(0x275)]?_0x479944(0x191)+_0x5e718e['id']+'\x27)':'')+_0x479944(0x219)+(!_0x5e718e[_0x479944(0x275)]?_0x479944(0x21f):_0x479944(0x259))+_0x479944(0x1e5)+(!_0x5e718e[_0x479944(0x275)]?_0x479944(0x20b):'')+_0x479944(0x17e);})[_0xcda6ab(0x2b3)](''),lucide[_0xcda6ab(0x2a1)]();},'exportDataToCSV':()=>{const _0x5a6a5f=_0x4ec7f2;let _0x789a0e=state[_0x5a6a5f(0x237)][_0x5a6a5f(0x264)](_0x23ab15=>(_0x23ab15[_0x5a6a5f(0x16a)]||'')[_0x5a6a5f(0x23f)]()[_0x5a6a5f(0x253)](state[_0x5a6a5f(0x1b4)])&&(state['selectedDataReward']===''||String(_0x23ab15[_0x5a6a5f(0x1fe)])===String(state[_0x5a6a5f(0x150)])));if(_0x789a0e[_0x5a6a5f(0x220)]===0x0)return window[_0x5a6a5f(0x1fd)][_0x5a6a5f(0x291)](_0x5a6a5f(0x1b1),_0x5a6a5f(0x213));_0x789a0e['sort']((_0x161096,_0x5b4838)=>(parseFloat(_0x161096['no'])||0x0)-(parseFloat(_0x5b4838['no'])||0x0));const _0x19e898=[_0x5a6a5f(0x166),_0x5a6a5f(0x196),_0x5a6a5f(0x15c),_0x5a6a5f(0x1f7),_0x5a6a5f(0x20e),_0x5a6a5f(0x18e),_0x5a6a5f(0x182)],_0x59f3ce=_0x789a0e[_0x5a6a5f(0x205)](_0x11c1d6=>[_0x11c1d6['no']||'',_0x11c1d6['EmpName']||'',_0x11c1d6[_0x5a6a5f(0x1fe)]||'',formatDate(_0x11c1d6['DateCheck']),formatDate(_0x11c1d6[_0x5a6a5f(0x1f1)]),formatDate(_0x11c1d6['DateReward']),_0x11c1d6[_0x5a6a5f(0x151)]||'']),_0x31b078='\ufeff'+[_0x19e898,..._0x59f3ce][_0x5a6a5f(0x205)](_0x590f5c=>_0x590f5c[_0x5a6a5f(0x205)](_0x28984f=>'\x22'+_0x28984f+'\x22')['join'](','))[_0x5a6a5f(0x2b3)]('\x0a'),_0x572b5e=new Blob([_0x31b078],{'type':_0x5a6a5f(0x1af)}),_0x455f9a=document[_0x5a6a5f(0x1d1)]('a'),_0x2cfb3d=URL[_0x5a6a5f(0x204)](_0x572b5e);_0x455f9a[_0x5a6a5f(0x257)](_0x5a6a5f(0x1e9),_0x2cfb3d),_0x455f9a['setAttribute'](_0x5a6a5f(0x1cc),_0x5a6a5f(0x168)+new Date()['getTime']()+_0x5a6a5f(0x174)),_0x455f9a[_0x5a6a5f(0x225)][_0x5a6a5f(0x178)]=_0x5a6a5f(0x1d3),document[_0x5a6a5f(0x1ef)]['appendChild'](_0x455f9a),_0x455f9a[_0x5a6a5f(0x193)](),document[_0x5a6a5f(0x1ef)][_0x5a6a5f(0x1bc)](_0x455f9a);},'exportLabelsToCSV':()=>{const _0x88fe28=_0x4ec7f2;let _0xe69eae=state[_0x88fe28(0x1cd)]===''?[...state[_0x88fe28(0x298)]]:state[_0x88fe28(0x298)][_0x88fe28(0x264)](_0x592a6e=>normalizeReward(_0x592a6e[_0x88fe28(0x1fe)])===state[_0x88fe28(0x1cd)]);if(_0xe69eae[_0x88fe28(0x220)]===0x0)return window['app']['showToast']('ไม่มีข้อมูลสำหรับดาวน์โหลด',_0x88fe28(0x213));_0xe69eae[_0x88fe28(0x1a3)]((_0x480032,_0x244d27)=>(parseInt(_0x480032[_0x88fe28(0x216)])||0x0)-(parseInt(_0x244d27[_0x88fe28(0x216)])||0x0));const _0x213775=[_0x88fe28(0x1db),_0x88fe28(0x1b0),'ของรางวัล\x20(Reward\x20Name)',_0x88fe28(0x201),_0x88fe28(0x275)],_0x139f69=_0xe69eae[_0x88fe28(0x205)](_0x25a57e=>[_0x25a57e[_0x88fe28(0x216)]||'',_0x25a57e[_0x88fe28(0x1fe)]||'',_0x25a57e[_0x88fe28(0x18c)]||'',_0x25a57e[_0x88fe28(0x16a)]||'',formatDate(_0x25a57e[_0x88fe28(0x275)])]),_0x3be89d='\ufeff'+[_0x213775,..._0x139f69][_0x88fe28(0x205)](_0x3b8cc3=>_0x3b8cc3[_0x88fe28(0x205)](_0x2ec657=>'\x22'+_0x2ec657+'\x22')[_0x88fe28(0x2b3)](','))['join']('\x0a'),_0x429aff=new Blob([_0x3be89d],{'type':_0x88fe28(0x1af)}),_0x405703=document[_0x88fe28(0x1d1)]('a'),_0x3d459e=URL[_0x88fe28(0x204)](_0x429aff);_0x405703[_0x88fe28(0x257)]('href',_0x3d459e),_0x405703[_0x88fe28(0x257)](_0x88fe28(0x1cc),_0x88fe28(0x214)+(state[_0x88fe28(0x1cd)]||_0x88fe28(0x22e))+'_'+new Date()[_0x88fe28(0x1ad)]()+_0x88fe28(0x174)),_0x405703[_0x88fe28(0x225)]['visibility']=_0x88fe28(0x1d3),document[_0x88fe28(0x1ef)][_0x88fe28(0x28f)](_0x405703),_0x405703[_0x88fe28(0x193)](),document[_0x88fe28(0x1ef)][_0x88fe28(0x1bc)](_0x405703);},'renderLogTable':()=>{const _0x1b6e94=_0x4ec7f2,_0x45d8ff=document[_0x1b6e94(0x29f)]('log-table-body'),_0x2240d3=document[_0x1b6e94(0x29f)](_0x1b6e94(0x2a0));if(!_0x45d8ff)return;let _0x253a23=[...state[_0x1b6e94(0x24c)]];_0x253a23[_0x1b6e94(0x1a3)]((_0x2ca135,_0x6354b6)=>{const _0x5616b9=_0x1b6e94;let _0x50e825=_0x2ca135[state['logSortKey']],_0x572c2f=_0x6354b6[state['logSortKey']];state['logSortKey']===_0x5616b9(0x275)&&(_0x50e825=_0x2ca135['Datetime']?.['toDate']?_0x2ca135[_0x5616b9(0x275)][_0x5616b9(0x283)]()[_0x5616b9(0x1ad)]():new Date(_0x2ca135[_0x5616b9(0x275)])[_0x5616b9(0x1ad)](),_0x572c2f=_0x6354b6['Datetime']?.[_0x5616b9(0x283)]?_0x6354b6[_0x5616b9(0x275)][_0x5616b9(0x283)]()[_0x5616b9(0x1ad)]():new Date(_0x6354b6[_0x5616b9(0x275)])[_0x5616b9(0x1ad)]());if(state[_0x5616b9(0x1c4)]===_0x5616b9(0x2aa))return state[_0x5616b9(0x29e)]==='asc'?0x1:-0x1;return state[_0x5616b9(0x29e)]===_0x5616b9(0x180)?String(_0x50e825||'')[_0x5616b9(0x1dc)](String(_0x572c2f||''),'th'):String(_0x572c2f||'')[_0x5616b9(0x1dc)](String(_0x50e825||''),'th');});const _0x37522a=_0x253a23[_0x1b6e94(0x220)],_0x371f33=Math[_0x1b6e94(0x289)](_0x37522a/0x32)||0x1;if(state[_0x1b6e94(0x2a6)]>_0x371f33)state['logPage']=_0x371f33;const _0x2fdc74=_0x253a23[_0x1b6e94(0x2a2)]((state[_0x1b6e94(0x2a6)]-0x1)*0x32,state[_0x1b6e94(0x2a6)]*0x32);if(document[_0x1b6e94(0x29f)](_0x1b6e94(0x247)))document[_0x1b6e94(0x29f)](_0x1b6e94(0x247))[_0x1b6e94(0x189)]=_0x37522a[_0x1b6e94(0x230)]();_0x45d8ff[_0x1b6e94(0x26b)]=_0x2fdc74[_0x1b6e94(0x205)]((_0x319ce0,_0x175f9b)=>'<tr\x20class=\x22hover:bg-blue-50/50\x20transition\x20font-bold\x20text-slate-700\x20text-sm\x22><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-slate-400\x20font-normal\x20text-sm\x22>'+((state['logPage']-0x1)*0x32+_0x175f9b+0x1)+_0x1b6e94(0x1d6)+_0x319ce0[_0x1b6e94(0x1ea)]+'\x22>'+(_0x319ce0[_0x1b6e94(0x1ea)]||'-')+'</td><td\x20class=\x22px-4\x20py-3\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22>'+(_0x319ce0['EmpName']||'-')+_0x1b6e94(0x290)+(_0x319ce0[_0x1b6e94(0x1e4)]||_0x1b6e94(0x288))+_0x1b6e94(0x1f2)+(_0x319ce0[_0x1b6e94(0x1d4)]||'-')+_0x1b6e94(0x271)+formatDate(_0x319ce0[_0x1b6e94(0x275)])+_0x1b6e94(0x266))['join']('');if(_0x2240d3)_0x2240d3[_0x1b6e94(0x26b)]='<button\x20onclick=\x22window.app.changeLogPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20'+(state[_0x1b6e94(0x2a6)]<=0x1?_0x1b6e94(0x20b):'')+_0x1b6e94(0x1f5)+state['logPage']+'/'+_0x371f33+_0x1b6e94(0x285)+(state[_0x1b6e94(0x2a6)]>=_0x371f33?_0x1b6e94(0x20b):'')+_0x1b6e94(0x16c);lucide[_0x1b6e94(0x2a1)]();},'openDeleteLogsModal':()=>{const _0x270cf9=_0x4ec7f2;window['app']['showLabelModal'](_0x270cf9(0x24f),'ลบประวัติรายการทั้งหมด?',_0x270cf9(0x278),_0x270cf9(0x15d),async()=>{const _0x151a21=_0x270cf9;try{const _0x445569=await getDocs(collection(db,logCollectionPath)),_0x4ef480=0x190,_0x2d7d27=chunkArray(_0x445569['docs'],_0x4ef480);for(const _0x2aac93 of _0x2d7d27){const _0x37a0b0=writeBatch(db);_0x2aac93[_0x151a21(0x1bd)](_0x480013=>_0x37a0b0[_0x151a21(0x23d)](_0x480013['ref'])),await _0x37a0b0[_0x151a21(0x1df)]();}window[_0x151a21(0x1fd)][_0x151a21(0x291)](_0x151a21(0x1a7));}catch(_0x56e0d0){window['app']['showToast']('เกิดข้อผิดพลาด','error');}});},'changeLogSort':_0x24f804=>{const _0x2f2fa8=_0x4ec7f2;state[_0x2f2fa8(0x29e)]=state['logSortKey']===_0x24f804?state[_0x2f2fa8(0x29e)]===_0x2f2fa8(0x180)?_0x2f2fa8(0x211):_0x2f2fa8(0x180):_0x2f2fa8(0x211),state[_0x2f2fa8(0x1c4)]=_0x24f804,window[_0x2f2fa8(0x1fd)][_0x2f2fa8(0x17d)]();},'exportLogsToCSV':()=>{const _0xd7d7e8=_0x4ec7f2;if(state[_0xd7d7e8(0x24c)][_0xd7d7e8(0x220)]===0x0)return window['app'][_0xd7d7e8(0x291)](_0xd7d7e8(0x1b1),_0xd7d7e8(0x213));const _0x1d21c0=[_0xd7d7e8(0x1db),_0xd7d7e8(0x1ea),_0xd7d7e8(0x16a),_0xd7d7e8(0x1e4),_0xd7d7e8(0x1d4),_0xd7d7e8(0x275)],_0x1d1f40=state['logs']['map']((_0x33153b,_0x324a78)=>[_0x324a78+0x1,'\x09'+(_0x33153b[_0xd7d7e8(0x1ea)]||''),_0x33153b[_0xd7d7e8(0x16a)]||'',_0x33153b[_0xd7d7e8(0x1e4)]||_0xd7d7e8(0x288),_0x33153b['deviceID']||'',formatDate(_0x33153b[_0xd7d7e8(0x275)])]),_0x441456='\ufeff'+[_0x1d21c0,..._0x1d1f40][_0xd7d7e8(0x205)](_0x3d4ee9=>_0x3d4ee9['map'](_0x13fbeb=>'\x22'+_0x13fbeb+'\x22')[_0xd7d7e8(0x2b3)](','))[_0xd7d7e8(0x2b3)]('\x0a'),_0x7d5574=new Blob([_0x441456],{'type':'text/csv;charset=utf-8;'}),_0x137496=document[_0xd7d7e8(0x1d1)]('a'),_0x4c3ed9=URL[_0xd7d7e8(0x204)](_0x7d5574);_0x137496[_0xd7d7e8(0x257)]('href',_0x4c3ed9),_0x137496[_0xd7d7e8(0x257)](_0xd7d7e8(0x1cc),_0xd7d7e8(0x169)+new Date()[_0xd7d7e8(0x1ad)]()+_0xd7d7e8(0x174)),_0x137496[_0xd7d7e8(0x225)][_0xd7d7e8(0x178)]=_0xd7d7e8(0x1d3),document[_0xd7d7e8(0x1ef)][_0xd7d7e8(0x28f)](_0x137496),_0x137496[_0xd7d7e8(0x193)](),document['body'][_0xd7d7e8(0x1bc)](_0x137496);},'onDataRewardFilterChange':_0x2b3558=>{const _0x134db3=_0x4ec7f2;state[_0x134db3(0x150)]=_0x2b3558,state['currentPage']=0x1,window[_0x134db3(0x1fd)][_0x134db3(0x27f)]();},'handleSearch':_0x5b79cb=>{const _0x5b3989=_0x4ec7f2;state['searchTerm']=_0x5b79cb[_0x5b3989(0x23f)](),state[_0x5b3989(0x270)]=0x1,window['app']['renderTable']();},'changeRowsLimit':_0x5916b9=>{const _0x196a1d=_0x4ec7f2;state[_0x196a1d(0x293)]=parseInt(_0x5916b9),state[_0x196a1d(0x270)]=0x1,window[_0x196a1d(0x1fd)][_0x196a1d(0x27f)]();},'changePage':_0x1576b1=>{const _0x59f5a8=_0x4ec7f2;state[_0x59f5a8(0x270)]+=_0x1576b1,window[_0x59f5a8(0x1fd)][_0x59f5a8(0x27f)]();},'changeSort':_0x36fb5e=>{const _0x58a498=_0x4ec7f2;state['sortOrder']=state['sortBy']===_0x36fb5e?state[_0x58a498(0x1d0)]===_0x58a498(0x180)?'desc':_0x58a498(0x180):_0x36fb5e==='no'?'asc':_0x58a498(0x211),state[_0x58a498(0x26e)]=_0x36fb5e,window[_0x58a498(0x1fd)][_0x58a498(0x27f)]();},'renderTable':()=>{const _0x4b7fa9=_0x4ec7f2,_0x1aff4f=document[_0x4b7fa9(0x29f)]('table-body');if(!_0x1aff4f||state['activeTab']!==_0x4b7fa9(0x2a8))return;let _0xf0a57=state[_0x4b7fa9(0x237)]['filter'](_0x97adcf=>(_0x97adcf[_0x4b7fa9(0x16a)]||'')['toLowerCase']()['includes'](state['searchTerm'])&&(state[_0x4b7fa9(0x150)]===''||String(_0x97adcf[_0x4b7fa9(0x1fe)])===String(state[_0x4b7fa9(0x150)])));_0xf0a57['sort']((_0x1cd6f1,_0x5ab123)=>{const _0xf13c55=_0x4b7fa9,_0x32deab=_0x1cd6f1[state[_0xf13c55(0x26e)]],_0x562092=_0x5ab123[state[_0xf13c55(0x26e)]];if(state[_0xf13c55(0x26e)]==='no'||!isNaN(_0x32deab)&&!isNaN(_0x562092)&&_0x32deab!==''&&_0x562092!=='')return state[_0xf13c55(0x1d0)]===_0xf13c55(0x180)?(parseFloat(_0x32deab)||0x0)-(parseFloat(_0x562092)||0x0):(parseFloat(_0x562092)||0x0)-(parseFloat(_0x32deab)||0x0);return state[_0xf13c55(0x1d0)]===_0xf13c55(0x180)?String(_0x32deab||'')[_0xf13c55(0x1dc)](String(_0x562092||''),'th',{'numeric':!![]}):String(_0x562092||'')[_0xf13c55(0x1dc)](String(_0x32deab||''),'th',{'numeric':!![]});});const _0x36f496=_0xf0a57[_0x4b7fa9(0x2a2)]((state[_0x4b7fa9(0x270)]-0x1)*state[_0x4b7fa9(0x293)],state['currentPage']*state[_0x4b7fa9(0x293)]);_0x1aff4f['innerHTML']=_0x36f496['map'](_0x80432b=>_0x4b7fa9(0x19f)+(_0x80432b['no']||'-')+_0x4b7fa9(0x212)+(_0x80432b[_0x4b7fa9(0x16a)]||'-')+_0x4b7fa9(0x1f3)+(_0x80432b[_0x4b7fa9(0x1fe)]||'-')+'</td><td\x20class=\x22px-6\x20py-4\x20text-indigo-400\x20font-normal\x20text-xs\x22>'+formatDate(_0x80432b['DateCheck'])+'<br>('+formatDate(_0x80432b[_0x4b7fa9(0x260)])+_0x4b7fa9(0x21d)+formatDate(_0x80432b[_0x4b7fa9(0x1f1)])+'</td><td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-normal\x20text-xs\x22>'+formatDate(_0x80432b[_0x4b7fa9(0x258)])+_0x4b7fa9(0x279)+(_0x80432b[_0x4b7fa9(0x151)]||'-')+_0x4b7fa9(0x157)+_0x80432b['id']+_0x4b7fa9(0x227))[_0x4b7fa9(0x2b3)]('');if(document['getElementById']('data-table-info'))document[_0x4b7fa9(0x29f)](_0x4b7fa9(0x17f))[_0x4b7fa9(0x189)]=_0x4b7fa9(0x176)+_0x36f496[_0x4b7fa9(0x220)]+_0x4b7fa9(0x222)+_0xf0a57['length']+_0x4b7fa9(0x223);const _0x18d6ab=document[_0x4b7fa9(0x29f)](_0x4b7fa9(0x287));if(_0x18d6ab)_0x18d6ab[_0x4b7fa9(0x26b)]=_0x4b7fa9(0x1b8)+(state[_0x4b7fa9(0x270)]<=0x1?_0x4b7fa9(0x20b):'')+_0x4b7fa9(0x294)+state['currentPage']+_0x4b7fa9(0x297)+(state['currentPage']*state[_0x4b7fa9(0x293)]>=_0xf0a57['length']?_0x4b7fa9(0x20b):'')+'>ถัดไป</button>';lucide[_0x4b7fa9(0x2a1)]();},'openResetModal':()=>{const _0x1353b6=_0x4ec7f2;window['app']['showLabelModal'](_0x1353b6(0x199),'ยืนยัน\x20Reset\x20Register?',_0x1353b6(0x23c),_0x1353b6(0x27d),async()=>{const _0x3a2e4d=_0x1353b6;try{const _0x5335aa=await getDocs(collection(db,finalCollectionPath)),_0x1a1681=writeBatch(db);_0x5335aa[_0x3a2e4d(0x24b)][_0x3a2e4d(0x1bd)](_0x451385=>_0x1a1681[_0x3a2e4d(0x26c)](_0x451385[_0x3a2e4d(0x1b2)],{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''})),await _0x1a1681['commit'](),window[_0x3a2e4d(0x1fd)]['showToast'](_0x3a2e4d(0x26a));}catch(_0x550257){window[_0x3a2e4d(0x1fd)]['showToast'](_0x3a2e4d(0x1e8),_0x3a2e4d(0x213));}});},'openDeleteModal':()=>{const _0x1e300c=_0x4ec7f2;window[_0x1e300c(0x1fd)][_0x1e300c(0x162)](_0x1e300c(0x24f),_0x1e300c(0x1fa),_0x1e300c(0x22f),_0x1e300c(0x15d),async()=>{const _0x22b684=_0x1e300c;try{const _0x262b4b=await getDocs(collection(db,finalCollectionPath)),_0x3ca117=chunkArray(_0x262b4b['docs'],0x190);for(const _0x16cd7b of _0x3ca117){const _0x45fada=writeBatch(db);_0x16cd7b[_0x22b684(0x1bd)](_0xd6c3a8=>_0x45fada['delete'](_0xd6c3a8[_0x22b684(0x1b2)])),await _0x45fada[_0x22b684(0x1df)]();}window['app'][_0x22b684(0x291)]('ลบสำเร็จ');}catch(_0x38a3ba){window[_0x22b684(0x1fd)]['showToast'](_0x22b684(0x1e8),_0x22b684(0x213));}});},'openDeleteLabelsModal':()=>{const _0x2328e0=_0x4ec7f2;window[_0x2328e0(0x1fd)][_0x2328e0(0x162)]('Delete',_0x2328e0(0x24e),'พิมพ์\x20Delete\x20เพื่อลบสลากทั้งหมดออกจากระบบและรีเซ็ตสถานะสุ่ม',_0x2328e0(0x15d),async()=>{const _0x1cbcca=_0x2328e0;try{const _0x4126d0=await getDocs(collection(db,cardCollectionPath)),_0x1a1071=chunkArray(_0x4126d0[_0x1cbcca(0x24b)],0x190);for(const _0x264e33 of _0x1a1071){const _0x54b62b=writeBatch(db);_0x264e33[_0x1cbcca(0x1bd)](_0x266b9f=>_0x54b62b[_0x1cbcca(0x23d)](_0x266b9f[_0x1cbcca(0x1b2)])),await _0x54b62b[_0x1cbcca(0x1df)]();}const _0x4a97b3=await getDocs(collection(db,finalCollectionPath)),_0x1de7d5=chunkArray(_0x4a97b3[_0x1cbcca(0x24b)],0x190);for(const _0x524929 of _0x1de7d5){const _0x50430a=writeBatch(db);_0x524929[_0x1cbcca(0x1bd)](_0x3319fe=>_0x50430a[_0x1cbcca(0x26c)](_0x3319fe['ref'],{'DateLogin':'','StatusReward':'','DateReward':'','CardNo':''})),await _0x50430a[_0x1cbcca(0x1df)]();}window[_0x1cbcca(0x1fd)][_0x1cbcca(0x291)](_0x1cbcca(0x292));}catch(_0x475f62){window[_0x1cbcca(0x1fd)][_0x1cbcca(0x291)](_0x1cbcca(0x1e8),_0x1cbcca(0x213));}});},'openCreateLabelsModal':()=>{const _0x4c3e15=_0x4ec7f2;window[_0x4c3e15(0x1fd)][_0x4c3e15(0x162)]('Confirm',_0x4c3e15(0x265),_0x4c3e15(0x239),'indigo',async()=>{const _0x1beb30=_0x4c3e15;try{await window['app'][_0x1beb30(0x15a)](),window[_0x1beb30(0x1fd)]['showToast']('สร้างฉลากใหม่สำเร็จ');}catch(_0x3672a0){window[_0x1beb30(0x1fd)][_0x1beb30(0x291)]('เกิดข้อผิดพลาด','error');}});},'generateLabels':async()=>{const _0x550783=_0x4ec7f2;if(state['users']['length']===0x0){window[_0x550783(0x1fd)]['showToast'](_0x550783(0x188),_0x550783(0x213));return;}const _0xe34e1=await getDocs(collection(db,cardCollectionPath)),_0x13013c=chunkArray(_0xe34e1[_0x550783(0x24b)],0x190);for(const _0x2179f7 of _0x13013c){const _0x313c1e=writeBatch(db);_0x2179f7[_0x550783(0x1bd)](_0x1c6bb9=>_0x313c1e[_0x550783(0x23d)](_0x1c6bb9[_0x550783(0x1b2)])),await _0x313c1e[_0x550783(0x1df)]();}const _0x5a3672={},_0x394f3b=state[_0x550783(0x237)]['map'](_0x5beb47=>{const _0x7761da=_0x550783,_0x4c2530=String(_0x5beb47[_0x7761da(0x1fe)]||_0x7761da(0x281))[_0x7761da(0x231)]();return _0x5a3672[_0x4c2530]=(_0x5a3672[_0x4c2530]||0x0)+0x1,{'Reward':_0x4c2530,'rewardname':'','CardNo':String(_0x5a3672[_0x4c2530]),'EmpName':'','citizenId':'','Datetime':''};}),_0xa862f1=chunkArray(_0x394f3b,0x190);for(const _0x6305d8 of _0xa862f1){const _0x2f60b2=writeBatch(db);_0x6305d8[_0x550783(0x1bd)](_0x2f7847=>_0x2f60b2[_0x550783(0x25e)](doc(collection(db,cardCollectionPath)),_0x2f7847)),await _0x2f60b2[_0x550783(0x1df)]();}},'handleFileSelect':_0x462950=>{const _0x506c75=_0x4ec7f2,_0x107942=_0x462950[_0x506c75(0x256)][_0x506c75(0x1f4)][0x0];_0x107942&&(document[_0x506c75(0x29f)](_0x506c75(0x284))[_0x506c75(0x189)]=_0x107942[_0x506c75(0x21b)],document[_0x506c75(0x29f)](_0x506c75(0x28c))[_0x506c75(0x226)][_0x506c75(0x161)](_0x506c75(0x1d3)),document['getElementById']('btn-import')[_0x506c75(0x20b)]=![]);},'clearFileSelection':()=>{const _0x511148=_0x4ec7f2;document[_0x511148(0x29f)]('file-upload')[_0x511148(0x20a)]='',document[_0x511148(0x29f)](_0x511148(0x28c))[_0x511148(0x226)][_0x511148(0x20c)](_0x511148(0x1d3)),document['getElementById'](_0x511148(0x18a))[_0x511148(0x20b)]=!![];},'processImport':async()=>{const _0x4b6239=_0x4ec7f2,_0xf97d03=document['getElementById'](_0x4b6239(0x1ce)),_0x140bce=_0xf97d03[_0x4b6239(0x1f4)][0x0];if(!_0x140bce)return;document['getElementById'](_0x4b6239(0x164))['classList'][_0x4b6239(0x161)](_0x4b6239(0x1d3));const _0x1115cb=document['getElementById'](_0x4b6239(0x2b0)),_0x3949c5=new FileReader();_0x3949c5[_0x4b6239(0x22b)]=async _0x257b6e=>{const _0x279d87=_0x4b6239;try{const _0x1658eb=_0x140bce['name'][_0x279d87(0x1e2)](_0x279d87(0x1d9))?JSON['parse'](_0x257b6e[_0x279d87(0x256)][_0x279d87(0x17b)]):csvToJson(_0x257b6e[_0x279d87(0x256)][_0x279d87(0x17b)]),_0x52829a=_0x1658eb[_0x279d87(0x220)];for(let _0x3dd8da=0x0;_0x3dd8da<_0x52829a;_0x3dd8da+=0x190){const _0x9e95b8=_0x1658eb[_0x279d87(0x2a2)](_0x3dd8da,_0x3dd8da+0x190),_0x3d5724=writeBatch(db),_0x20f373=_0x9e95b8[_0x279d87(0x205)](async(_0x475739,_0x30cff1)=>{const _0x46391e=_0x279d87,_0x8dd520=String(_0x475739[_0x46391e(0x1ea)]||'')[_0x46391e(0x175)](/-/g,'')[_0x46391e(0x231)](),_0x3e1ab0=await sha256(_0x8dd520),_0x2605a9=(_0x3dd8da+_0x30cff1+0x1)[_0x46391e(0x1c6)](),_0x5bd0e5=doc(collection(db,finalCollectionPath));_0x3d5724['set'](_0x5bd0e5,{'citizenId':_0x3e1ab0,'no':_0x2605a9,'EmpName':_0x475739[_0x46391e(0x16a)]||_0x475739['Name']||'','Dateworking':_0x475739[_0x46391e(0x1d7)]||'','Datework':_0x475739['Datework']||'','Reward':_0x475739[_0x46391e(0x1fe)]||'','DateLogin':_0x475739['DateLogin']||'','StatusReward':_0x475739[_0x46391e(0x151)]||'','DateReward':_0x475739['DateReward']||'','DateCheck':_0x475739['DateCheck']||'','importedAt':serverTimestamp()});});await Promise['all'](_0x20f373),await _0x3d5724[_0x279d87(0x1df)](),_0x1115cb[_0x279d87(0x225)][_0x279d87(0x236)]=Math[_0x279d87(0x296)](0x64,Math[_0x279d87(0x183)]((_0x3dd8da+_0x9e95b8[_0x279d87(0x220)])/_0x52829a*0x64))+'%';}window[_0x279d87(0x1fd)][_0x279d87(0x291)](_0x279d87(0x245)),window['app'][_0x279d87(0x18f)]();}catch(_0xad038b){window[_0x279d87(0x1fd)][_0x279d87(0x291)]('ผิดพลาด:\x20'+_0xad038b[_0x279d87(0x235)],_0x279d87(0x213));}finally{document[_0x279d87(0x29f)](_0x279d87(0x164))['classList'][_0x279d87(0x20c)]('hidden');}},_0x3949c5[_0x4b6239(0x269)](_0x140bce);},'refreshCharts':()=>{const _0x2a74c2=_0x4ec7f2,_0x496ee4=document[_0x2a74c2(0x29f)](_0x2a74c2(0x232));if(_0x496ee4){if(window[_0x2a74c2(0x248)])window[_0x2a74c2(0x248)][_0x2a74c2(0x27c)]();const _0x2a62ee=state[_0x2a74c2(0x237)][_0x2a74c2(0x264)](_0x581da5=>_0x581da5[_0x2a74c2(0x202)]&&_0x581da5[_0x2a74c2(0x202)]!=='')[_0x2a74c2(0x220)];window[_0x2a74c2(0x248)]=new Chart(_0x496ee4,{'type':'doughnut','data':{'labels':[_0x2a74c2(0x2ae),_0x2a74c2(0x1c2)],'datasets':[{'data':[_0x2a62ee,Math[_0x2a74c2(0x160)](0x0,state['users'][_0x2a74c2(0x220)]-_0x2a62ee)],'backgroundColor':[_0x2a74c2(0x299),'#e2e8f0']}]},'options':{'maintainAspectRatio':![]}});}const _0x2491f0=document['getElementById'](_0x2a74c2(0x1cf));if(_0x2491f0){if(window[_0x2a74c2(0x1f8)])window[_0x2a74c2(0x1f8)]['destroy']();window[_0x2a74c2(0x1f8)]=new Chart(_0x2491f0,{'type':_0x2a74c2(0x1ff),'data':{'labels':Array[_0x2a74c2(0x273)]({'length':0x18},(_0x6009e8,_0x57664d)=>_0x57664d+_0x2a74c2(0x2af)),'datasets':[{'label':_0x2a74c2(0x274),'data':state[_0x2a74c2(0x1c8)],'borderColor':'#3b82f6','fill':!![],'tension':0.4}]},'options':{'maintainAspectRatio':![]}});}window[_0x2a74c2(0x1fd)][_0x2a74c2(0x1a8)]();},'renderManualHistory':()=>{const _0x43ee04=_0x4ec7f2,_0x6d0102=document[_0x43ee04(0x29f)](_0x43ee04(0x1fb)),_0x5919cd=state['users']['filter'](_0x575f8c=>_0x575f8c[_0x43ee04(0x202)]&&_0x575f8c['DateCheck']!=='')[_0x43ee04(0x1a3)]((_0x4da0e7,_0x48180f)=>{const _0x9eb1e8=_0x43ee04,_0x593561=_0x4da0e7[_0x9eb1e8(0x202)]?.['toDate']?_0x4da0e7['DateCheck']['toDate']():new Date(_0x4da0e7[_0x9eb1e8(0x202)]),_0x1436e3=_0x48180f[_0x9eb1e8(0x202)]?.[_0x9eb1e8(0x283)]?_0x48180f[_0x9eb1e8(0x202)][_0x9eb1e8(0x283)]():new Date(_0x48180f[_0x9eb1e8(0x202)]);return _0x1436e3-_0x593561;})[_0x43ee04(0x2a2)](0x0,0xa);_0x6d0102&&(_0x6d0102[_0x43ee04(0x26b)]=_0x5919cd[_0x43ee04(0x220)]?_0x5919cd[_0x43ee04(0x205)](_0x523fdf=>_0x43ee04(0x22c)+(_0x523fdf[_0x43ee04(0x16a)]||'Unknown')+'</b>\x20<span\x20class=\x22text-slate-400\x20font-normal\x20mx-1\x22>กลุ่ม:</span>\x20<span\x20class=\x22text-indigo-600\x22>'+(_0x523fdf[_0x43ee04(0x1fe)]||'-')+'</span>\x20<div\x20class=\x22text-[10px]\x20text-slate-400\x20mt-1\x20font-normal\x22>ลงทะเบียนเมื่อ\x20'+formatDate(_0x523fdf['DateCheck'])+_0x43ee04(0x1c9))[_0x43ee04(0x2b3)](''):_0x43ee04(0x215));},'resetMemberData':async _0x4bbc40=>{const _0x4dfdf4=_0x4ec7f2;if(!confirm('ยืนยันการล้างข้อมูล?'))return;try{await updateDoc(doc(db,finalCollectionPath,_0x4bbc40),{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':'','AgreeDate':'','Agreement':''}),window[_0x4dfdf4(0x1fd)][_0x4dfdf4(0x291)]('สำเร็จ');}catch(_0x65f3a9){window[_0x4dfdf4(0x1fd)][_0x4dfdf4(0x291)](_0x4dfdf4(0x1fc),_0x4dfdf4(0x213));}},'resetLabelRecord':async _0x1a1043=>{const _0x3fe3a7=_0x4ec7f2;if(!confirm(_0x3fe3a7(0x1a2)))return;try{await updateDoc(doc(db,cardCollectionPath,_0x1a1043),{'EmpName':'','Datetime':'','citizenId':''}),window[_0x3fe3a7(0x1fd)]['showToast'](_0x3fe3a7(0x1a9));}catch(_0x2580a6){window[_0x3fe3a7(0x1fd)][_0x3fe3a7(0x291)](_0x3fe3a7(0x1fc),_0x3fe3a7(0x213));}},'openEditRewardModal':(_0x1719d9,_0x4fdaa3)=>{const _0x156399=_0x4ec7f2;document['getElementById']('edit-reward-input')[_0x156399(0x20a)]=_0x4fdaa3,document[_0x156399(0x29f)](_0x156399(0x171))[_0x156399(0x27e)]=async()=>{const _0x32c125=_0x156399,_0x385ae3=document[_0x32c125(0x29f)](_0x32c125(0x173))[_0x32c125(0x20a)][_0x32c125(0x231)]();try{await updateDoc(doc(db,cardCollectionPath,_0x1719d9),{'rewardname':_0x385ae3}),window['app'][_0x32c125(0x291)](_0x32c125(0x20d)),window[_0x32c125(0x1fd)]['closeEditRewardModal']();}catch(_0xd79ad0){window[_0x32c125(0x1fd)][_0x32c125(0x291)](_0x32c125(0x1fc),_0x32c125(0x213));}},document[_0x156399(0x29f)]('edit-reward-modal')[_0x156399(0x226)][_0x156399(0x161)](_0x156399(0x1d3));},'showLabelModal':(_0xfd5f,_0x19e7a7,_0x3ca3e7,_0xce650d,_0x4c1cce)=>{const _0x491e11=_0x4ec7f2,_0x1ac0d5=document[_0x491e11(0x29f)](_0x491e11(0x1b6)),_0x9baaf1=document[_0x491e11(0x29f)](_0x491e11(0x1bb));document['getElementById'](_0x491e11(0x16e))[_0x491e11(0x189)]=_0x19e7a7,document['getElementById'](_0x491e11(0x16f))[_0x491e11(0x189)]=_0x3ca3e7;const _0x520560=document[_0x491e11(0x29f)](_0x491e11(0x1cb));_0x520560[_0x491e11(0x1eb)]=_0x491e11(0x14f)+_0xce650d+_0x491e11(0x179)+_0xce650d+_0x491e11(0x1e6),_0x520560[_0x491e11(0x26b)]='<i\x20data-lucide=\x22'+(_0xfd5f==='Delete'?_0x491e11(0x203):_0x491e11(0x1a4))+_0x491e11(0x195),document[_0x491e11(0x29f)]('label-modal-input-container')[_0x491e11(0x226)][_0x491e11(0x161)](_0x491e11(0x1d3));const _0xeca21=document[_0x491e11(0x29f)](_0x491e11(0x295));_0xeca21[_0x491e11(0x20a)]='',_0xeca21[_0x491e11(0x170)]=_0x491e11(0x22d)+_0xfd5f+_0x491e11(0x29a),_0x9baaf1['className']=_0x491e11(0x156)+(_0xce650d===_0x491e11(0x15d)?_0x491e11(0x18d):_0xce650d==='orange'?_0x491e11(0x29d):_0x491e11(0x1ed))+_0x491e11(0x2b5),_0x9baaf1[_0x491e11(0x189)]=_0x491e11(0x1b7),_0x9baaf1[_0x491e11(0x27e)]=async()=>{const _0x3ac58c=_0x491e11;if(_0xeca21['value']!==_0xfd5f)return window[_0x3ac58c(0x1fd)][_0x3ac58c(0x291)](_0x3ac58c(0x2ad),_0x3ac58c(0x213));_0x9baaf1[_0x3ac58c(0x20b)]=!![],_0x9baaf1['innerText']=_0x3ac58c(0x14d);try{await _0x4c1cce(),window[_0x3ac58c(0x1fd)][_0x3ac58c(0x1d8)]();}finally{_0x9baaf1[_0x3ac58c(0x20b)]=![],_0x9baaf1[_0x3ac58c(0x189)]=_0x3ac58c(0x1b7);}},_0x1ac0d5[_0x491e11(0x226)][_0x491e11(0x161)]('hidden'),lucide['createIcons']();},'closeLabelModal':()=>document['getElementById'](_0x4ec7f2(0x1b6))[_0x4ec7f2(0x226)][_0x4ec7f2(0x20c)](_0x4ec7f2(0x1d3)),'closeEditRewardModal':()=>document[_0x4ec7f2(0x29f)](_0x4ec7f2(0x1da))['classList'][_0x4ec7f2(0x20c)](_0x4ec7f2(0x1d3)),'closeGeneralModal':()=>document[_0x4ec7f2(0x29f)](_0x4ec7f2(0x2ab))[_0x4ec7f2(0x226)][_0x4ec7f2(0x20c)](_0x4ec7f2(0x1d3)),'onLabelGroupChange':_0x1b63cf=>{const _0x43d7aa=_0x4ec7f2;state[_0x43d7aa(0x1cd)]=normalizeReward(_0x1b63cf),state[_0x43d7aa(0x1aa)]=0x1,window[_0x43d7aa(0x1fd)][_0x43d7aa(0x197)]();},'onDataRewardFilterChange':_0x4c351b=>{const _0x54e689=_0x4ec7f2;state[_0x54e689(0x150)]=_0x4c351b,state['currentPage']=0x1,window[_0x54e689(0x1fd)][_0x54e689(0x27f)]();},'handleSearch':_0x2274f4=>{const _0x57e30c=_0x4ec7f2;state[_0x57e30c(0x1b4)]=_0x2274f4[_0x57e30c(0x23f)](),state[_0x57e30c(0x270)]=0x1,window['app'][_0x57e30c(0x27f)]();},'changeRowsLimit':_0x535fa7=>{const _0x25c97b=_0x4ec7f2;state[_0x25c97b(0x293)]=parseInt(_0x535fa7),state[_0x25c97b(0x270)]=0x1,window[_0x25c97b(0x1fd)][_0x25c97b(0x27f)]();},'changePage':_0x2deee1=>{const _0x179b62=_0x4ec7f2;state[_0x179b62(0x270)]+=_0x2deee1,window[_0x179b62(0x1fd)]['renderTable']();},'changeSort':_0xc98692=>{const _0x4947df=_0x4ec7f2;state[_0x4947df(0x1d0)]=state[_0x4947df(0x26e)]===_0xc98692?state[_0x4947df(0x1d0)]==='asc'?_0x4947df(0x211):_0x4947df(0x180):_0xc98692==='no'?'asc':_0x4947df(0x211),state[_0x4947df(0x26e)]=_0xc98692,window[_0x4947df(0x1fd)][_0x4947df(0x27f)]();},'changeLogPage':_0x2f7634=>{const _0x2e7a4e=_0x4ec7f2;state['logPage']+=_0x2f7634,window[_0x2e7a4e(0x1fd)][_0x2e7a4e(0x17d)]();},'changeLogSort':_0x1e2701=>{const _0x443add=_0x4ec7f2;state['logSortOrder']=state[_0x443add(0x1c4)]===_0x1e2701?state['logSortOrder']===_0x443add(0x180)?'desc':'asc':_0x443add(0x211),state[_0x443add(0x1c4)]=_0x1e2701,window[_0x443add(0x1fd)]['renderLogTable']();}};async function init(){const _0x5715d8=_0x4ec7f2;try{if(typeof __initial_auth_token!==_0x5715d8(0x255)&&__initial_auth_token)await signInWithCustomToken(auth,__initial_auth_token);else await signInAnonymously(auth);document['getElementById'](_0x5715d8(0x1a0))?.[_0x5715d8(0x226)][_0x5715d8(0x175)]('bg-red-500','bg-green-500');if(document[_0x5715d8(0x29f)](_0x5715d8(0x159)))document[_0x5715d8(0x29f)]('status-text')[_0x5715d8(0x189)]=_0x5715d8(0x276);onSnapshot(collection(db,finalCollectionPath),_0x35b333=>{const _0x2c4517=_0x5715d8;state[_0x2c4517(0x237)]=_0x35b333['docs'][_0x2c4517(0x205)](_0x199bff=>({'id':_0x199bff['id'],..._0x199bff[_0x2c4517(0x2a8)]()})),document[_0x2c4517(0x29f)]('stat-checkin')['innerText']=_0x35b333[_0x2c4517(0x25a)][_0x2c4517(0x230)](),document[_0x2c4517(0x29f)](_0x2c4517(0x26f))[_0x2c4517(0x189)]=_0x35b333[_0x2c4517(0x25a)][_0x2c4517(0x230)]();const _0xbad6b7=state[_0x2c4517(0x237)][_0x2c4517(0x264)](_0x35bd42=>_0x35bd42[_0x2c4517(0x202)]&&_0x35bd42[_0x2c4517(0x202)]!=='')[_0x2c4517(0x220)];document['getElementById'](_0x2c4517(0x181))['innerText']=_0xbad6b7['toLocaleString'](),document['getElementById'](_0x2c4517(0x19e))['innerText']=_0x35b333[_0x2c4517(0x25a)]>0x0?(_0xbad6b7/_0x35b333[_0x2c4517(0x25a)]*0x64)[_0x2c4517(0x184)](0x1)+'%':'0%';const _0x52dff1=Array(0x18)[_0x2c4517(0x1a6)](0x0);state[_0x2c4517(0x237)][_0x2c4517(0x1bd)](_0x442c36=>{const _0x540f34=_0x2c4517;if(_0x442c36[_0x540f34(0x202)])try{let _0x3e8f7a=_0x442c36[_0x540f34(0x202)][_0x540f34(0x283)]?_0x442c36['DateCheck']['toDate']():new Date(_0x442c36[_0x540f34(0x202)]);if(!isNaN(_0x3e8f7a['getTime']()))_0x52dff1[_0x3e8f7a[_0x540f34(0x28b)]()]++;}catch(_0x40e4fa){}}),state['hourlyData']=_0x52dff1;const _0x3fb0bf=[...new Set(state[_0x2c4517(0x237)][_0x2c4517(0x205)](_0x5703e8=>String(_0x5703e8['Reward']||'')[_0x2c4517(0x231)]())[_0x2c4517(0x264)](_0x2b1339=>_0x2b1339!==''))][_0x2c4517(0x1a3)]((_0x481ef9,_0x2c9004)=>_0x481ef9[_0x2c4517(0x1dc)](_0x2c9004)),_0x2a8a1a=document[_0x2c4517(0x29f)](_0x2c4517(0x240));if(_0x2a8a1a){const _0x27f51d=_0x2a8a1a[_0x2c4517(0x20a)];_0x2a8a1a['innerHTML']=_0x2c4517(0x2b1)+_0x3fb0bf[_0x2c4517(0x205)](_0x1c4092=>'<option\x20value=\x22'+_0x1c4092+'\x22>'+_0x1c4092+_0x2c4517(0x262))['join'](''),_0x2a8a1a[_0x2c4517(0x20a)]=_0x3fb0bf[_0x2c4517(0x253)](_0x27f51d)?_0x27f51d:'';}window['app'][_0x2c4517(0x27f)](),window[_0x2c4517(0x1fd)]['renderDataSummary'](),window[_0x2c4517(0x1fd)][_0x2c4517(0x154)](),window[_0x2c4517(0x1fd)][_0x2c4517(0x24a)]();}),onSnapshot(collection(db,cardCollectionPath),_0x5cd377=>{const _0x330d4d=_0x5715d8;state[_0x330d4d(0x298)]=_0x5cd377[_0x330d4d(0x24b)][_0x330d4d(0x205)](_0x76298=>({'id':_0x76298['id'],..._0x76298[_0x330d4d(0x2a8)]()}));const _0x14483f=[_0x330d4d(0x28a),_0x330d4d(0x20f),_0x330d4d(0x234),_0x330d4d(0x25c)],_0x590594={};_0x14483f[_0x330d4d(0x1bd)](_0x5bd973=>_0x590594[_0x5bd973]={'total':0x0,'used':0x0}),state['cards'][_0x330d4d(0x1bd)](_0x38bcaf=>{const _0x518504=_0x330d4d,_0x2edf20=normalizeReward(_0x38bcaf[_0x518504(0x1fe)]);if(_0x590594[_0x518504(0x2a3)](_0x2edf20)){_0x590594[_0x2edf20][_0x518504(0x25d)]++;if(_0x38bcaf[_0x518504(0x275)]&&_0x38bcaf[_0x518504(0x275)]!=='')_0x590594[_0x2edf20][_0x518504(0x286)]++;}}),_0x14483f[_0x330d4d(0x1bd)](_0x23ad1a=>{const _0x26df38=_0x330d4d,_0x3e61bc=_0x590594[_0x23ad1a],_0x1d431f=_0x3e61bc[_0x26df38(0x25d)]>0x0?Math[_0x26df38(0x183)](_0x3e61bc['used']/_0x3e61bc[_0x26df38(0x25d)]*0x64):0x0;if(document[_0x26df38(0x29f)](_0x26df38(0x25b)+_0x23ad1a))document[_0x26df38(0x29f)](_0x26df38(0x25b)+_0x23ad1a)[_0x26df38(0x26b)]=_0x3e61bc[_0x26df38(0x25d)]['toLocaleString']()+'\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>สลาก</span>';if(document[_0x26df38(0x29f)](_0x26df38(0x1ab)+_0x23ad1a))document[_0x26df38(0x29f)](_0x26df38(0x1ab)+_0x23ad1a)[_0x26df38(0x189)]=_0x3e61bc[_0x26df38(0x286)][_0x26df38(0x230)]();if(document[_0x26df38(0x29f)](_0x26df38(0x1f6)+_0x23ad1a))document['getElementById'](_0x26df38(0x1f6)+_0x23ad1a)[_0x26df38(0x189)]=_0x1d431f+'%';if(document[_0x26df38(0x29f)]('card-bar-'+_0x23ad1a))document['getElementById']('card-bar-'+_0x23ad1a)[_0x26df38(0x225)][_0x26df38(0x236)]=_0x1d431f+'%';});const _0x3d9b55=[...new Set(state[_0x330d4d(0x298)][_0x330d4d(0x205)](_0x5d0a7f=>normalizeReward(_0x5d0a7f[_0x330d4d(0x1fe)])))]['filter'](_0x54665f=>_0x54665f!=='')[_0x330d4d(0x1a3)]((_0x3c92ff,_0x527929)=>_0x3c92ff['localeCompare'](_0x527929,undefined,{'numeric':!![]})),_0x39f743=document['getElementById'](_0x330d4d(0x192));if(_0x39f743){const _0x35e617=_0x39f743[_0x330d4d(0x20a)];_0x39f743[_0x330d4d(0x26b)]=_0x330d4d(0x242)+_0x3d9b55[_0x330d4d(0x205)](_0x29bfc5=>'<option\x20value=\x22'+_0x29bfc5+'\x22>'+_0x29bfc5+_0x330d4d(0x262))[_0x330d4d(0x2b3)](''),_0x39f743[_0x330d4d(0x20a)]=_0x35e617||'';}window[_0x330d4d(0x1fd)]['renderLabelTable'](),window['app'][_0x330d4d(0x154)]();}),onSnapshot(collection(db,logCollectionPath),_0x21b71b=>{const _0x554073=_0x5715d8;state[_0x554073(0x24c)]=_0x21b71b[_0x554073(0x24b)][_0x554073(0x205)](_0x1d8173=>({'id':_0x1d8173['id'],..._0x1d8173[_0x554073(0x2a8)]()}));if(state[_0x554073(0x1ae)]===_0x554073(0x24c))window[_0x554073(0x1fd)][_0x554073(0x17d)]();}),window[_0x5715d8(0x1fd)][_0x5715d8(0x29c)](state['activeTab']);}catch(_0x4eae3d){console[_0x5715d8(0x213)](_0x4eae3d);}}setInterval(()=>{const _0x2a991e=_0x4ec7f2;if(document[_0x2a991e(0x29f)](_0x2a991e(0x163)))document[_0x2a991e(0x29f)]('current-time')[_0x2a991e(0x189)]=new Date()[_0x2a991e(0x1ac)](_0x2a991e(0x172));},0x3e8),init();//const _0x45c2bc=_0x50b8;(function(_0x37f484,_0x9c3862){const _0x1a49c6=_0x50b8,_0xe278cd=_0x37f484();while(!![]){try{const _0x406bb0=parseInt(_0x1a49c6(0x1af))/0x1*(parseInt(_0x1a49c6(0x12b))/0x2)+parseInt(_0x1a49c6(0x1b6))/0x3+-parseInt(_0x1a49c6(0x1b1))/0x4*(parseInt(_0x1a49c6(0x164))/0x5)+parseInt(_0x1a49c6(0x137))/0x6*(parseInt(_0x1a49c6(0x129))/0x7)+-parseInt(_0x1a49c6(0xf4))/0x8*(-parseInt(_0x1a49c6(0x12a))/0x9)+-parseInt(_0x1a49c6(0x16c))/0xa*(-parseInt(_0x1a49c6(0xac))/0xb)+-parseInt(_0x1a49c6(0xec))/0xc;if(_0x406bb0===_0x9c3862)break;else _0xe278cd['push'](_0xe278cd['shift']());}catch(_0x46060b){_0xe278cd['push'](_0xe278cd['shift']());}}}(_0x4181,0xa36b4));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x45c2bc(0xf1),CARDS_COLLECTION_NAME=_0x45c2bc(0x1c0),LOGS_COLLECTION_NAME=_0x45c2bc(0x185),isSandboxEnv=typeof __firebase_config!==_0x45c2bc(0x133);let firebaseConfig,finalCollectionPath,cardCollectionPath,logCollectionPath;const appId=typeof __app_id!==_0x45c2bc(0x133)?__app_id:_0x45c2bc(0xd2);isSandboxEnv?(firebaseConfig=JSON['parse'](__firebase_config),finalCollectionPath='artifacts/'+appId+_0x45c2bc(0x17b)+TARGET_COLLECTION_NAME,cardCollectionPath=_0x45c2bc(0xb7)+appId+_0x45c2bc(0x17b)+CARDS_COLLECTION_NAME,logCollectionPath=_0x45c2bc(0xb7)+appId+_0x45c2bc(0x17b)+LOGS_COLLECTION_NAME):(firebaseConfig={'apiKey':_0x45c2bc(0x8b),'authDomain':'ttb-register.firebaseapp.com','projectId':_0x45c2bc(0x154),'storageBucket':_0x45c2bc(0x189),'messagingSenderId':_0x45c2bc(0x147),'appId':_0x45c2bc(0xd3)},finalCollectionPath=TARGET_COLLECTION_NAME,cardCollectionPath=CARDS_COLLECTION_NAME,logCollectionPath=LOGS_COLLECTION_NAME);const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'cards':[],'logs':[],'activeTab':_0x45c2bc(0xd6),'searchTerm':'','rowsPerPage':0x32,'currentPage':0x1,'sortBy':'no','sortOrder':_0x45c2bc(0x10c),'hourlyData':Array(0x18)['fill'](0x0),'selectedLabelGroup':'','labelPage':0x1,'labelRowsPerPage':0x32,'labelSortKey':_0x45c2bc(0x1db),'labelSortOrder':_0x45c2bc(0x10c),'logPage':0x1,'logRowsPerPage':0x32,'logSortKey':_0x45c2bc(0x1dc),'logSortOrder':_0x45c2bc(0x1d7),'selectedDataReward':''},formatDate=_0x53abf0=>{const _0x4d04af=_0x45c2bc;if(!_0x53abf0)return'-';try{if(_0x53abf0[_0x4d04af(0xd0)]){const _0x448bf5=_0x53abf0[_0x4d04af(0xd0)]();return _0x448bf5[_0x4d04af(0x186)](_0x4d04af(0x139))+'\x20'+_0x448bf5[_0x4d04af(0x194)]('th-TH');}const _0x3b2432=new Date(_0x53abf0);if(!isNaN(_0x3b2432[_0x4d04af(0x116)]()))return _0x3b2432[_0x4d04af(0x186)]('th-TH')+'\x20'+_0x3b2432[_0x4d04af(0x194)]('th-TH');}catch(_0x56a014){}return _0x53abf0;},normalizeReward=_0x24c27b=>String(_0x24c27b||'')[_0x45c2bc(0x173)](/,/g,'')[_0x45c2bc(0xf7)]();async function sha256(_0x31fbf0){const _0x289434=_0x45c2bc,_0x3d8de7=new TextEncoder()['encode'](_0x31fbf0),_0x16a1de=await crypto['subtle']['digest'](_0x289434(0xa2),_0x3d8de7);return Array['from'](new Uint8Array(_0x16a1de))[_0x289434(0xcd)](_0x551ac6=>_0x551ac6[_0x289434(0x1bd)](0x10)[_0x289434(0x144)](0x2,'0'))[_0x289434(0xc6)]('');}function _0x50b8(_0x2a1bff,_0x231dd7){_0x2a1bff=_0x2a1bff-0x7f;const _0x418139=_0x4181();let _0x50b8d8=_0x418139[_0x2a1bff];return _0x50b8d8;}function chunkArray(_0x2a2fec,_0x1751f8){const _0x53f8b9=_0x45c2bc,_0x56f9c5=[];for(let _0x74ae6f=0x0;_0x74ae6f<_0x2a2fec['length'];_0x74ae6f+=_0x1751f8)_0x56f9c5[_0x53f8b9(0xbb)](_0x2a2fec[_0x53f8b9(0x1cc)](_0x74ae6f,_0x74ae6f+_0x1751f8));return _0x56f9c5;}function csvToJson(_0x12f239){const _0x3a5c26=_0x45c2bc,_0x407017=_0x12f239[_0x3a5c26(0x16e)]('\x0a');if(_0x407017[_0x3a5c26(0x184)]===0x0)return[];const _0x20ea44=_0x407017[0x0][_0x3a5c26(0x16e)](',')[_0x3a5c26(0xcd)](_0x31b068=>_0x31b068[_0x3a5c26(0xf7)]());return _0x407017[_0x3a5c26(0x1cc)](0x1)[_0x3a5c26(0xcd)](_0x1c6df0=>{const _0x2864be=_0x3a5c26,_0xa25c63=_0x1c6df0[_0x2864be(0x16e)](',');if(_0xa25c63[_0x2864be(0x184)]<_0x20ea44['length'])return null;return _0x20ea44[_0x2864be(0x84)]((_0x27241f,_0x3be1a7,_0x2d909c)=>{const _0x118ac4=_0x2864be;return _0x27241f[_0x3be1a7]=_0xa25c63[_0x2d909c]?_0xa25c63[_0x2d909c][_0x118ac4(0xf7)]():'',_0x27241f;},{});})['filter'](_0x9e2a6d=>_0x9e2a6d);}window[_0x45c2bc(0xc9)]={'showToast':(_0x596063,_0x95642d='success')=>{const _0x4eea38=_0x45c2bc,_0x3ac639=document[_0x4eea38(0xf9)](_0x4eea38(0x18d));if(!_0x3ac639)return;const _0x3d8f66=document['createElement'](_0x4eea38(0xae));_0x3d8f66['className']=_0x4eea38(0x174)+(_0x95642d===_0x4eea38(0x160)?'border-green-500':'border-red-500')+'\x20p-4\x20rounded-xl\x20shadow-lg\x20toast-enter\x20pointer-events-auto',_0x3d8f66['innerHTML']=_0x4eea38(0x1c9)+_0x596063+_0x4eea38(0x95),_0x3ac639[_0x4eea38(0x170)](_0x3d8f66),setTimeout(()=>{const _0x38508e=_0x4eea38;_0x3d8f66['classList'][_0x38508e(0x11c)](_0x38508e(0x103)),setTimeout(()=>_0x3d8f66['remove'](),0x12c);},0xbb8);},'switchTab':_0xe41e56=>{const _0x1589b7=_0x45c2bc;document[_0x1589b7(0xd5)](_0x1589b7(0x195))[_0x1589b7(0x127)](_0x1fc47c=>_0x1fc47c['classList'][_0x1589b7(0x11c)](_0x1589b7(0x14d)));const _0x5037e2=document[_0x1589b7(0xf9)]('view-'+_0xe41e56);if(_0x5037e2)_0x5037e2[_0x1589b7(0x1da)][_0x1589b7(0x93)](_0x1589b7(0x14d));document['querySelectorAll']('.nav-item')[_0x1589b7(0x127)](_0x5abb32=>_0x5abb32[_0x1589b7(0x1da)][_0x1589b7(0x93)](_0x1589b7(0x12f),_0x1589b7(0x1a6)));const _0x11aef4=document[_0x1589b7(0xf9)]('nav-'+_0xe41e56);if(_0x11aef4)_0x11aef4['classList'][_0x1589b7(0x11c)]('bg-slate-700',_0x1589b7(0x1a6));state[_0x1589b7(0x13f)]=_0xe41e56;const _0x2dc095={'dashboard':_0x1589b7(0xcf),'data':_0x1589b7(0x11d),'winners':'รางวัลโชคชั้นที่\x202','import':_0x1589b7(0x9f),'labels':_0x1589b7(0x167),'qrcode-in':'QR\x20Code\x20ฮั่งเปา','logs':_0x1589b7(0x1d5)};document[_0x1589b7(0xf9)]('page-title')[_0x1589b7(0x85)]=_0x2dc095[_0xe41e56]||_0xe41e56;if(_0xe41e56==='labels')window[_0x1589b7(0xc9)]['renderLabelTable']();_0xe41e56===_0x1589b7(0xfd)&&(window[_0x1589b7(0xc9)][_0x1589b7(0x141)](),window[_0x1589b7(0xc9)][_0x1589b7(0x114)]());if(_0xe41e56===_0x1589b7(0xa5))window[_0x1589b7(0xc9)]['renderWinnersView']();if(_0xe41e56==='dashboard')window['app'][_0x1589b7(0x140)]();if(_0xe41e56===_0x1589b7(0xce))window[_0x1589b7(0xc9)][_0x1589b7(0xbc)]();lucide[_0x1589b7(0x18a)]();},'renderDataSummary':()=>{const _0x254f60=_0x45c2bc,_0x3358cd=document[_0x254f60(0xf9)](_0x254f60(0x111));if(!_0x3358cd||state['activeTab']!==_0x254f60(0xfd))return;const _0x3c3ddd=state[_0x254f60(0x1cd)][_0x254f60(0x1d4)](_0x3e75a8=>_0x3e75a8['DateCheck']&&_0x3e75a8[_0x254f60(0x12d)]!=='')['length'],_0x3dcff1=[],_0x5414cc=[{'bg':'bg-blue-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':'bg-indigo-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':'bg-emerald-600','bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':_0x254f60(0x1a9),'bar':_0x254f60(0x11b),'text':_0x254f60(0x1a6)},{'bg':_0x254f60(0x188),'bar':'bg-white/30','text':_0x254f60(0x1a6)}];_0x3dcff1[_0x254f60(0xbb)]({'type':_0x254f60(0x91),'label':_0x254f60(0x151),'total':state[_0x254f60(0x1cd)]['length'],'registered':_0x3c3ddd,'percent':state[_0x254f60(0x1cd)][_0x254f60(0x184)]>0x0?Math[_0x254f60(0x1e0)](_0x3c3ddd/state[_0x254f60(0x1cd)][_0x254f60(0x184)]*0x64):0x0});const _0x3b4a40=[_0x254f60(0x17f),_0x254f60(0x1e1),_0x254f60(0xaf),_0x254f60(0x14f)];_0x3b4a40[_0x254f60(0x127)](_0x40ff14=>{const _0x350698=_0x254f60,_0x1ce9e5=state[_0x350698(0x1cd)][_0x350698(0x1d4)](_0x1bd1d4=>normalizeReward(_0x1bd1d4['Reward'])===_0x40ff14),_0x37f0e7=_0x1ce9e5[_0x350698(0x1d4)](_0x1451cd=>_0x1451cd[_0x350698(0x12d)]&&_0x1451cd[_0x350698(0x12d)]!=='')[_0x350698(0x184)];_0x3dcff1[_0x350698(0xbb)]({'type':_0x350698(0x193),'label':_0x40ff14,'total':_0x1ce9e5['length'],'registered':_0x37f0e7,'percent':_0x1ce9e5[_0x350698(0x184)]>0x0?Math['round'](_0x37f0e7/_0x1ce9e5['length']*0x64):0x0});}),_0x3358cd[_0x254f60(0x126)]=_0x3dcff1[_0x254f60(0xcd)]((_0xf1f13b,_0x4b5172)=>{const _0x4ff327=_0x254f60,_0x4d72a1=_0x5414cc[_0x4b5172%_0x5414cc['length']];return _0x4ff327(0x128)+_0x4d72a1['bg']+_0x4ff327(0x1b7)+_0x4d72a1['text']+_0x4ff327(0x14c)+(_0xf1f13b[_0x4ff327(0xde)]===_0x4ff327(0x91)?_0xf1f13b[_0x4ff327(0x100)]:'กลุ่มรางวัล\x20'+_0xf1f13b[_0x4ff327(0x100)])+_0x4ff327(0x17d)+_0xf1f13b[_0x4ff327(0x91)][_0x4ff327(0x199)]()+_0x4ff327(0x8f)+_0xf1f13b[_0x4ff327(0x1d0)][_0x4ff327(0x199)]()+_0x4ff327(0xf6)+_0xf1f13b[_0x4ff327(0xfa)]+_0x4ff327(0x19e)+_0x4d72a1[_0x4ff327(0xf8)]+_0x4ff327(0x1ca)+_0xf1f13b[_0x4ff327(0xfa)]+'%\x22></div></div></div>';})[_0x254f60(0xc6)]('');},'renderWinnersView':()=>{const _0x47f4c1=_0x45c2bc,_0x4db8b1=document[_0x47f4c1(0xf9)](_0x47f4c1(0xf3));if(!_0x4db8b1||state[_0x47f4c1(0x13f)]!==_0x47f4c1(0xa5))return;const _0x28de35=['1000',_0x47f4c1(0x1e1),_0x47f4c1(0xaf),_0x47f4c1(0x14f)],_0x35bf8a={'1000':'rose','2000':'emerald','3000':'sky','4000':_0x47f4c1(0x1ad)};_0x4db8b1[_0x47f4c1(0x126)]=_0x28de35['map'](_0x9571a8=>{const _0x2480f2=_0x47f4c1,_0x1eba23=_0x35bf8a[_0x9571a8]||_0x2480f2(0x16d),_0x5e435a=state[_0x2480f2(0xd8)][_0x2480f2(0x1d4)](_0x18de39=>normalizeReward(_0x18de39[_0x2480f2(0x8c)])===_0x9571a8),_0x4edee1=state[_0x2480f2(0x1cd)][_0x2480f2(0x1d4)](_0xd98beb=>normalizeReward(_0xd98beb['Reward'])===_0x9571a8),_0x55248f=[...new Set(_0x5e435a[_0x2480f2(0xcd)](_0x17f267=>_0x17f267[_0x2480f2(0x1ac)])['filter'](_0x1fd0c2=>_0x1fd0c2&&_0x1fd0c2[_0x2480f2(0xf7)]()!==''))],_0x5b1312=_0x5e435a[_0x2480f2(0x1d4)](_0x15a07e=>_0x15a07e[_0x2480f2(0x1dc)]&&_0x15a07e[_0x2480f2(0x1dc)]!==''),_0x13bb16=_0x5b1312[_0x2480f2(0x1d4)](_0x1a1bb6=>_0x1a1bb6[_0x2480f2(0x1ac)]&&_0x1a1bb6[_0x2480f2(0x1ac)][_0x2480f2(0xf7)]()!==''),_0xeca3dc=_0x13bb16[_0x2480f2(0x184)]===0x0?_0x2480f2(0x132):_0x13bb16['map'](_0x277dac=>_0x2480f2(0x1b2)+(_0x277dac['EmpName']||_0x2480f2(0x1c6))+_0x2480f2(0xfb)+_0x1eba23+_0x2480f2(0xe4)+_0x277dac[_0x2480f2(0x1ac)]+_0x2480f2(0x1d1)+formatDate(_0x277dac[_0x2480f2(0x1dc)])+_0x2480f2(0xba))[_0x2480f2(0xc6)]('');return'<div\x20class=\x22bg-white\x20rounded-[2rem]\x20shadow-sm\x20border\x20border-slate-100\x20flex\x20flex-col\x20overflow-hidden\x20transition-all\x20hover:shadow-lg\x22><div\x20class=\x22bg-'+_0x1eba23+_0x2480f2(0xe5)+_0x9571a8+_0x2480f2(0x1ba)+_0x1eba23+'-50\x20p-3\x20border-b\x20text-center\x22><div\x20class=\x22text-sm\x20font-black\x20text-'+_0x1eba23+_0x2480f2(0x1c7)+(_0x55248f[_0x2480f2(0x184)]>0x0?_0x55248f[_0x2480f2(0xc6)](',\x20'):'(ไม่มีของรางวัล)')+_0x2480f2(0x187)+_0xeca3dc+_0x2480f2(0x119)+_0x5b1312[_0x2480f2(0x184)]+_0x2480f2(0xb9)+_0x5e435a[_0x2480f2(0x184)]+_0x2480f2(0x136)+_0x1eba23+_0x2480f2(0x1c1)+(_0x5e435a[_0x2480f2(0x184)]?_0x5b1312['length']/_0x5e435a[_0x2480f2(0x184)]*0x64:0x0)+_0x2480f2(0xf5)+_0x4edee1[_0x2480f2(0x184)]+_0x2480f2(0xea);})[_0x47f4c1(0xc6)]('');},'renderLabelTable':()=>{const _0x1f1f36=_0x45c2bc,_0x14ec0b=document[_0x1f1f36(0xf9)]('label-table-body'),_0x3ad008=document[_0x1f1f36(0xf9)]('label-table-info'),_0x96171e=document[_0x1f1f36(0xf9)](_0x1f1f36(0x169));if(!_0x14ec0b||state[_0x1f1f36(0x13f)]!=='labels')return;let _0x37a6f7=state['selectedLabelGroup']===''?[...state[_0x1f1f36(0xd8)]]:state[_0x1f1f36(0xd8)]['filter'](_0x3d9be0=>normalizeReward(_0x3d9be0[_0x1f1f36(0x8c)])===state[_0x1f1f36(0x105)]);_0x37a6f7[_0x1f1f36(0x161)]((_0x1bf8a7,_0x119c51)=>{const _0x5c63ee=_0x1f1f36;let _0x48417d=_0x1bf8a7[state[_0x5c63ee(0xff)]],_0x4c9755=_0x119c51[state['labelSortKey']];if(state['labelSortKey']===_0x5c63ee(0x1db)||state[_0x5c63ee(0xff)]===_0x5c63ee(0x8c)){const _0x17e60d=parseFloat(String(_0x48417d||'')[_0x5c63ee(0x173)](/,/g,''))||0x0,_0x5950dc=parseFloat(String(_0x4c9755||'')[_0x5c63ee(0x173)](/,/g,''))||0x0;return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?_0x17e60d-_0x5950dc:_0x5950dc-_0x17e60d;}if(state[_0x5c63ee(0xff)]==='Datetime'){const _0x1ee140=_0x48417d?.[_0x5c63ee(0xd0)]?_0x48417d[_0x5c63ee(0xd0)]()['getTime']():new Date(_0x48417d)['getTime']()||0x0,_0x42cad1=_0x4c9755?.['toDate']?_0x4c9755['toDate']()[_0x5c63ee(0x116)]():new Date(_0x4c9755)['getTime']()||0x0;return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?_0x1ee140-_0x42cad1:_0x42cad1-_0x1ee140;}return state[_0x5c63ee(0x1de)]===_0x5c63ee(0x10c)?String(_0x48417d||'')[_0x5c63ee(0x1a3)](String(_0x4c9755||''),'th',{'numeric':!![]}):String(_0x4c9755||'')[_0x5c63ee(0x1a3)](String(_0x48417d||''),'th',{'numeric':!![]});});const _0x149789=_0x37a6f7[_0x1f1f36(0x184)],_0xb4f301=Math['ceil'](_0x149789/0x32)||0x1;if(state[_0x1f1f36(0x134)]>_0xb4f301)state[_0x1f1f36(0x134)]=_0xb4f301;const _0x4a3bdb=_0x37a6f7[_0x1f1f36(0x1cc)]((state[_0x1f1f36(0x134)]-0x1)*0x32,state[_0x1f1f36(0x134)]*0x32);if(_0x3ad008)_0x3ad008[_0x1f1f36(0x85)]=_0x1f1f36(0xd4)+((state[_0x1f1f36(0x134)]-0x1)*0x32+0x1)+_0x1f1f36(0x7f)+Math['min'](state[_0x1f1f36(0x134)]*0x32,_0x149789)+_0x1f1f36(0x1a5)+_0x149789;if(_0x96171e)_0x96171e[_0x1f1f36(0x126)]='<button\x20onclick=\x22window.app.changeLabelPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20'+(state[_0x1f1f36(0x134)]<=0x1?'disabled':'')+_0x1f1f36(0x1ce)+state['labelPage']+'/'+_0xb4f301+_0x1f1f36(0xe3)+(state[_0x1f1f36(0x134)]>=_0xb4f301?_0x1f1f36(0x15b):'')+'>Next</button>';_0x14ec0b[_0x1f1f36(0x126)]=_0x4a3bdb[_0x1f1f36(0xcd)](_0x106a6e=>{const _0x595268=_0x1f1f36,_0x51e40e=!!_0x106a6e[_0x595268(0x1dc)],_0x5d0124=(_0x106a6e['rewardname']||'')[_0x595268(0x173)](/'/g,'\x5c\x27');return _0x595268(0x9e)+(_0x106a6e[_0x595268(0x1db)]||'-')+'</td><td\x20class=\x22px-6\x22>'+(_0x106a6e[_0x595268(0x8c)]||'-')+_0x595268(0x197)+(_0x106a6e[_0x595268(0x1ac)]||'-')+'</td><td\x20class=\x22px-6\x20font-bold\x20text-slate-800\x20font-bold\x22>'+(_0x106a6e[_0x595268(0xee)]||'-')+_0x595268(0xb4)+formatDate(_0x106a6e[_0x595268(0x1dc)])+'</td><td\x20class=\x22px-6\x20text-right\x22><div\x20class=\x22flex\x20items-center\x20justify-end\x20gap-2\x22><button\x20onclick=\x22'+(!_0x51e40e?_0x595268(0xa0)+_0x106a6e['id']+_0x595268(0x172)+_0x5d0124+'\x27)':'')+'\x22\x20class=\x22text-indigo-600\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-indigo-200\x20rounded-lg\x20hover:bg-indigo-50\x20transition\x20'+(_0x51e40e?'opacity-20\x20cursor-not-allowed':'')+'\x22\x20'+(_0x51e40e?_0x595268(0x15b):'')+_0x595268(0x1c3)+(!!_0x106a6e[_0x595268(0x1dc)]?_0x595268(0xc0)+_0x106a6e['id']+'\x27)':'')+_0x595268(0x102)+(!_0x106a6e[_0x595268(0x1dc)]?'opacity-20\x20cursor-not-allowed':'hover:bg-red-50')+'\x20transition\x22\x20'+(!_0x106a6e['Datetime']?_0x595268(0x15b):'')+_0x595268(0xc1);})['join'](''),lucide['createIcons']();},'exportDataToCSV':()=>{const _0x59c547=_0x45c2bc;let _0x18fd06=state[_0x59c547(0x1cd)][_0x59c547(0x1d4)](_0x1e74f2=>(_0x1e74f2[_0x59c547(0xee)]||'')[_0x59c547(0x1a8)]()[_0x59c547(0x165)](state['searchTerm'])&&(state[_0x59c547(0x15d)]===''||String(_0x1e74f2[_0x59c547(0x8c)])===String(state[_0x59c547(0x15d)])));if(_0x18fd06[_0x59c547(0x184)]===0x0)return window[_0x59c547(0xc9)]['showToast']('ไม่มีข้อมูลสำหรับดาวน์โหลด',_0x59c547(0x179));_0x18fd06[_0x59c547(0x161)]((_0x23d5e1,_0x19513c)=>(parseFloat(_0x23d5e1['no'])||0x0)-(parseFloat(_0x19513c['no'])||0x0));const _0x21bfe1=[_0x59c547(0x1bc),'ชื่อ-นามสกุล',_0x59c547(0x107),'Login\x20(DateCheck)',_0x59c547(0xc5),_0x59c547(0x131),_0x59c547(0xd9)],_0x422143=_0x18fd06[_0x59c547(0xcd)](_0x3220c0=>[_0x3220c0['no']||'',_0x3220c0[_0x59c547(0xee)]||'',_0x3220c0[_0x59c547(0x8c)]||'',formatDate(_0x3220c0['DateCheck']),formatDate(_0x3220c0[_0x59c547(0x8d)]),formatDate(_0x3220c0['DateReward']),_0x3220c0['StatusReward']||'']),_0x13b155='\ufeff'+[_0x21bfe1,..._0x422143]['map'](_0xc10b83=>_0xc10b83[_0x59c547(0xcd)](_0x340230=>'\x22'+_0x340230+'\x22')[_0x59c547(0xc6)](','))[_0x59c547(0xc6)]('\x0a'),_0x37c49a=new Blob([_0x13b155],{'type':'text/csv;charset=utf-8;'}),_0x11b9ad=document[_0x59c547(0xe0)]('a'),_0x507070=URL[_0x59c547(0x157)](_0x37c49a);_0x11b9ad[_0x59c547(0x118)](_0x59c547(0x10f),_0x507070),_0x11b9ad['setAttribute'](_0x59c547(0x18e),'registration_data_'+new Date()[_0x59c547(0x116)]()+_0x59c547(0x192)),_0x11b9ad[_0x59c547(0x196)]['visibility']=_0x59c547(0x14d),document[_0x59c547(0x1b0)][_0x59c547(0x170)](_0x11b9ad),_0x11b9ad[_0x59c547(0x90)](),document[_0x59c547(0x1b0)][_0x59c547(0x10a)](_0x11b9ad);},'exportLabelsToCSV':()=>{const _0x37d3ee=_0x45c2bc;let _0xc1f516=state[_0x37d3ee(0x105)]===''?[...state[_0x37d3ee(0xd8)]]:state['cards'][_0x37d3ee(0x1d4)](_0x386670=>normalizeReward(_0x386670[_0x37d3ee(0x8c)])===state['selectedLabelGroup']);if(_0xc1f516[_0x37d3ee(0x184)]===0x0)return window[_0x37d3ee(0xc9)]['showToast'](_0x37d3ee(0xdd),_0x37d3ee(0x179));_0xc1f516[_0x37d3ee(0x161)]((_0x5cea97,_0x3b7d68)=>(parseInt(_0x5cea97[_0x37d3ee(0x1db)])||0x0)-(parseInt(_0x3b7d68['CardNo'])||0x0));const _0xf857c6=['ลำดับที่','Reward\x20(กลุ่ม)',_0x37d3ee(0xdb),_0x37d3ee(0x198),_0x37d3ee(0x1dc)],_0x2456c4=_0xc1f516[_0x37d3ee(0xcd)](_0x30a5b6=>[_0x30a5b6[_0x37d3ee(0x1db)]||'',_0x30a5b6[_0x37d3ee(0x8c)]||'',_0x30a5b6['rewardname']||'',_0x30a5b6[_0x37d3ee(0xee)]||'',formatDate(_0x30a5b6[_0x37d3ee(0x1dc)])]),_0x3c9626='\ufeff'+[_0xf857c6,..._0x2456c4][_0x37d3ee(0xcd)](_0x2c9035=>_0x2c9035[_0x37d3ee(0xcd)](_0x3f0ef8=>'\x22'+_0x3f0ef8+'\x22')[_0x37d3ee(0xc6)](','))[_0x37d3ee(0xc6)]('\x0a'),_0x2b95f9=new Blob([_0x3c9626],{'type':_0x37d3ee(0x16f)}),_0x3a2815=document[_0x37d3ee(0xe0)]('a'),_0x8490ba=URL[_0x37d3ee(0x157)](_0x2b95f9);_0x3a2815[_0x37d3ee(0x118)](_0x37d3ee(0x10f),_0x8490ba),_0x3a2815[_0x37d3ee(0x118)](_0x37d3ee(0x18e),_0x37d3ee(0x1b4)+(state[_0x37d3ee(0x105)]||_0x37d3ee(0x15a))+'_'+new Date()[_0x37d3ee(0x116)]()+'.csv'),_0x3a2815[_0x37d3ee(0x196)][_0x37d3ee(0x112)]=_0x37d3ee(0x14d),document[_0x37d3ee(0x1b0)][_0x37d3ee(0x170)](_0x3a2815),_0x3a2815['click'](),document['body'][_0x37d3ee(0x10a)](_0x3a2815);},'renderLogTable':()=>{const _0x10b7cd=_0x45c2bc,_0x1e44f5=document[_0x10b7cd(0xf9)](_0x10b7cd(0x1a4)),_0xe4cf90=document[_0x10b7cd(0xf9)](_0x10b7cd(0x19d));if(!_0x1e44f5)return;let _0x7e5319=[...state['logs']];_0x7e5319[_0x10b7cd(0x161)]((_0x57d20b,_0x1cf1cb)=>{const _0x5247b8=_0x10b7cd;let _0x52fb21=_0x57d20b[state[_0x5247b8(0x9c)]],_0x1625b1=_0x1cf1cb[state[_0x5247b8(0x9c)]];state['logSortKey']===_0x5247b8(0x1dc)&&(_0x52fb21=_0x57d20b['Datetime']?.['toDate']?_0x57d20b['Datetime'][_0x5247b8(0xd0)]()[_0x5247b8(0x116)]():new Date(_0x57d20b['Datetime'])[_0x5247b8(0x116)](),_0x1625b1=_0x1cf1cb[_0x5247b8(0x1dc)]?.[_0x5247b8(0xd0)]?_0x1cf1cb[_0x5247b8(0x1dc)]['toDate']()[_0x5247b8(0x116)]():new Date(_0x1cf1cb[_0x5247b8(0x1dc)])[_0x5247b8(0x116)]());if(state['logSortKey']===_0x5247b8(0xa3))return state[_0x5247b8(0xf0)]===_0x5247b8(0x10c)?0x1:-0x1;return state[_0x5247b8(0xf0)]===_0x5247b8(0x10c)?String(_0x52fb21||'')['localeCompare'](String(_0x1625b1||''),'th'):String(_0x1625b1||'')[_0x5247b8(0x1a3)](String(_0x52fb21||''),'th');});const _0xed82af=_0x7e5319[_0x10b7cd(0x184)],_0x461ac3=Math[_0x10b7cd(0x120)](_0xed82af/0x32)||0x1;if(state[_0x10b7cd(0xdf)]>_0x461ac3)state['logPage']=_0x461ac3;const _0x5e6c6=_0x7e5319[_0x10b7cd(0x1cc)]((state[_0x10b7cd(0xdf)]-0x1)*0x32,state['logPage']*0x32);if(document[_0x10b7cd(0xf9)](_0x10b7cd(0x191)))document['getElementById']('log-total-count')[_0x10b7cd(0x85)]=_0xed82af['toLocaleString']();_0x1e44f5['innerHTML']=_0x5e6c6[_0x10b7cd(0xcd)]((_0x3a07ce,_0x74bb68)=>_0x10b7cd(0x88)+((state[_0x10b7cd(0xdf)]-0x1)*0x32+_0x74bb68+0x1)+_0x10b7cd(0xe7)+_0x3a07ce[_0x10b7cd(0x175)]+'\x22>'+(_0x3a07ce[_0x10b7cd(0x175)]||'-')+_0x10b7cd(0x1c5)+(_0x3a07ce['EmpName']||'-')+_0x10b7cd(0x1cb)+(_0x3a07ce[_0x10b7cd(0x1be)]||_0x10b7cd(0x135))+'</span></td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-400\x20font-normal\x20text-sm\x22>'+(_0x3a07ce[_0x10b7cd(0x166)]||'-')+_0x10b7cd(0x104)+formatDate(_0x3a07ce[_0x10b7cd(0x1dc)])+_0x10b7cd(0x9b))[_0x10b7cd(0xc6)]('');if(_0xe4cf90)_0xe4cf90['innerHTML']=_0x10b7cd(0x9d)+(state[_0x10b7cd(0xdf)]<=0x1?_0x10b7cd(0x15b):'')+'>Prev</button><span\x20class=\x22text-xs\x20font-bold\x20px-2\x22>Page\x20'+state[_0x10b7cd(0xdf)]+'/'+_0x461ac3+_0x10b7cd(0xad)+(state[_0x10b7cd(0xdf)]>=_0x461ac3?'disabled':'')+_0x10b7cd(0x183);lucide[_0x10b7cd(0x18a)]();},'openDeleteLogsModal':()=>{const _0x2c5108=_0x45c2bc;window[_0x2c5108(0xc9)][_0x2c5108(0x106)](_0x2c5108(0x158),_0x2c5108(0x16a),_0x2c5108(0x182),_0x2c5108(0x122),async()=>{const _0x2e3c54=_0x2c5108;try{const _0x54b2c0=await getDocs(collection(db,logCollectionPath)),_0x1beaa6=0x190,_0xc0dc16=chunkArray(_0x54b2c0[_0x2e3c54(0x13a)],_0x1beaa6);for(const _0x3e73d8 of _0xc0dc16){const _0x13849c=writeBatch(db);_0x3e73d8[_0x2e3c54(0x127)](_0x5fd3c4=>_0x13849c[_0x2e3c54(0x17e)](_0x5fd3c4[_0x2e3c54(0x1a0)])),await _0x13849c[_0x2e3c54(0x163)]();}window[_0x2e3c54(0xc9)][_0x2e3c54(0x83)](_0x2e3c54(0x9a));}catch(_0x5944ed){window[_0x2e3c54(0xc9)][_0x2e3c54(0x83)](_0x2e3c54(0xeb),_0x2e3c54(0x179));}});},'changeLogSort':_0x2c279e=>{const _0x14d5ea=_0x45c2bc;state[_0x14d5ea(0xf0)]=state['logSortKey']===_0x2c279e?state['logSortOrder']==='asc'?_0x14d5ea(0x1d7):'asc':_0x14d5ea(0x1d7),state[_0x14d5ea(0x9c)]=_0x2c279e,window['app'][_0x14d5ea(0xbc)]();},'exportLogsToCSV':()=>{const _0x1a7646=_0x45c2bc;if(state[_0x1a7646(0xce)]['length']===0x0)return window[_0x1a7646(0xc9)][_0x1a7646(0x83)](_0x1a7646(0xdd),'error');const _0x5c6b7d=['ลำดับที่',_0x1a7646(0x175),_0x1a7646(0xee),_0x1a7646(0x1be),_0x1a7646(0x166),_0x1a7646(0x1dc)],_0x257ee7=state[_0x1a7646(0xce)][_0x1a7646(0xcd)]((_0x48fd1f,_0x239cf2)=>[_0x239cf2+0x1,'\x09'+(_0x48fd1f[_0x1a7646(0x175)]||''),_0x48fd1f['EmpName']||'',_0x48fd1f[_0x1a7646(0x1be)]||_0x1a7646(0x135),_0x48fd1f[_0x1a7646(0x166)]||'',formatDate(_0x48fd1f[_0x1a7646(0x1dc)])]),_0x3dcae8='\ufeff'+[_0x5c6b7d,..._0x257ee7][_0x1a7646(0xcd)](_0x3c0e35=>_0x3c0e35[_0x1a7646(0xcd)](_0x4ef834=>'\x22'+_0x4ef834+'\x22')[_0x1a7646(0xc6)](','))[_0x1a7646(0xc6)]('\x0a'),_0xa199ee=new Blob([_0x3dcae8],{'type':'text/csv;charset=utf-8;'}),_0xdc85c2=document[_0x1a7646(0xe0)]('a'),_0x2c254e=URL[_0x1a7646(0x157)](_0xa199ee);_0xdc85c2[_0x1a7646(0x118)](_0x1a7646(0x10f),_0x2c254e),_0xdc85c2[_0x1a7646(0x118)](_0x1a7646(0x18e),_0x1a7646(0x138)+new Date()[_0x1a7646(0x116)]()+_0x1a7646(0x192)),_0xdc85c2[_0x1a7646(0x196)]['visibility']=_0x1a7646(0x14d),document[_0x1a7646(0x1b0)]['appendChild'](_0xdc85c2),_0xdc85c2['click'](),document[_0x1a7646(0x1b0)]['removeChild'](_0xdc85c2);},'onDataRewardFilterChange':_0x585798=>{const _0x47108f=_0x45c2bc;state[_0x47108f(0x15d)]=_0x585798,state['currentPage']=0x1,window[_0x47108f(0xc9)][_0x47108f(0x114)]();},'handleSearch':_0x25e5d0=>{const _0xa90904=_0x45c2bc;state[_0xa90904(0x1d6)]=_0x25e5d0[_0xa90904(0x1a8)](),state[_0xa90904(0x13d)]=0x1,window['app']['renderTable']();},'changeRowsLimit':_0x1745f2=>{const _0x505713=_0x45c2bc;state[_0x505713(0xa7)]=parseInt(_0x1745f2),state['currentPage']=0x1,window['app']['renderTable']();},'changePage':_0x134394=>{const _0x59b3b9=_0x45c2bc;state['currentPage']+=_0x134394,window[_0x59b3b9(0xc9)][_0x59b3b9(0x114)]();},'changeSort':_0x20c860=>{const _0x2dbc2f=_0x45c2bc;state[_0x2dbc2f(0x1b9)]=state['sortBy']===_0x20c860?state['sortOrder']==='asc'?_0x2dbc2f(0x1d7):'asc':_0x20c860==='no'?_0x2dbc2f(0x10c):_0x2dbc2f(0x1d7),state['sortBy']=_0x20c860,window[_0x2dbc2f(0xc9)][_0x2dbc2f(0x114)]();},'renderTable':()=>{const _0x3b6ef8=_0x45c2bc,_0x79ab9e=document[_0x3b6ef8(0xf9)]('table-body');if(!_0x79ab9e||state['activeTab']!==_0x3b6ef8(0xfd))return;let _0x43eb52=state[_0x3b6ef8(0x1cd)]['filter'](_0x2902a1=>(_0x2902a1[_0x3b6ef8(0xee)]||'')['toLowerCase']()[_0x3b6ef8(0x165)](state[_0x3b6ef8(0x1d6)])&&(state[_0x3b6ef8(0x15d)]===''||String(_0x2902a1['Reward'])===String(state[_0x3b6ef8(0x15d)])));_0x43eb52[_0x3b6ef8(0x161)]((_0x2e3858,_0xf1ff81)=>{const _0x438c64=_0x3b6ef8,_0x55a07e=_0x2e3858[state['sortBy']],_0x33fb33=_0xf1ff81[state[_0x438c64(0x82)]];if(state[_0x438c64(0x82)]==='no'||!isNaN(_0x55a07e)&&!isNaN(_0x33fb33)&&_0x55a07e!==''&&_0x33fb33!=='')return state[_0x438c64(0x1b9)]===_0x438c64(0x10c)?(parseFloat(_0x55a07e)||0x0)-(parseFloat(_0x33fb33)||0x0):(parseFloat(_0x33fb33)||0x0)-(parseFloat(_0x55a07e)||0x0);return state['sortOrder']===_0x438c64(0x10c)?String(_0x55a07e||'')[_0x438c64(0x1a3)](String(_0x33fb33||''),'th',{'numeric':!![]}):String(_0x33fb33||'')[_0x438c64(0x1a3)](String(_0x55a07e||''),'th',{'numeric':!![]});});const _0x3a5b25=_0x43eb52[_0x3b6ef8(0x1cc)]((state[_0x3b6ef8(0x13d)]-0x1)*state[_0x3b6ef8(0xa7)],state[_0x3b6ef8(0x13d)]*state[_0x3b6ef8(0xa7)]);_0x79ab9e[_0x3b6ef8(0x126)]=_0x3a5b25[_0x3b6ef8(0xcd)](_0x4320af=>_0x3b6ef8(0x180)+(_0x4320af['no']||'-')+_0x3b6ef8(0x15e)+(_0x4320af['EmpName']||'-')+'</td><td\x20class=\x22px-6\x20py-4\x20font-normal\x20font-bold\x22>'+(_0x4320af[_0x3b6ef8(0x8c)]||'-')+_0x3b6ef8(0xe1)+formatDate(_0x4320af['DateCheck'])+_0x3b6ef8(0x145)+formatDate(_0x4320af[_0x3b6ef8(0x8d)])+_0x3b6ef8(0x145)+formatDate(_0x4320af[_0x3b6ef8(0x1ae)])+_0x3b6ef8(0x168)+(_0x4320af[_0x3b6ef8(0x125)]||'-')+_0x3b6ef8(0x150)+_0x4320af['id']+_0x3b6ef8(0xe8))['join']('');if(document[_0x3b6ef8(0xf9)](_0x3b6ef8(0xca)))document['getElementById']('data-table-info')[_0x3b6ef8(0x85)]=_0x3b6ef8(0x19c)+_0x3a5b25[_0x3b6ef8(0x184)]+'\x20จาก\x20'+_0x43eb52['length']+'\x20รายการ';const _0x22d162=document[_0x3b6ef8(0xf9)](_0x3b6ef8(0x17a));if(_0x22d162)_0x22d162[_0x3b6ef8(0x126)]=_0x3b6ef8(0x109)+(state[_0x3b6ef8(0x13d)]<=0x1?_0x3b6ef8(0x15b):'')+_0x3b6ef8(0x15f)+state['currentPage']+'</span><button\x20onclick=\x22window.app.changePage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20'+(state[_0x3b6ef8(0x13d)]*state['rowsPerPage']>=_0x43eb52[_0x3b6ef8(0x184)]?_0x3b6ef8(0x15b):'')+_0x3b6ef8(0x13e);lucide['createIcons']();},'openResetModal':()=>{const _0x21edb5=_0x45c2bc;window[_0x21edb5(0xc9)][_0x21edb5(0x106)](_0x21edb5(0xef),'ยืนยัน\x20Reset\x20Register?',_0x21edb5(0x86),_0x21edb5(0x1aa),async()=>{const _0x5d2891=_0x21edb5;try{const _0x1fec05=await getDocs(collection(db,finalCollectionPath)),_0x1a55bb=writeBatch(db);_0x1fec05[_0x5d2891(0x13a)][_0x5d2891(0x127)](_0x34c7f9=>_0x1a55bb[_0x5d2891(0xa4)](_0x34c7f9['ref'],{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''})),await _0x1a55bb[_0x5d2891(0x163)](),window['app'][_0x5d2891(0x83)](_0x5d2891(0x18c));}catch(_0x1565de){window[_0x5d2891(0xc9)][_0x5d2891(0x83)](_0x5d2891(0xeb),_0x5d2891(0x179));}});},'openDeleteModal':()=>{const _0x3c7903=_0x45c2bc;window[_0x3c7903(0xc9)][_0x3c7903(0x106)]('Delete',_0x3c7903(0x13b),_0x3c7903(0x155),_0x3c7903(0x122),async()=>{const _0x1fe1f8=_0x3c7903;try{const _0x227fd1=await getDocs(collection(db,finalCollectionPath)),_0x7f740a=chunkArray(_0x227fd1[_0x1fe1f8(0x13a)],0x190);for(const _0x51a249 of _0x7f740a){const _0x25c6c3=writeBatch(db);_0x51a249[_0x1fe1f8(0x127)](_0x21d2db=>_0x25c6c3[_0x1fe1f8(0x17e)](_0x21d2db[_0x1fe1f8(0x1a0)])),await _0x25c6c3['commit']();}window[_0x1fe1f8(0xc9)]['showToast'](_0x1fe1f8(0x110));}catch(_0x169ec2){window[_0x1fe1f8(0xc9)][_0x1fe1f8(0x83)]('เกิดข้อผิดพลาด',_0x1fe1f8(0x179));}});},'openDeleteLabelsModal':()=>{const _0xb45ea4=_0x45c2bc;window[_0xb45ea4(0xc9)]['showLabelModal'](_0xb45ea4(0x158),'ลบฉลากทั้งหมด?',_0xb45ea4(0xb3),_0xb45ea4(0x122),async()=>{const _0x4f7baf=_0xb45ea4;try{const _0x170703=await getDocs(collection(db,cardCollectionPath)),_0x150fcd=chunkArray(_0x170703[_0x4f7baf(0x13a)],0x190);for(const _0x22865b of _0x150fcd){const _0x555736=writeBatch(db);_0x22865b[_0x4f7baf(0x127)](_0x3d2b60=>_0x555736[_0x4f7baf(0x17e)](_0x3d2b60[_0x4f7baf(0x1a0)])),await _0x555736[_0x4f7baf(0x163)]();}const _0x3a30da=await getDocs(collection(db,finalCollectionPath)),_0x3e6ce0=chunkArray(_0x3a30da[_0x4f7baf(0x13a)],0x190);for(const _0x54bafa of _0x3e6ce0){const _0x3c3be9=writeBatch(db);_0x54bafa[_0x4f7baf(0x127)](_0x255e10=>_0x3c3be9[_0x4f7baf(0xa4)](_0x255e10[_0x4f7baf(0x1a0)],{'DateLogin':'','StatusReward':'','DateReward':'','CardNo':''})),await _0x3c3be9[_0x4f7baf(0x163)]();}window[_0x4f7baf(0xc9)][_0x4f7baf(0x83)]('ลบฉลากสำเร็จ');}catch(_0x123650){window['app'][_0x4f7baf(0x83)](_0x4f7baf(0xeb),'error');}});},'openCreateLabelsModal':()=>{const _0x33e9e7=_0x45c2bc;window['app'][_0x33e9e7(0x106)]('Confirm',_0x33e9e7(0x87),_0x33e9e7(0x1ab),_0x33e9e7(0xfe),async()=>{const _0x286328=_0x33e9e7;try{await window['app'][_0x286328(0x19a)](),window['app'][_0x286328(0x83)](_0x286328(0x19b));}catch(_0x593a1a){window['app'][_0x286328(0x83)](_0x286328(0xeb),_0x286328(0x179));}});},'generateLabels':async()=>{const _0x45beab=_0x45c2bc;if(state['users'][_0x45beab(0x184)]===0x0){window['app'][_0x45beab(0x83)]('ยังไม่มีข้อมูลสมาชิก','error');return;}const _0x396dc4=await getDocs(collection(db,cardCollectionPath)),_0x180b54=chunkArray(_0x396dc4[_0x45beab(0x13a)],0x190);for(const _0x391d15 of _0x180b54){const _0x4bc230=writeBatch(db);_0x391d15[_0x45beab(0x127)](_0x5ecfed=>_0x4bc230[_0x45beab(0x17e)](_0x5ecfed[_0x45beab(0x1a0)])),await _0x4bc230[_0x45beab(0x163)]();}const _0x33b46d={},_0x461e3e=state[_0x45beab(0x1cd)]['map'](_0x2a017e=>{const _0x59dbe4=_0x45beab,_0x4610de=String(_0x2a017e['Reward']||_0x59dbe4(0xa6))[_0x59dbe4(0xf7)]();return _0x33b46d[_0x4610de]=(_0x33b46d[_0x4610de]||0x0)+0x1,{'Reward':_0x4610de,'rewardname':'','CardNo':String(_0x33b46d[_0x4610de]),'EmpName':'','citizenId':'','Datetime':''};}),_0x2af709=chunkArray(_0x461e3e,0x190);for(const _0x545547 of _0x2af709){const _0x5a7723=writeBatch(db);_0x545547[_0x45beab(0x127)](_0xb94951=>_0x5a7723[_0x45beab(0x98)](doc(collection(db,cardCollectionPath)),_0xb94951)),await _0x5a7723['commit']();}},'handleFileSelect':_0x4802a3=>{const _0x41c91d=_0x45c2bc,_0x37b0cd=_0x4802a3[_0x41c91d(0x14b)]['files'][0x0];_0x37b0cd&&(document[_0x41c91d(0xf9)](_0x41c91d(0xe2))['innerText']=_0x37b0cd[_0x41c91d(0x18b)],document[_0x41c91d(0xf9)](_0x41c91d(0xbd))[_0x41c91d(0x1da)][_0x41c91d(0x93)](_0x41c91d(0x14d)),document[_0x41c91d(0xf9)](_0x41c91d(0x1b8))[_0x41c91d(0x15b)]=![]);},'clearFileSelection':()=>{const _0x448f55=_0x45c2bc;document[_0x448f55(0xf9)](_0x448f55(0xc3))['value']='',document[_0x448f55(0xf9)](_0x448f55(0xbd))[_0x448f55(0x1da)][_0x448f55(0x11c)]('hidden'),document[_0x448f55(0xf9)](_0x448f55(0x1b8))['disabled']=!![];},'processImport':async()=>{const _0x311c39=_0x45c2bc,_0x4a259c=document[_0x311c39(0xf9)](_0x311c39(0xc3)),_0x116bbf=_0x4a259c[_0x311c39(0x124)][0x0];if(!_0x116bbf)return;document[_0x311c39(0xf9)](_0x311c39(0xb8))[_0x311c39(0x1da)][_0x311c39(0x93)](_0x311c39(0x14d));const _0x1863ff=document[_0x311c39(0xf9)](_0x311c39(0x113)),_0x435994=new FileReader();_0x435994[_0x311c39(0x1c8)]=async _0x3342ef=>{const _0x4a57fb=_0x311c39;try{const _0x37a08c=_0x116bbf[_0x4a57fb(0x18b)][_0x4a57fb(0xbf)]('.json')?JSON[_0x4a57fb(0xf2)](_0x3342ef['target'][_0x4a57fb(0xab)]):csvToJson(_0x3342ef[_0x4a57fb(0x14b)]['result']),_0x64f159=_0x37a08c[_0x4a57fb(0x184)];for(let _0x4e48e3=0x0;_0x4e48e3<_0x64f159;_0x4e48e3+=0x190){const _0x398ff2=_0x37a08c[_0x4a57fb(0x1cc)](_0x4e48e3,_0x4e48e3+0x190),_0x93651e=writeBatch(db),_0x10e6fe=_0x398ff2[_0x4a57fb(0xcd)](async(_0xcec295,_0x5d3e81)=>{const _0x1397ea=_0x4a57fb,_0x17adb8=String(_0xcec295['citizenId']||'')[_0x1397ea(0x173)](/-/g,'')[_0x1397ea(0xf7)](),_0x388b2d=await sha256(_0x17adb8),_0x31412d=(_0x4e48e3+_0x5d3e81+0x1)[_0x1397ea(0x1bd)](),_0x705bab=doc(collection(db,finalCollectionPath));_0x93651e[_0x1397ea(0x98)](_0x705bab,{'citizenId':_0x388b2d,'no':_0x31412d,'EmpName':_0xcec295[_0x1397ea(0xee)]||_0xcec295[_0x1397ea(0x8a)]||'','Dateworking':_0xcec295[_0x1397ea(0x1b5)]||'','Datework':_0xcec295[_0x1397ea(0x1b3)]||'','Reward':_0xcec295[_0x1397ea(0x8c)]||'','DateLogin':_0xcec295[_0x1397ea(0x8d)]||'','StatusReward':_0xcec295[_0x1397ea(0x125)]||'','DateReward':_0xcec295[_0x1397ea(0x1ae)]||'','DateCheck':_0xcec295[_0x1397ea(0x12d)]||'','importedAt':serverTimestamp()});});await Promise[_0x4a57fb(0x15a)](_0x10e6fe),await _0x93651e[_0x4a57fb(0x163)](),_0x1863ff[_0x4a57fb(0x196)][_0x4a57fb(0xa9)]=Math['min'](0x64,Math['round']((_0x4e48e3+_0x398ff2['length'])/_0x64f159*0x64))+'%';}window[_0x4a57fb(0xc9)][_0x4a57fb(0x83)](_0x4a57fb(0x92)),window[_0x4a57fb(0xc9)][_0x4a57fb(0xa8)]();}catch(_0x3e5031){window[_0x4a57fb(0xc9)][_0x4a57fb(0x83)](_0x4a57fb(0xda)+_0x3e5031[_0x4a57fb(0x10d)],_0x4a57fb(0x179));}finally{document[_0x4a57fb(0xf9)](_0x4a57fb(0xb8))[_0x4a57fb(0x1da)][_0x4a57fb(0x11c)]('hidden');}},_0x435994[_0x311c39(0x1bb)](_0x116bbf);},'refreshCharts':()=>{const _0x3a8a90=_0x45c2bc,_0x4ab2db=document[_0x3a8a90(0xf9)](_0x3a8a90(0x130));if(_0x4ab2db){if(window[_0x3a8a90(0xe9)])window['regPie'][_0x3a8a90(0x81)]();const _0xc13d86=state[_0x3a8a90(0x1cd)][_0x3a8a90(0x1d4)](_0x425bbc=>_0x425bbc['DateCheck']&&_0x425bbc[_0x3a8a90(0x12d)]!=='')[_0x3a8a90(0x184)];window['regPie']=new Chart(_0x4ab2db,{'type':_0x3a8a90(0x96),'data':{'labels':[_0x3a8a90(0xd7),_0x3a8a90(0x1c2)],'datasets':[{'data':[_0xc13d86,Math['max'](0x0,state[_0x3a8a90(0x1cd)][_0x3a8a90(0x184)]-_0xc13d86)],'backgroundColor':[_0x3a8a90(0x16b),'#e2e8f0']}]},'options':{'maintainAspectRatio':![]}});}const _0x4522ca=document[_0x3a8a90(0xf9)](_0x3a8a90(0x94));if(_0x4522ca){if(window['regLine'])window[_0x3a8a90(0x117)][_0x3a8a90(0x81)]();window[_0x3a8a90(0x117)]=new Chart(_0x4522ca,{'type':_0x3a8a90(0x156),'data':{'labels':Array['from']({'length':0x18},(_0x4d73fc,_0x411aca)=>_0x411aca+_0x3a8a90(0xe6)),'datasets':[{'label':_0x3a8a90(0x1a1),'data':state['hourlyData'],'borderColor':_0x3a8a90(0x1d8),'fill':!![],'tension':0.4}]},'options':{'maintainAspectRatio':![]}});}window[_0x3a8a90(0xc9)]['renderManualHistory']();},'renderManualHistory':()=>{const _0x502a97=_0x45c2bc,_0x14ac14=document[_0x502a97(0xf9)](_0x502a97(0x19f)),_0x4428f1=state[_0x502a97(0x1cd)]['filter'](_0x1c406c=>_0x1c406c[_0x502a97(0x12d)]&&_0x1c406c[_0x502a97(0x12d)]!=='')['sort']((_0x1ffe25,_0x27927f)=>{const _0x25ca63=_0x502a97,_0x44640d=_0x1ffe25[_0x25ca63(0x12d)]?.['toDate']?_0x1ffe25[_0x25ca63(0x12d)]['toDate']():new Date(_0x1ffe25['DateCheck']),_0x4eb672=_0x27927f[_0x25ca63(0x12d)]?.['toDate']?_0x27927f[_0x25ca63(0x12d)][_0x25ca63(0xd0)]():new Date(_0x27927f[_0x25ca63(0x12d)]);return _0x4eb672-_0x44640d;})[_0x502a97(0x1cc)](0x0,0xa);_0x14ac14&&(_0x14ac14[_0x502a97(0x126)]=_0x4428f1[_0x502a97(0x184)]?_0x4428f1[_0x502a97(0xcd)](_0x1280af=>_0x502a97(0x97)+(_0x1280af[_0x502a97(0xee)]||'Unknown')+_0x502a97(0x8e)+(_0x1280af['Reward']||'-')+_0x502a97(0xc8)+formatDate(_0x1280af[_0x502a97(0x12d)])+_0x502a97(0x10e))['join'](''):'<div\x20class=\x22text-center\x20text-slate-300\x20py-8\x20text-base\x20font-medium\x22>ไม่มีกิจกรรม</div>');},'resetMemberData':async _0x19c333=>{const _0x492124=_0x45c2bc;if(!confirm(_0x492124(0xed)))return;try{await updateDoc(doc(db,finalCollectionPath,_0x19c333),{'DateLogin':'','StatusReward':'','DateReward':'','DateCheck':''}),window['app'][_0x492124(0x83)](_0x492124(0x1c4));}catch(_0x14fc3c){window['app'][_0x492124(0x83)]('ผิดพลาด',_0x492124(0x179));}},'resetLabelRecord':async _0x1819e0=>{const _0x187fe0=_0x45c2bc;if(!confirm('ล้างข้อมูลฉลากใบนี้?'))return;try{await updateDoc(doc(db,cardCollectionPath,_0x1819e0),{'EmpName':'','Datetime':'','citizenId':''}),window[_0x187fe0(0xc9)][_0x187fe0(0x83)](_0x187fe0(0xa1));}catch(_0x1717ec){window[_0x187fe0(0xc9)][_0x187fe0(0x83)](_0x187fe0(0xdc),_0x187fe0(0x179));}},'openEditRewardModal':(_0x396eb7,_0x1d7dda)=>{const _0x4db810=_0x45c2bc;document[_0x4db810(0xf9)](_0x4db810(0x89))['value']=_0x1d7dda,document['getElementById'](_0x4db810(0x143))['onclick']=async()=>{const _0x5b77a6=_0x4db810,_0xb7d3b4=document[_0x5b77a6(0xf9)](_0x5b77a6(0x89))[_0x5b77a6(0x1cf)]['trim']();try{await updateDoc(doc(db,cardCollectionPath,_0x396eb7),{'rewardname':_0xb7d3b4}),window[_0x5b77a6(0xc9)][_0x5b77a6(0x83)](_0x5b77a6(0x1c4)),window[_0x5b77a6(0xc9)]['closeEditRewardModal']();}catch(_0x4579fc){window[_0x5b77a6(0xc9)][_0x5b77a6(0x83)](_0x5b77a6(0xdc),_0x5b77a6(0x179));}},document[_0x4db810(0xf9)](_0x4db810(0x13c))[_0x4db810(0x1da)][_0x4db810(0x93)](_0x4db810(0x14d));},'showLabelModal':(_0x369805,_0x4ee955,_0x335407,_0x2fe543,_0x4fb9fb)=>{const _0x438cbf=_0x45c2bc,_0x28de9d=document[_0x438cbf(0xf9)](_0x438cbf(0x176)),_0x2babbb=document[_0x438cbf(0xf9)](_0x438cbf(0x181));document['getElementById'](_0x438cbf(0xb6))[_0x438cbf(0x85)]=_0x4ee955,document[_0x438cbf(0xf9)](_0x438cbf(0x123))[_0x438cbf(0x85)]=_0x335407;const _0x2febfc=document[_0x438cbf(0xf9)](_0x438cbf(0xcc));_0x2febfc[_0x438cbf(0x1d2)]='w-16\x20h-16\x20rounded-full\x20flex\x20items-center\x20justify-center\x20mx-auto\x20mb-4\x20bg-'+_0x2fe543+_0x438cbf(0xb1)+_0x2fe543+_0x438cbf(0x1bf),_0x2febfc['innerHTML']=_0x438cbf(0x1a2)+(_0x369805===_0x438cbf(0x158)?_0x438cbf(0x11f):_0x438cbf(0xc7))+_0x438cbf(0x152),document[_0x438cbf(0xf9)](_0x438cbf(0xb2))['classList'][_0x438cbf(0x93)](_0x438cbf(0x14d));const _0x4963ef=document['getElementById']('label-modal-input');_0x4963ef[_0x438cbf(0x1cf)]='',_0x4963ef[_0x438cbf(0x153)]=_0x438cbf(0x11a)+_0x369805+_0x438cbf(0x121),_0x2babbb[_0x438cbf(0x1d2)]=_0x438cbf(0x12c)+(_0x2fe543===_0x438cbf(0x122)?'red-600':_0x2fe543===_0x438cbf(0x1aa)?'orange-600':_0x438cbf(0xc4))+_0x438cbf(0x14a),_0x2babbb[_0x438cbf(0x85)]='ยืนยัน',_0x2babbb[_0x438cbf(0x99)]=async()=>{const _0x270235=_0x438cbf;if(_0x4963ef[_0x270235(0x1cf)]!==_0x369805)return window[_0x270235(0xc9)][_0x270235(0x83)](_0x270235(0x1df),_0x270235(0x179));_0x2babbb['disabled']=!![],_0x2babbb[_0x270235(0x85)]=_0x270235(0x80);try{await _0x4fb9fb(),window['app'][_0x270235(0x108)]();}finally{_0x2babbb[_0x270235(0x15b)]=![],_0x2babbb[_0x270235(0x85)]=_0x270235(0x171);}},_0x28de9d[_0x438cbf(0x1da)][_0x438cbf(0x93)](_0x438cbf(0x14d)),lucide[_0x438cbf(0x18a)]();},'closeLabelModal':()=>document[_0x45c2bc(0xf9)]('label-confirm-modal')[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'closeEditRewardModal':()=>document['getElementById'](_0x45c2bc(0x13c))[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'closeGeneralModal':()=>document[_0x45c2bc(0xf9)](_0x45c2bc(0x1a7))[_0x45c2bc(0x1da)][_0x45c2bc(0x11c)](_0x45c2bc(0x14d)),'onLabelGroupChange':_0x3ebd16=>{const _0xaec09f=_0x45c2bc;state['selectedLabelGroup']=normalizeReward(_0x3ebd16),state[_0xaec09f(0x134)]=0x1,window[_0xaec09f(0xc9)][_0xaec09f(0x146)]();},'onDataRewardFilterChange':_0x95f4c9=>{const _0x39473d=_0x45c2bc;state[_0x39473d(0x15d)]=_0x95f4c9,state[_0x39473d(0x13d)]=0x1,window[_0x39473d(0xc9)][_0x39473d(0x114)]();},'handleSearch':_0x47c826=>{const _0x34ff75=_0x45c2bc;state['searchTerm']=_0x47c826[_0x34ff75(0x1a8)](),state[_0x34ff75(0x13d)]=0x1,window[_0x34ff75(0xc9)]['renderTable']();},'changeRowsLimit':_0x13db11=>{const _0x5f5454=_0x45c2bc;state[_0x5f5454(0xa7)]=parseInt(_0x13db11),state[_0x5f5454(0x13d)]=0x1,window[_0x5f5454(0xc9)][_0x5f5454(0x114)]();},'changePage':_0xdae538=>{const _0x30bf96=_0x45c2bc;state[_0x30bf96(0x13d)]+=_0xdae538,window[_0x30bf96(0xc9)][_0x30bf96(0x114)]();},'changeSort':_0x2bfe5f=>{const _0x5618b4=_0x45c2bc;state[_0x5618b4(0x1b9)]=state[_0x5618b4(0x82)]===_0x2bfe5f?state[_0x5618b4(0x1b9)]==='asc'?_0x5618b4(0x1d7):_0x5618b4(0x10c):_0x2bfe5f==='no'?_0x5618b4(0x10c):'desc',state[_0x5618b4(0x82)]=_0x2bfe5f,window[_0x5618b4(0xc9)][_0x5618b4(0x114)]();},'changeLogPage':_0x38d337=>{const _0x2ec1ab=_0x45c2bc;state[_0x2ec1ab(0xdf)]+=_0x38d337,window['app'][_0x2ec1ab(0xbc)]();},'changeLogSort':_0x1adf37=>{const _0x17b995=_0x45c2bc;state[_0x17b995(0xf0)]=state[_0x17b995(0x9c)]===_0x1adf37?state['logSortOrder']===_0x17b995(0x10c)?'desc':'asc':_0x17b995(0x1d7),state[_0x17b995(0x9c)]=_0x1adf37,window[_0x17b995(0xc9)]['renderLogTable']();}};async function init(){const _0x2e0c26=_0x45c2bc;try{if(typeof __initial_auth_token!==_0x2e0c26(0x133)&&__initial_auth_token)await signInWithCustomToken(auth,__initial_auth_token);else await signInAnonymously(auth);document[_0x2e0c26(0xf9)](_0x2e0c26(0x14e))?.['classList'][_0x2e0c26(0x173)](_0x2e0c26(0x177),_0x2e0c26(0x18f));if(document[_0x2e0c26(0xf9)](_0x2e0c26(0xbe)))document['getElementById'](_0x2e0c26(0xbe))[_0x2e0c26(0x85)]=_0x2e0c26(0x11e);onSnapshot(collection(db,finalCollectionPath),_0x44a161=>{const _0x42116d=_0x2e0c26;state[_0x42116d(0x1cd)]=_0x44a161[_0x42116d(0x13a)][_0x42116d(0xcd)](_0x5b210c=>({'id':_0x5b210c['id'],..._0x5b210c[_0x42116d(0xfd)]()})),document[_0x42116d(0xf9)](_0x42116d(0x190))['innerText']=_0x44a161[_0x42116d(0x101)][_0x42116d(0x199)](),document[_0x42116d(0xf9)](_0x42116d(0x115))['innerText']=_0x44a161[_0x42116d(0x101)][_0x42116d(0x199)]();const _0x14139e=state[_0x42116d(0x1cd)][_0x42116d(0x1d4)](_0x2ccca0=>_0x2ccca0[_0x42116d(0x12d)]&&_0x2ccca0[_0x42116d(0x12d)]!=='')[_0x42116d(0x184)];document[_0x42116d(0xf9)](_0x42116d(0x149))['innerText']=_0x14139e[_0x42116d(0x199)](),document[_0x42116d(0xf9)](_0x42116d(0xcb))[_0x42116d(0x85)]=_0x44a161[_0x42116d(0x101)]>0x0?(_0x14139e/_0x44a161[_0x42116d(0x101)]*0x64)['toFixed'](0x1)+'%':'0%';const _0x2e20d3=Array(0x18)[_0x42116d(0x1dd)](0x0);state[_0x42116d(0x1cd)][_0x42116d(0x127)](_0x3234bf=>{const _0x5ec567=_0x42116d;if(_0x3234bf['DateCheck'])try{let _0x1b8f4f=_0x3234bf['DateCheck'][_0x5ec567(0xd0)]?_0x3234bf['DateCheck'][_0x5ec567(0xd0)]():new Date(_0x3234bf[_0x5ec567(0x12d)]);if(!isNaN(_0x1b8f4f[_0x5ec567(0x116)]()))_0x2e20d3[_0x1b8f4f[_0x5ec567(0x17c)]()]++;}catch(_0x1c784d){}}),state[_0x42116d(0xfc)]=_0x2e20d3;const _0x55ecaa=[...new Set(state[_0x42116d(0x1cd)][_0x42116d(0xcd)](_0x31ffe2=>String(_0x31ffe2[_0x42116d(0x8c)]||'')[_0x42116d(0xf7)]())['filter'](_0x271393=>_0x271393!==''))][_0x42116d(0x161)]((_0x2fad0f,_0x2e3e08)=>_0x2fad0f['localeCompare'](_0x2e3e08)),_0xbef67b=document[_0x42116d(0xf9)](_0x42116d(0x148));if(_0xbef67b){const _0x5968c3=_0xbef67b[_0x42116d(0x1cf)];_0xbef67b['innerHTML']=_0x42116d(0xaa)+_0x55ecaa[_0x42116d(0xcd)](_0x12d3cb=>'<option\x20value=\x22'+_0x12d3cb+'\x22>'+_0x12d3cb+_0x42116d(0x142))['join'](''),_0xbef67b[_0x42116d(0x1cf)]=_0x55ecaa[_0x42116d(0x165)](_0x5968c3)?_0x5968c3:'';}window[_0x42116d(0xc9)][_0x42116d(0x114)](),window[_0x42116d(0xc9)]['renderDataSummary'](),window[_0x42116d(0xc9)][_0x42116d(0x10b)](),window[_0x42116d(0xc9)][_0x42116d(0x140)]();}),onSnapshot(collection(db,cardCollectionPath),_0x4cc93a=>{const _0x1b0406=_0x2e0c26;state[_0x1b0406(0xd8)]=_0x4cc93a['docs'][_0x1b0406(0xcd)](_0x1889cc=>({'id':_0x1889cc['id'],..._0x1889cc[_0x1b0406(0xfd)]()}));const _0x16ff3d=[_0x1b0406(0x17f),_0x1b0406(0x1e1),_0x1b0406(0xaf),'4000'],_0x5e0300={};_0x16ff3d[_0x1b0406(0x127)](_0x6a4986=>_0x5e0300[_0x6a4986]={'total':0x0,'used':0x0}),state['cards'][_0x1b0406(0x127)](_0xba1b68=>{const _0x59d003=_0x1b0406,_0x726765=normalizeReward(_0xba1b68[_0x59d003(0x8c)]);if(_0x5e0300[_0x59d003(0xc2)](_0x726765)){_0x5e0300[_0x726765]['total']++;if(_0xba1b68['Datetime']&&_0xba1b68[_0x59d003(0x1dc)]!=='')_0x5e0300[_0x726765][_0x59d003(0x178)]++;}}),_0x16ff3d[_0x1b0406(0x127)](_0x2f076b=>{const _0x17e943=_0x1b0406,_0x14eb29=_0x5e0300[_0x2f076b],_0x21b8c0=_0x14eb29[_0x17e943(0x91)]>0x0?Math['round'](_0x14eb29[_0x17e943(0x178)]/_0x14eb29[_0x17e943(0x91)]*0x64):0x0;if(document[_0x17e943(0xf9)](_0x17e943(0xd1)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0xd1)+_0x2f076b)[_0x17e943(0x126)]=_0x14eb29['total'][_0x17e943(0x199)]()+_0x17e943(0x162);if(document['getElementById']('card-used-'+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0x12e)+_0x2f076b)['innerText']=_0x14eb29[_0x17e943(0x178)][_0x17e943(0x199)]();if(document['getElementById'](_0x17e943(0x1d9)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0x1d9)+_0x2f076b)[_0x17e943(0x85)]=_0x21b8c0+'%';if(document['getElementById'](_0x17e943(0xb0)+_0x2f076b))document[_0x17e943(0xf9)](_0x17e943(0xb0)+_0x2f076b)[_0x17e943(0x196)][_0x17e943(0xa9)]=_0x21b8c0+'%';});const _0x48f4e1=[...new Set(state[_0x1b0406(0xd8)][_0x1b0406(0xcd)](_0x5805ba=>normalizeReward(_0x5805ba[_0x1b0406(0x8c)])))][_0x1b0406(0x1d4)](_0xb57c2d=>_0xb57c2d!=='')[_0x1b0406(0x161)]((_0x1c7af9,_0x8d3dc)=>_0x1c7af9[_0x1b0406(0x1a3)](_0x8d3dc,undefined,{'numeric':!![]})),_0x54924f=document[_0x1b0406(0xf9)](_0x1b0406(0xb5));if(_0x54924f){const _0x525024=_0x54924f[_0x1b0406(0x1cf)];_0x54924f[_0x1b0406(0x126)]=_0x1b0406(0x15c)+_0x48f4e1['map'](_0x1ceb85=>_0x1b0406(0x159)+_0x1ceb85+'\x22>'+_0x1ceb85+_0x1b0406(0x142))[_0x1b0406(0xc6)](''),_0x54924f['value']=_0x525024||'';}window[_0x1b0406(0xc9)][_0x1b0406(0x146)](),window[_0x1b0406(0xc9)][_0x1b0406(0x10b)]();}),onSnapshot(collection(db,logCollectionPath),_0x223ecd=>{const _0x30c77d=_0x2e0c26;state[_0x30c77d(0xce)]=_0x223ecd[_0x30c77d(0x13a)][_0x30c77d(0xcd)](_0xbef011=>({'id':_0xbef011['id'],..._0xbef011['data']()}));if(state[_0x30c77d(0x13f)]===_0x30c77d(0xce))window['app'][_0x30c77d(0xbc)]();}),window[_0x2e0c26(0xc9)]['switchTab'](state[_0x2e0c26(0x13f)]);}catch(_0x3eb455){console[_0x2e0c26(0x179)](_0x3eb455);}}function _0x4181(){const _0x11a4be=['bg-rose-600','ttb-register.firebasestorage.app','createIcons','name','รีเซ็ตสำเร็จ','toast-container','download','bg-green-500','stat-checkin','log-total-count','.csv','group','toLocaleTimeString','.view-section','style','</td><td\x20class=\x22px-6\x20text-indigo-600\x20font-bold\x20font-bold\x22>','ผู้รับรางวัล\x20(EmpName)','toLocaleString','generateLabels','สร้างฉลากใหม่สำเร็จ','แสดง\x20','log-pagination-controls','%</span></div><div\x20class=\x22w-full\x20','recent-activity-list','ref','ความถี่การลงทะเบียน','<i\x20data-lucide=\x22','localeCompare','log-table-body','\x20จากทั้งหมด\x20','text-white','general-modal','toLowerCase','bg-amber-600','orange','ยืนยันการสร้างสลากใหม่โดยอ้างอิงจากรายชื่อสมาชิกที่มีอยู่จริงในระบบ','rewardname','amber','DateReward','75wMLzWe','body','370196VUlTNG','<div\x20class=\x22flex\x20flex-col\x20py-2\x20border-b\x20border-slate-50\x20last:border-0\x20px-2\x20font-bold\x22><span\x20class=\x22text-slate-800\x20text-lg\x22>','Datework','labels_export_','Dateworking','1385805ouvJtQ','\x20p-5\x20rounded-2xl\x20shadow-xl\x20border\x20border-white/10\x20flex\x20flex-col\x20transition-all\x20hover:shadow-2xl\x20hover:scale-[1.02]\x20h-full\x20','btn-import','sortOrder','\x20บาท</h4></div><div\x20class=\x22bg-','readAsText','NO.','toString','StatusReg','-600\x20font-bold','Outsources_card','-500\x20h-2\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','ยังไม่ลงทะเบียน','>แก้ไข</button><button\x20onclick=\x22','สำเร็จ','</td><td\x20class=\x22px-4\x20py-3\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22>','---','-700\x22>','onload','<span\x20class=\x22text-sm\x20font-bold\x20text-slate-700\x22>','\x20h-1.5\x20mt-auto\x20rounded-full\x20overflow-hidden\x20mt-3\x20shadow-inner\x22><div\x20class=\x22bg-white\x20h-1.5\x20rounded-full\x20transition-all\x20duration-1000\x22\x20style=\x22width:\x20','</td><td\x20class=\x22px-4\x20py-3\x20font-bold\x22><span\x20class=\x22px-2\x20py-0.5\x20rounded-full\x20text-[10px]\x20bg-blue-100\x20text-blue-600\x20font-bold\x22>','slice','users','>Prev</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','value','registered','</span><span\x20class=\x22text-[9px]\x20text-slate-300\x20font-normal\x20mt-0.5\x22>','className','current-time','filter','ตรวจสอบรายการ','searchTerm','desc','#3b82f6','card-percent-','classList','CardNo','Datetime','fill','labelSortOrder','คำยืนยันไม่ถูกต้อง','round','2000','\x20-\x20','กำลังดำเนินการ...','destroy','sortBy','showToast','reduce','innerText','พิมพ์\x20Reset\x20เพื่อล้างข้อมูลการล็อกอินและผลการสุ่มทั้งหมด','สร้างฉลากใหม่?','<tr\x20class=\x22hover:bg-blue-50/50\x20transition\x20font-bold\x20text-slate-700\x20text-sm\x22><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-slate-400\x20font-normal\x20text-sm\x22>','edit-reward-input','Name','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','Reward','DateLogin','</b>\x20<span\x20class=\x22text-slate-400\x20font-normal\x20mx-1\x22>กลุ่ม:</span>\x20<span\x20class=\x22text-indigo-600\x22>','\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>ราย</span></h3><div\x20class=\x22mt-2\x20flex\x20justify-between\x20items-baseline\x20font-bold\x22><span\x20class=\x22text-sm\x22>','click','total','นำเข้าข้อมูลเรียบร้อย','remove','realtimeLineChart','</span>','doughnut','<div\x20class=\x22p-3\x20bg-white\x20rounded-lg\x20text-sm\x20shadow-sm\x20border\x20border-slate-100\x20mb-1\x20font-bold\x22><b\x20class=\x22text-slate-800\x20font-black\x22>','set','onclick','ลบประวัติ\x20Log\x20เรียบร้อยแล้ว','</td></tr>','logSortKey','<button\x20onclick=\x22window.app.changeLogPage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-50\x20font-normal\x20text-sm\x20text-slate-700\x20font-bold\x22><td\x20class=\x22px-6\x20font-mono\x20text-slate-500\x22>','จัดการข้อมูล','window.app.openEditRewardModal(\x27','ล้างข้อมูลแล้ว','SHA-256','index','update','winners','ไม่ระบุกลุ่ม','rowsPerPage','clearFileSelection','width','<option\x20value=\x22\x22>--\x20ทั้งหมด\x20--</option>','result','11unxABl','</span><button\x20onclick=\x22window.app.changeLogPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-xs\x20hover:bg-slate-50\x20font-bold\x22\x20','div','3000','card-bar-','-100\x20text-','label-modal-input-container','พิมพ์\x20Delete\x20เพื่อลบสลากทั้งหมดออกจากระบบและรีเซ็ตสถานะสุ่ม','</td><td\x20class=\x22px-6\x20text-slate-500\x20font-bold\x22>','label-group-select','label-modal-title','artifacts/','import-progress','\x20/\x20','</span></div>','push','renderLogTable','file-info','status-text','endsWith','window.app.resetLabelRecord(\x27','>ล้างผลสุ่ม</button></div></td></tr>','hasOwnProperty','file-upload','indigo-600','สุ่มครั้งที่\x201\x20(DateLogin)','join','check-circle','</span>\x20<div\x20class=\x22text-[10px]\x20text-slate-400\x20mt-1\x20font-normal\x22>ลงทะเบียนเมื่อ\x20','app','data-table-info','stat-percent','label-modal-icon','map','logs','ภาพรวมระบบ','toDate','card-total-','default-app-id','1:1070273157855:web:5c8120e1df27e233d8676a','แสดงรายการที่\x20','querySelectorAll','dashboard','ลงทะเบียนแล้ว','cards','รางวัล\x20(StatusReward)','ผิดพลาด:\x20','ของรางวัล\x20(Reward\x20Name)','ผิดพลาด','ไม่มีข้อมูลสำหรับดาวน์โหลด','type','logPage','createElement','</td><td\x20class=\x22px-6\x20py-4\x20text-indigo-600\x20font-normal\x20font-bold\x22>','file-name','</span><button\x20onclick=\x22window.app.changeLabelPage(1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','-600\x22>','-500\x20text-white\x20p-3\x20text-center\x22><p\x20class=\x22text-[13px]\x20font-black\x20opacity-80\x20tracking-widest\x20uppercase\x22>กลุ่มรางวัล</p><h4\x20class=\x22text-xl\x20font-black\x22>',':00','</td><td\x20class=\x22px-4\x20py-3\x20font-mono\x20text-xs\x20text-slate-500\x20font-normal\x20text-sm\x20truncate\x20max-w-[120px]\x22\x20title=\x22','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20transition\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2218\x22></i></button></td></tr>','regPie','\x20คน</p></div></div>','เกิดข้อผิดพลาด','14341896xDHCcf','ยืนยันการล้างข้อมูล?','EmpName','Reset','logSortOrder','Outsources','parse','winners-container','1950528hZbFng','%\x22></div></div><p\x20class=\x22text-[12px]\x20text-slate-400\x20mt-2\x20text-right\x20font-bold\x20text-slate-600\x20italic\x22>พนักงานในกลุ่มนี้:\x20','\x20<span\x20class=\x22text-[10px]\x20opacity-70\x20font-normal\x22>ลงทะเบียนแล้ว</span></span><span\x20class=\x22text-lg\x20font-black\x22>','trim','bar','getElementById','percent','</span><span\x20class=\x22text-xs\x20text-','hourlyData','data','indigo','labelSortKey','label','size','\x22\x20class=\x22text-red-500\x20font-bold\x20text-xs\x20p-1\x20px-2\x20border\x20border-red-200\x20rounded-lg\x20','opacity-0','</td><td\x20class=\x22px-4\x20py-3\x20text-slate-500\x20font-normal\x20text-sm\x22>','selectedLabelGroup','showLabelModal','Reward\x20(Group)','closeLabelModal','<button\x20onclick=\x22window.app.changePage(-1)\x22\x20class=\x22px-3\x20py-1\x20bg-white\x20border\x20rounded-md\x20text-sm\x20hover:bg-slate-50\x20font-bold\x22\x20','removeChild','renderWinnersView','asc','message','</div></div>','href','ลบสำเร็จ','data-summary-container','visibility','import-bar','renderTable','manage-total-docs','getTime','regLine','setAttribute','</div><div\x20class=\x22bg-slate-50\x20p-5\x20border-t\x22><div\x20class=\x22flex\x20justify-between\x20items-center\x20mb-1.5\x20font-bold\x22><span\x20class=\x22text-[12px]\x20text-slate-500\x22>สถิติการสุ่มรางวัล</span><span\x20class=\x22text-xs\x20text-slate-700\x22>','พิมพ์\x20','bg-white/30','add','ข้อมูลลงทะเบียน','Online','trash-2','ceil','\x20เพื่อยืนยัน','red','label-modal-message','files','StatusReward','innerHTML','forEach','<div\x20class=\x22','9744XjaqZv','9IlnfZq','14430hZjkHf','flex-1\x20py-3\x20rounded-xl\x20bg-','DateCheck','card-used-','bg-slate-700','registrationChart','สุ่มครั้งที่\x202\x20(DateReward)','<div\x20class=\x22text-base\x20text-slate-400\x20py-6\x20text-center\x20italic\x22>ยังไม่มีผู้ได้รับรางวัล</div>','undefined','labelPage','Success','\x20ราย</span></div><div\x20class=\x22w-full\x20bg-slate-200\x20rounded-full\x20h-2\x22><div\x20class=\x22bg-','3840JJodnK','outsources_logs_','th-TH','docs','ลบข้อมูลพนักงานทั้งหมด?','edit-reward-modal','currentPage','>ถัดไป</button>','activeTab','refreshCharts','renderDataSummary','</option>','edit-reward-confirm-btn','padStart','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-normal\x20font-bold\x22>','renderLabelTable','1070273157855','filter-data-reward','stat-checkout','\x20text-white\x20font-bold\x20hover:opacity-90\x20transition\x20font-bold','target','\x20font-bold\x22><p\x20class=\x22text-[11px]\x20font-bold\x20uppercase\x20tracking-wider\x20opacity-80\x22>','hidden','status-indicator','4000','</td><td\x20class=\x22px-6\x20py-4\x20text-right\x20font-bold\x22><button\x20onclick=\x22window.app.resetMemberData(\x27','สมาชิกทั้งหมด','\x22\x20width=\x2232\x22></i>','placeholder','ttb-register','พิมพ์\x20Delete\x20เพื่อลบรายชื่อพนักงานทั้งหมดออกจากฐานข้อมูล','line','createObjectURL','Delete','<option\x20value=\x22','all','disabled','<option\x20value=\x22\x22>รางวัลทั้งหมด</option>','selectedDataReward','</td><td\x20class=\x22px-6\x20py-4\x20text-slate-700\x20font-normal\x20font-bold\x22>','>ย้อนกลับ</button><span\x20class=\x22text-sm\x20self-center\x20font-bold\x20px-2\x22>หน้า\x20','success','sort','\x20<span\x20class=\x22text-xs\x20font-normal\x20opacity-70\x22>สลาก</span>','commit','35UWqsRE','includes','deviceID','ระบบจัดการฉลาก','</td><td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20font-normal\x20font-bold\x22>','label-pagination-controls','ลบประวัติรายการทั้งหมด?','#10b981','3746090imjrRQ','blue','split','text/csv;charset=utf-8;','appendChild','ยืนยัน','\x27,\x20\x27','replace','bg-white\x20border-l-4\x20','citizenId','label-confirm-modal','bg-red-500','used','error','pagination-controls','/public/data/','getHours','</p><h3\x20class=\x22text-3xl\x20font-black\x20mt-1\x20leading-tight\x22>','delete','1000','<tr\x20class=\x22hover:bg-indigo-50/30\x20transition\x20border-b\x20border-slate-100\x20font-bold\x22><td\x20class=\x22px-6\x20py-4\x20text-slate-600\x20font-normal\x22>','label-modal-confirm-btn','พิมพ์\x20Delete\x20เพื่อลบประวัติ\x20Log\x20การทำรายการทั้งหมดถาวร','>Next</button>','length','Outsources_log','toLocaleDateString','</div></div><div\x20class=\x22p-4\x20flex-1\x20overflow-y-auto\x20max-h-[350px]\x20custom-scroll-dark\x22><p\x20class=\x22text-[10px]\x20text-slate-400\x20mb-2\x20font-bold\x20uppercase\x20tracking-tighter\x22>รายชื่อผู้ได้รับรางวัลล่าสุด</p>'];_0x4181=function(){return _0x11a4be;};return _0x4181();}setInterval(()=>{const _0x3f114c=_0x45c2bc;if(document['getElementById'](_0x3f114c(0x1d3)))document['getElementById'](_0x3f114c(0x1d3))[_0x3f114c(0x85)]=new Date()[_0x3f114c(0x194)]('th-TH');},0x3e8),init();
    </script>
</body>

</html>


